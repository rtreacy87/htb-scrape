<!DOCTYPE html>
<!-- saved from url=(0054)https://academy.hackthebox.com/module/218/section/2389 -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <title>Hack The Box - Academy</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta content="Premium Multipurpose Admin &amp; Dashboard Template" name="description">
    <meta content="Themesbrand" name="author">

    <link rel="shortcut icon" href="https://academy.hackthebox.com/images/favicon.ico">
    <link rel="icon" type="image/png" sizes="16x16" href="https://academy.hackthebox.com/images/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://academy.hackthebox.com/images/favicon-32x32.png">
    <link rel="apple-touch-icon" href="https://academy.hackthebox.com/images/apple-touch-icon.png">
    <link rel="mask-icon" href="https://academy.hackthebox.com/images/safari-pinned-tab.svg">

    <link rel="preload" as="style" href="./saved_page_files/bootstrap-dark-f3934f68.css"><link rel="preload" as="style" href="./saved_page_files/app-dark-c0e94a59.css"><link rel="preload" as="style" href="./saved_page_files/icons-541b9943.css"><link rel="preload" as="style" href="./saved_page_files/prism-8ad01d51.css"><link rel="stylesheet" href="./saved_page_files/bootstrap-dark-f3934f68.css"><link rel="stylesheet" href="./saved_page_files/app-dark-c0e94a59.css"><link rel="stylesheet" href="./saved_page_files/icons-541b9943.css"><link rel="stylesheet" href="./saved_page_files/prism-8ad01d51.css">
    <link href="./saved_page_files/toastr.min.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="./saved_page_files/ryt3opf.css">
    <link rel="stylesheet" href="./saved_page_files/8161086d56.css" crossorigin="anonymous">

    <script type="text/javascript" async="" src="./saved_page_files/awwxrc0h"></script><script type="text/javascript" async="" src="./saved_page_files/uwt.js.download"></script><script type="text/javascript" async="" src="./saved_page_files/insight.min.js.download"></script><script type="text/javascript" async="" src="./saved_page_files/analytics.js.download"></script><script type="text/javascript" src="./saved_page_files/commons.a61d7bea37d2de5d4b69.js.gz" async="" status="loaded"></script><script type="text/javascript" src="./saved_page_files/intercom.dynamic.js.gz" async="" status="loaded"></script><script type="text/javascript" src="./saved_page_files/twitter-ads.dynamic.js.gz" async="" status="loaded"></script><script type="text/javascript" src="./saved_page_files/linkedin-insight-tag.dynamic.js.gz" async="" status="loaded"></script><script type="text/javascript" src="./saved_page_files/google-analytics.dynamic.js.gz" async="" status="loaded"></script><script type="text/javascript" async="" charset="utf-8" src="./saved_page_files/recaptcha__en.js.download" crossorigin="anonymous" integrity="sha384-61VR//KO5vDNAFE1O0P7MzEOKj68zRELxJeYIL5DD4Cj1hdU5Cro7XZfUD04Ca7S"></script><script type="text/javascript" async="" src="./saved_page_files/htb-anal.min.js.download"></script><script>
    !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on","addSourceMiddleware","addIntegrationMiddleware","setAnonymousId","addDestinationMiddleware"];analytics.factory=function(e){return function(){var t=Array.prototype.slice.call(arguments);t.unshift(e);analytics.push(t);return analytics}};for(var e=0;e<analytics.methods.length;e++){var key=analytics.methods[e];analytics[key]=analytics.factory(key)}analytics.load=function(key,e){var t=document.createElement("script");t.type="text/javascript";t.async=!0;t.src="https://fygapokei.hackthebox.com/htb-anal.js/v1/" + key + "/htb-anal.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n);analytics._loadOptions=e};analytics._writeKey="eLzeD0QoARKZ42pc8AGEUYpcFLpYkf0I";analytics.SNIPPET_VERSION="4.13.2";
            analytics.load("eLzeD0QoARKZ42pc8AGEUYpcFLpYkf0I", { integrations: { "Segment.io": { apiHost: "fygapokei.hackthebox.com/v1" }}});
                                            properties = {"platform":"Academy","platform_version":"V1","module_id":218,"module_name":"Understanding Log Sources \u0026 Investigating with Splunk","module_difficulty":"Medium","section_id":2389,"section_title":"Using Splunk Applications"};
                                    analytics.page(
                "Module",
                properties
            );
                                }
    }();
</script>
    <link rel="stylesheet" href="./saved_page_files/bootstrap-select.min.css">
<style>
    .website-screenshot-url {
        height: 22px;
        cursor: text;
        padding-left: 10px;
    }

    .iterminal {
        position: fixed;
        bottom: 0;
        z-index: 100;
        width: 100%;
        left: 0;
    }


    .page-head {
        display: none;
    }

    .btn-circle {
        width: 25px;
        height: 25px;
        padding: 6px 0px;
        border-radius: 15px;
        text-align: center;
        font-size: 9px;
        line-height: 1.42857;
    }
</style>
    <script src="./saved_page_files/api.js.download"></script>
<link rel="modulepreload" as="script" crossorigin="" href="https://academy.hackthebox.com/build/assets/Terminal-39c2ddd3.js"><link rel="modulepreload" as="script" crossorigin="" href="https://academy.hackthebox.com/build/assets/core-fe-terminal-e3073504.js"><link rel="modulepreload" as="script" crossorigin="" href="https://academy.hackthebox.com/build/assets/lodash-c1890673.js"><link rel="modulepreload" as="script" crossorigin="" href="https://academy.hackthebox.com/build/assets/vuex-25bbbfbe.js"><link rel="modulepreload" as="script" crossorigin="" href="https://academy.hackthebox.com/build/assets/vue-radial-progress-4ea27d40.js"><link rel="stylesheet" href="./saved_page_files/vue-radial-progress-a171cc18.css"><link rel="stylesheet" href="./saved_page_files/core-htb-terminal-dbd97177.css"></head>

<body data-layout="detached" data-topbar="colored">
<div class="container-fluid">
    <htb-note base-url="https://notes.prod.htb.systems"><template shadowrootmode="open"><style type="text/css">@charset "UTF-8";.CodeMirror-gutter-filler,.CodeMirror-scrollbar-filler{background-color:#fff}.CodeMirror-gutters{border-right:1px solid #ddd;background-color:#f7f7f7;white-space:nowrap}.CodeMirror-linenumber{padding:0 3px 0 5px;min-width:20px;text-align:right;color:#999;white-space:nowrap}.CodeMirror-guttermarker{color:#000}.CodeMirror-guttermarker-subtle{color:#999}.CodeMirror-cursor{border-left:1px solid #000;border-right:none;width:0}.CodeMirror div.CodeMirror-secondarycursor{border-left:1px solid silver}.cm-fat-cursor .CodeMirror-cursor{width:auto;border:0!important;background:#7e7}.cm-fat-cursor div.CodeMirror-cursors{z-index:1}.cm-animate-fat-cursor{width:auto;border:0;animation:blink 1.06s steps(1) infinite;background-color:#7e7}@keyframes blink{50%{background-color:transparent}}.cm-tab{display:inline-block;text-decoration:inherit}.CodeMirror-rulers{position:absolute;left:0;right:0;top:-50px;bottom:-20px;overflow:hidden}.CodeMirror-ruler{border-left:1px solid #ccc;top:0;bottom:0;position:absolute}.CodeMirror,.CodeMirror-scroll{position:relative;min-height:300px}.cm-s-default .cm-header{color:#00f}.cm-s-default .cm-quote{color:#090}.cm-negative{color:#d44}.cm-positive{color:#292}.cm-header,.cm-strong{font-weight:700}.cm-em{font-style:italic}.cm-link{text-decoration:underline}.CodeMirror .CodeMirror-code .cm-strikethrough,.cm-strikethrough{text-decoration:line-through}.cm-s-default .cm-keyword{color:#708}.cm-s-default .cm-atom{color:#219}.cm-s-default .cm-number{color:#164}.cm-s-default .cm-def{color:#00f}.cm-s-default .cm-variable-2{color:#05a}.cm-s-default .cm-variable-3{color:#085}.cm-s-default .cm-comment{color:#a50}.cm-s-default .cm-string{color:#a11}.cm-s-default .cm-string-2{color:#f50}.cm-s-default .cm-meta,.cm-s-default .cm-qualifier{color:#555}.cm-s-default .cm-builtin{color:#30a}.cm-s-default .cm-bracket{color:#997}.cm-s-default .cm-tag{color:#170}.cm-s-default .cm-attribute{color:#00c}.cm-s-default .cm-hr{color:#999}.cm-s-default .cm-link{color:#00c}.cm-invalidchar,.cm-s-default .cm-error{color:red}.CodeMirror-composing{border-bottom:2px solid}div.CodeMirror span.CodeMirror-matchingbracket{color:#0f0}div.CodeMirror span.CodeMirror-nonmatchingbracket{color:#f22}.CodeMirror-matchingtag{background:rgba(255,150,0,.3)}.CodeMirror-activeline-background{background:#e8f2ff}.CodeMirror{position:relative;overflow:hidden;background:#fff}.CodeMirror-scroll{overflow:scroll!important;height:100%;outline:0;position:relative}.CodeMirror-sizer{position:relative;border-right:30px solid transparent}.CodeMirror-gutter-filler,.CodeMirror-hscrollbar,.CodeMirror-scrollbar-filler,.CodeMirror-vscrollbar{position:absolute;z-index:6;display:none}.CodeMirror-vscrollbar{right:0;top:0;overflow-x:hidden;overflow-y:scroll}.CodeMirror-hscrollbar{bottom:0;left:0;overflow-y:hidden;overflow-x:scroll}.CodeMirror-scrollbar-filler{right:0;bottom:0}.CodeMirror-gutter-filler{left:0;bottom:0}.CodeMirror-gutters{position:absolute;left:0;top:0;min-height:100%;z-index:3}.CodeMirror-gutter{white-space:normal;height:100%;display:inline-block;vertical-align:top;margin-bottom:-30px}.CodeMirror-gutter-wrapper{position:absolute;z-index:4;background:0 0!important;border:none!important;-webkit-user-select:none;-moz-user-select:none;user-select:none}.CodeMirror-gutter-background{position:absolute;top:0;bottom:0;z-index:4}.CodeMirror-gutter-elt{position:absolute;cursor:default;z-index:4}.CodeMirror-lines{cursor:text;min-height:1px}.CodeMirror pre{border-radius:0;border-width:0;background:0 0;font-family:inherit;font-size:inherit;margin:0;white-space:pre;word-wrap:normal;line-height:inherit;color:inherit;z-index:2;position:relative;overflow:visible;-webkit-tap-highlight-color:transparent;font-variant-ligatures:contextual}.CodeMirror-wrap pre{word-wrap:break-word;white-space:pre-wrap;word-break:normal}.CodeMirror-linebackground{position:absolute;left:0;right:0;top:0;bottom:0;z-index:0}.CodeMirror-linewidget{position:relative;z-index:2;overflow:auto}.CodeMirror-code{outline:0}.CodeMirror-gutter,.CodeMirror-gutters,.CodeMirror-linenumber,.CodeMirror-scroll,.CodeMirror-sizer{box-sizing:content-box}.CodeMirror-measure{position:absolute;width:100%;height:0;overflow:hidden;visibility:hidden}.CodeMirror-cursor{position:absolute;pointer-events:none}.CodeMirror-measure pre{position:static}div.CodeMirror-cursors{visibility:hidden;position:relative;z-index:3}.CodeMirror-focused div.CodeMirror-cursors,div.CodeMirror-dragcursors{visibility:visible}.CodeMirror-selected{background:#d9d9d9}.CodeMirror-focused .CodeMirror-selected{background:#d7d4f0}.CodeMirror-crosshair{cursor:crosshair}.CodeMirror-line::selection,.CodeMirror-line>span::selection,.CodeMirror-line>span>span::selection{background:#d7d4f0}.CodeMirror-line::-moz-selection,.CodeMirror-line>span::-moz-selection,.CodeMirror-line>span>span::-moz-selection{background:#d7d4f0}.cm-searching{background:#ffa;background:rgba(255,255,0,.4)}.cm-force-border{padding-right:.1px}@media print{.CodeMirror div.CodeMirror-cursors{visibility:hidden}}.cm-tab-wrap-hack:after{content:""}span.CodeMirror-selectedtext{background:0 0}.CodeMirror{background-color:#1e2939;border:0;border-bottom-left-radius:3px;border-bottom-right-radius:3px;color:#aaa;font-family:inherit;font-size:18px;height:auto;line-height:1.5;padding:14px;z-index:1}.CodeMirror-scroll{margin-bottom:-32px;margin-right:-32px;padding-bottom:32px}.CodeMirror-fullscreen{background-color:#444;border:0;border-top:1px solid #555;bottom:0;height:auto;left:0;position:fixed!important;right:0;top:58px;z-index:9}.CodeMirror-sided{width:50%!important}.CodeMirror .CodeMirror-placeholder{color:#777}.CodeMirror-cursor{border-left-color:#aaa}.CodeMirror pre,.CodeMirror-lines{padding:0}.CodeMirror-focused .CodeMirror-selected,.CodeMirror-line::-moz-selection,.CodeMirror-line>span::-moz-selection,.CodeMirror-line>span>span::-moz-selection,.CodeMirror-selected{background-color:hsla(0,0%,100%,.1)}.CodeMirror-line::-moz-selection,.CodeMirror-line>span::-moz-selection,.CodeMirror-line>span>span::-moz-selection{background-color:hsla(0,0%,100%,.1)}.CodeMirror-focused .CodeMirror-selected,.CodeMirror-line::selection,.CodeMirror-line>span::selection,.CodeMirror-line>span>span::selection,.CodeMirror-selected{background-color:hsla(0,0%,100%,.1)}.CodeMirror .CodeMirror-code .cm-attribute,.CodeMirror .CodeMirror-code .cm-tag{color:#95bf40}.CodeMirror .CodeMirror-code .cm-string{color:#777}.CodeMirror .CodeMirror-code .cm-link{color:#ffd500}.CodeMirror .CodeMirror-code .cm-formatting-code,.CodeMirror .CodeMirror-code .cm-formatting-code-block,.CodeMirror .CodeMirror-code .cm-formatting-em,.CodeMirror .CodeMirror-code .cm-formatting-header,.CodeMirror .CodeMirror-code .cm-formatting-strikethrough,.CodeMirror .CodeMirror-code .cm-formatting-strong,.CodeMirror .CodeMirror-code .cm-hr,.CodeMirror .CodeMirror-code .cm-quote,.CodeMirror .CodeMirror-code .cm-url{color:#777}.CodeMirror .CodeMirror-code .cm-header-1,.CodeMirror .CodeMirror-code .cm-header-2,.CodeMirror .CodeMirror-code .cm-header-3,.CodeMirror .CodeMirror-code .cm-header-4,.CodeMirror .CodeMirror-code .cm-header-5,.CodeMirror .CodeMirror-code .cm-header-6{line-height:2}.CodeMirror .CodeMirror-code .cm-header-1{font-size:32px}.CodeMirror .CodeMirror-code .cm-header-2{font-size:26px}.CodeMirror .CodeMirror-code .cm-header-3{font-size:24px}.CodeMirror .CodeMirror-code .cm-header-4{font-size:22px}.CodeMirror .CodeMirror-code .cm-header-5{font-size:20px}.CodeMirror .CodeMirror-code .cm-header-6{font-size:18px}.CodeMirror .CodeMirror-code .cm-header,.CodeMirror .CodeMirror-code .cm-strong{font-weight:600}.CodeMirror .CodeMirror-code .cm-comment{background-color:hsla(0,0%,100%,.05);font-family:Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:14px;padding:6px 0 4px}.CodeMirror .CodeMirror-code span.CodeMirror-selectedtext.cm-comment{background-color:hsla(0,0%,100%,.05)}.editor-preview{height:100%;left:0;position:absolute;top:0;width:100%;z-index:2}.editor-preview-side{border:0;border-left:1px solid #555;border-top:1px solid #555;bottom:0;position:fixed;right:0;top:58px;width:50%;z-index:9}.editor-preview,.editor-preview-side{background-color:#444;box-sizing:border-box;color:#aaa;display:none;font-family:inherit;font-size:18px;line-height:1.5;overflow:auto;padding:0 14px 14px}.editor-preview pre,.editor-preview-side pre{background-color:hsla(0,0%,100%,.05);font-family:Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:14px;line-height:1.2;margin-top:14px;overflow:auto;-webkit-overflow-scrolling:touch;padding:14px}.editor-preview pre code,.editor-preview-side pre code{background-color:transparent;font-size:14px;padding:0}.editor-preview-active,.editor-preview-active-side{display:block}.editor-preview table,.editor-preview-side table{background-color:#444;border:0;border-collapse:collapse;border-spacing:0;width:100%}.editor-preview table caption,.editor-preview-side table caption{caption-side:bottom;color:#777;padding:7px;text-align:left}.editor-preview table td,.editor-preview table th,.editor-preview-side table td,.editor-preview-side table th{border:0;border-bottom:1px solid #555;padding:7px;text-align:left}.editor-preview table th,.editor-preview-side table th{background-color:hsla(0,0%,100%,.05);font-weight:600}.editor-preview audio:not([controls]),.editor-preview-side audio:not([controls]){display:none;height:0}.editor-preview img,.editor-preview-side img{max-width:100%;vertical-align:middle}.editor-preview audio,.editor-preview video,.editor-preview-side audio,.editor-preview-side video{width:100%}.editor-toolbar{background-color:#444;border:1px solid #555;border-bottom:0;border-top-left-radius:3px;border-top-right-radius:3px;font-size:18px;padding:0 14px;position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none}.editor-toolbar:after,.editor-toolbar:before{content:" ";display:block;height:1px}.editor-toolbar:before{margin-bottom:7px}.editor-toolbar:after{margin-top:7px}.editor-toolbar a{border:1px solid transparent;border-radius:3px;color:#777!important;cursor:pointer;display:inline-block;font-size:80%;height:30px;margin:0;text-align:center;text-decoration:none!important;width:30px}.editor-toolbar a.active,.editor-toolbar a:hover{border-color:#555;color:#aaa!important}.editor-toolbar a:before{line-height:30px}.editor-toolbar a.fa-header-x:after{bottom:-.25em;font-family:inherit;font-size:80%;line-height:0;position:relative;vertical-align:baseline}.editor-toolbar a.fa-header-1:after{content:"1"}.editor-toolbar a.fa-header-2:after{content:"2"}.editor-toolbar a.fa-header-3:after{content:"3"}.editor-toolbar a.fa-header-bigger:after{content:"▲"}.editor-toolbar a.fa-header-smaller:after{content:"▼"}.editor-toolbar i.separator{border-right:1px solid #555;color:transparent;display:inline-block;margin:0 7px;text-indent:-10px;width:0}.editor-toolbar:hover a{color:#aaa!important}.editor-toolbar.fullscreen{background-color:#444;border:0;box-sizing:border-box;height:58px;left:0;overflow-x:auto;overflow-y:hidden;padding-bottom:14px;padding-top:14px;position:fixed;top:0;white-space:nowrap;width:100%;z-index:9}.editor-toolbar.fullscreen:after,.editor-toolbar.fullscreen:before{height:58px;left:0;margin:0;padding:0;position:fixed;top:0;width:20px}@media only screen and (max-width:700px){.editor-toolbar a.no-mobile{display:none}}.editor-toolbar.disabled-for-preview a:not(.no-disable){background-color:#444;border-color:transparent;pointer-events:none;text-shadow:inherit}.editor-statusbar{color:#777;font-family:inherit;font-size:80%;padding:7px 14px;text-align:right}.editor-statusbar span{display:inline-block;margin-left:1em}.editor-statusbar .lines:before{content:"lines: "}.editor-statusbar .words:before{content:"words: "}.editor-statusbar .characters:before{content:"characters: "}.CodeMirror{height:330px;max-height:350px;padding:10px 20px;font-size:14px}.CodeMirror .CodeMirror-code .cm-header-1{font-size:17px}.CodeMirror .CodeMirror-code .cm-header-2{font-size:16px}.CodeMirror .CodeMirror-code .cm-header-3{font-size:15px}.CodeMirror .CodeMirror-code .cm-header-4{font-size:14px}.CodeMirror .CodeMirror-code .cm-header-5{font-size:13px}.CodeMirror .CodeMirror-code .cm-header-6{font-size:12px}.CodeMirror .CodeMirror-code .cm-formatting.cm-formatting-list.cm-formatting-list-ol.cm-variable-2,.CodeMirror .CodeMirror-code .cm-formatting.cm-formatting-list.cm-formatting-list-ul.cm-variable-2,.CodeMirror .CodeMirror-code .cm-link{color:#9fef00}.CodeMirror .CodeMirror-code .cm-formatting.cm-formatting-list.cm-formatting-list-ul.cm-variable-2{font-weight:700}.CodeMirror .CodeMirror-code .cm-string.cm-url{color:#fff}</style><style type="text/css">.vue-simplemde[data-v-202e7b5b]{width:100%;text-align:left}.CodeMirror[data-v-202e7b5b],.CodeMirror-scroll[data-v-202e7b5b]{height:400px}.CodeMirror-fullscreen .CodeMirror-scroll[data-v-202e7b5b],.CodeMirror-fullscreen.CodeMirror[data-v-202e7b5b]{max-height:none}.htb-note-component[data-v-202e7b5b]{font-family:neue-haas-unica,sans-serif;-webkit-font-smoothing:antialiased;font-size:14px}.htb-note-component .htb-note-modal[data-v-202e7b5b],.htb-note-component .htb-note-trigger-button[data-v-202e7b5b]{position:fixed;display:flex;top:50%;align-items:center;justify-content:center;border-radius:5px;z-index:1000000}.htb-note-component .htb-note-trigger-button[data-v-202e7b5b]{right:0;height:50px;width:30px;margin-top:-25px;background:#9fef00;font-weight:600;color:#121c2b;cursor:pointer;border-top-right-radius:0;border-bottom-right-radius:0;border:2px solid #182232}.htb-note-component .htb-note-modal[data-v-202e7b5b]{flex-direction:column;right:10px;height:500px;width:300px;margin-top:-250px;background:#1e2939;border:1px solid rgba(135,153,181,.129)}.htb-note-component .htb-note-modal .htb-note-title[data-v-202e7b5b]{color:#f4f4f4;padding:20px;align-self:start;border-bottom:1px solid rgba(135,153,181,.129);width:calc(100% - 40px);font-weight:600}.htb-note-component .htb-note-modal .htb-note-container[data-v-202e7b5b]{display:flex;flex-direction:column;flex-grow:1;width:100%;align-items:center;justify-content:center;text-align:center}.htb-note-component .htb-note-modal .htb-note-fetching-container[data-v-202e7b5b]{display:flex;align-items:center;justify-content:center}.htb-note-component .htb-note-modal .htb-note-textarea[data-v-202e7b5b]{display:flex;flex-grow:1;justify-content:center;width:100%}.htb-note-component .htb-note-modal .htb-note-textarea textarea[data-v-202e7b5b]{border:none;overflow:auto;outline:none;box-shadow:none;resize:none;width:100%;background:transparent;color:#8799b5;padding:20px}.htb-note-component .htb-note-modal .htb-note-save-container[data-v-202e7b5b]{display:flex;align-self:end;width:100%}.htb-note-component .htb-note-modal .htb-note-save-container .htb-note-save-button[data-v-202e7b5b],.htb-note-component .htb-note-modal .htb-note-save-container .htb-note-saving-button-loader[data-v-202e7b5b]{width:100%;position:relative;align-items:center;display:inline-grid;grid-template-columns:max-content auto max-content;justify-content:center;transition-duration:.28s;border:0;cursor:pointer;height:-moz-fit-content;height:fit-content;padding:12px;font-weight:500;border-radius:5px;margin:5px}.htb-note-component .htb-note-modal .htb-note-save-container .htb-note-save-button[data-v-202e7b5b]{background-color:#9fef00}.htb-note-component .htb-note-modal .htb-note-save-container .htb-note-save-button.red[data-v-202e7b5b]{background-color:#ff7680}.htb-note-component .htb-note-modal .htb-note-save-container .htb-note-save-button.gray[data-v-202e7b5b]{background-color:rgba(135,153,181,.149);color:#526177}.htb-note-component .htb-note-modal .htb-note-save-container .htb-note-save-button[data-v-202e7b5b]:disabled{cursor:not-allowed}.htb-note-component .htb-note-loader[data-v-202e7b5b]{margin-left:10px;width:10px;height:10px;border-radius:50%;border:3.8px solid;border-color:#dbdcef;border-right-color:#9fef00;animation:spinner-d3wgkg-202e7b5b 1s linear infinite}@keyframes spinner-d3wgkg-202e7b5b{to{transform:rotate(1turn)}}</style><div data-v-202e7b5b="" id="htb-note-component" class="htb-note-component"><div data-v-202e7b5b="" class="htb-note-trigger-button">✎</div><!----></div></template></htb-note>
    <div id="layout-wrapper">

        <header id="page-topbar">
    <div class="navbar-header">
        <div class="container-fluid">
            <div class="d-flex align-items-center justify-content-between">
                <div class="d-flex align-items-center">
                    <div class="navbar-brand-box">
                        <a href="https://academy.hackthebox.com/dashboard" class="logo">
                            <span class="logo-sm">
                                <img src="./saved_page_files/new-logo-htb.svg" alt="" height="30">
                            </span>
                            <span class="logo-md">
                                <img src="./saved_page_files/logo.svg" alt="" height="30">
                            </span>
                            <span class="logo-lg">
                                <img src="./saved_page_files/logo.svg" alt="" height="36">
                            </span>
                        </a>
                    </div>

                    <div class="d-flex align-items-center">
                        <button type="button" class="btn btn-sm font-size-16 header-item toggle-btn waves-effect" id="vertical-menu-btn">
                            <i class="fa fa-fw fa-bars"></i>
                        </button>
                                            </div>
                                        <div class="topnav">
                        <nav class="navbar navbar-light navbar-expand-lg topnav-menu">
                            <div class="collapse navbar-collapse" id="topnav-menu-content">
                                <ul class="navbar-nav active">
                                    <li class="nav-item">
                                        <a class="nav-link" href="https://academy.hackthebox.com/dashboard"><i class="mdi mdi-monitor-dashboard"></i> Dashboard</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" href="https://academy.hackthebox.com/modules"><i class="mdi mdi-book-open"></i>
                                            Modules</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" href="https://academy.hackthebox.com/paths"><i class="mdi mdi-map-marker-path"></i> Paths</a>
                                    </li>
                                </ul>
                            </div>
                        </nav>
                    </div>
                                    </div>

                <div class="float-right">
                    <div class="dropdown d-none d-lg-inline-block ml-1">
                        <a href="https://academy.hackthebox.com/billing">
                            <button type="button" class="btn btn-extra-light">
                                <i class="fad fa-cube text-success mt-1 mr-2"></i>&nbsp;Purchase Cubes
                            </button>
                        </a>
                    </div>
                    <div class="dropdown d-none d-lg-inline-block ml-1">
                        <button type="button" class="btn header-item noti-icon waves-effect" data-toggle="fullscreen">
                            <i class="mdi mdi-fullscreen fullscreen-icon"></i>
                        </button>
                    </div>


                    <div class="dropdown d-inline-block">
                        <button type="button" class="btn header-item waves-effect" id="page-header-user-dropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <img class="rounded-circle header-profile-user" src="./saved_page_files/a2dd1cc5964b266d044f35b4b6fad92e" alt="Header Avatar">
                            <span class="d-none d-xl-inline-block ml-1">icantthinkofaname23</span>
                            <i class="mdi mdi-chevron-down d-none d-xl-inline-block"></i>
                        </button>
                        <div class="dropdown-menu dropdown-menu-right">
                                                        <a class="dropdown-item" href="https://academy.hackthebox.com/billing"><i class="bx bx-wallet font-size-16 align-middle mr-1"></i> Billing</a>
                            <a class="dropdown-item d-block" href="https://academy.hackthebox.com/settings"><i class="bx bx-wrench font-size-16 align-middle mr-1"></i> Settings</a>
                            <a class="dropdown-item d-block" href="https://academy.hackthebox.com/vpn"><i class="bx bx-server font-size-16 align-middle mr-1"></i> VPN Settings</a>
                            <a class="dropdown-item d-block" href="https://academy.hackthebox.com/htb-account-settings"><i class="bx bx-server font-size-16 align-middle mr-1"></i> HTB Account Settings</a>
                            <div class="dropdown-divider"></div>
                            <form method="POST" action="https://academy.hackthebox.com/logout"> <input type="hidden" name="_token" value="o1DARWgBFx6IH2FtqiFTXfhZhd8KfTUKWFxRIrZm" autocomplete="off"> <a class="dropdown-item text-danger log-out" href="https://academy.hackthebox.com/module/218/section/2389#"><i class="bx bx-power-off font-size-16 align-middle mr-1 text-danger"></i> Logout</a>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>

        <div class="vertical-menu overflow-hidden  d-lg-none  ">
    <div class="vertical-menu-overlay"></div>
    <div class="h-100 overflow-auto">
        <div class="user-wid text-center py-4">
            <div class="user-img">
                <img src="./saved_page_files/a2dd1cc5964b266d044f35b4b6fad92e" alt="" class="avatar-md mx-auto rounded-circle">
            </div>

            <div class="mt-3">
                <p class="text-dark mb-0 font-weight-medium font-size-16">icantthinkofaname23</p>
                                <p class="text-body mt-1 mb-1">
                                                                        Silver Annual
                                                            </p>
                <p>
                    <span class="custom-badge custom-badge-soft-secondary" data-toggle="tooltip" data-title="Cubes" data-original-title="" title="">
                        <i class="fad fa-cube text-success mr-1"></i>
                        <span class="cubeBalance">
                                                            143
                                                    </span>
                    </span>
                                        <span class="custom-badge custom-badge-soft-secondary cursor-pointer exchange-voucher" data-toggle="tooltip" data-title="Vouchers" data-original-title="" title="">
                        <i class="fad fa-ticket text-success mr-1"></i>
                        <span class="voucherBalance">
                            1
                        </span>
                    </span>
                                    </p>
            </div>
        </div>

        <div id="sidebar-menu">
    <ul class="metismenu list-unstyled" id="side-menu">

        <li class="menu-title">Learn</li>

        <li><a class="navDashboard" href="https://academy.hackthebox.com/dashboard"><i class="mdi mdi-monitor-dashboard"></i> Dashboard</a></li>

                <li>
            <a class="navDashboard" href="https://academy.hackthebox.com/exams"><i class="mdi mdi-certificate"></i>
                Exams</a></li>
        <li>
            <a class="navModules" href="javascript: void(0);" aria-expanded="false">
                <i class="mdi mdi-book-open"></i>
                <span>Modules</span>
            </a>
            <ul class="sub-menu mm-collapse" aria-expanded="false">
                <li><a href="https://academy.hackthebox.com/modules"><i class="mdi mdi-book-open"></i> All Modules</a>
                </li>
                <li>
                    <a href="https://academy.hackthebox.com/modules/inprogress"><i class="mdi mdi-progress-upload"></i>
                        In-Progress Modules</a></li>
                <li><a href="https://academy.hackthebox.com/modules/locked"><i class="mdi mdi-account-arrow-left-outline"></i> Available
                        Modules</a>
                </li>
                <li>
                    <a href="https://academy.hackthebox.com/modules/unlocked"><i class="mdi mdi-account-check-outline"></i>
                        Owned
                        Modules</a></li>
                <li>
                    <a href="https://academy.hackthebox.com/modules/changelog"><i class="mdi mdi-playlist-check"></i>
                        Change Log</a></li>
                            </ul>
        </li>
        <li class="pathsLink">
            <a class="navPaths" href="javascript: void(0);" aria-expanded="false">
                <i class="mdi mdi-map-marker-path"></i>
                <span>Paths</span>
            </a>
            <ul class="sub-menu mm-collapse" aria-expanded="false">
                <li class="skillPathsLink"><a href="https://academy.hackthebox.com/paths"><i class="mdi mdi-chart-line-variant"></i> Skill Paths</a></li>
                                    <li class="jobRolePathsLink"><a href="https://academy.hackthebox.com/paths/jobrole"><i class="mdi mdi-briefcase"></i> Job Role Paths</a></li>
                                            </ul>
        </li>
                <li>
            <a class="navDashboard" href="https://academy.hackthebox.com/academy-relations"><i class="mdi mdi-sitemap"></i>
                Academy x HTB Labs</a>
        </li>
        <li class="menu-title">My Achievements</li>
        <li>
            <a class="navDashboard" href="https://academy.hackthebox.com/my-certificates"><i class="mdi mdi-certificate"></i>
                My Certificates </a></li>
        <li>
                    </li><li>
                <a class="navDashboard" href="https://academy.hackthebox.com/my-badges"><i class="mdi mdi-trophy"></i>
                    My Badges                         <span class="badge badge badge-primary float-right">  4</span></a>
            </li>
                <li>

                    </li><li class="menu-title">Referrals</li>
                <li>
                    <a class="navDashboard" href="https://academy.hackthebox.com/referral">
                        <i class="mdi mdi-gift"></i> Invite friends
                                                    <span class="badge mx-3 bg-success text-light font-size-11">NEW</span>
                                            </a>
                </li><li>
            </li><li>
        
        </li><li class="menu-title">Get Help</li>
        <li>
            <a class="navSupport" href="http://help.hackthebox.eu/" rel="noopener nofollow norefferer" target="_blank"><i class="mdi mdi-help-box"></i>Help Center</a></li>
        <li><a class="navSupport" data-toggle="tooltip" href="https://academy.hackthebox.com/faq" data-original-title="" title=""><i class="mdi mdi-help-circle"></i> FAQ</a></li>
        <li><a class="navSupport" href="https://discord.gg/hackthebox" rel="noopener nofollow norefferer" target="_blank"><i class="mdi mdi-discord"></i>
                Discord</a></li>

    </ul>
</div>

    </div>
</div>

        <div class="vertical-menu overflow-hidden  d-lg-none  ">
    <div class="vertical-menu-overlay"></div>
    <div class="h-100 overflow-auto">
        <div class="user-wid text-center py-4">
            <div class="user-img">
                <img src="./saved_page_files/a2dd1cc5964b266d044f35b4b6fad92e" alt="" class="avatar-md mx-auto rounded-circle">
            </div>

            <div class="mt-3">
                <p class="text-dark mb-0 font-weight-medium font-size-16">icantthinkofaname23</p>
                                <p class="text-body mt-1 mb-1">
                                                                        Silver Annual
                                                            </p>
                <p>
                    <span class="custom-badge custom-badge-soft-secondary" data-toggle="tooltip" data-title="Cubes" data-original-title="" title="">
                        <i class="fad fa-cube text-success mr-1"></i>
                        <span class="cubeBalance">
                                                            143
                                                    </span>
                    </span>
                                        <span class="custom-badge custom-badge-soft-secondary cursor-pointer exchange-voucher" data-toggle="tooltip" data-title="Vouchers" data-original-title="" title="">
                        <i class="fad fa-ticket text-success mr-1"></i>
                        <span class="voucherBalance">
                            1
                        </span>
                    </span>
                                    </p>
            </div>
        </div>

        <div id="sidebar-menu">
    <ul class="metismenu list-unstyled" id="side-menu">

        <li class="menu-title">Learn</li>

        <li><a class="navDashboard" href="https://academy.hackthebox.com/dashboard"><i class="mdi mdi-monitor-dashboard"></i> Dashboard</a></li>

                <li>
            <a class="navDashboard" href="https://academy.hackthebox.com/exams"><i class="mdi mdi-certificate"></i>
                Exams</a></li>
        <li>
            <a class="navModules" href="javascript: void(0);">
                <i class="mdi mdi-book-open"></i>
                <span>Modules</span>
            </a>
            <ul class="sub-menu mm-collapse" aria-expanded="false">
                <li><a href="https://academy.hackthebox.com/modules"><i class="mdi mdi-book-open"></i> All Modules</a>
                </li>
                <li>
                    <a href="https://academy.hackthebox.com/modules/inprogress"><i class="mdi mdi-progress-upload"></i>
                        In-Progress Modules</a></li>
                <li><a href="https://academy.hackthebox.com/modules/locked"><i class="mdi mdi-account-arrow-left-outline"></i> Available
                        Modules</a>
                </li>
                <li>
                    <a href="https://academy.hackthebox.com/modules/unlocked"><i class="mdi mdi-account-check-outline"></i>
                        Owned
                        Modules</a></li>
                <li>
                    <a href="https://academy.hackthebox.com/modules/changelog"><i class="mdi mdi-playlist-check"></i>
                        Change Log</a></li>
                            </ul>
        </li>
        <li class="pathsLink">
            <a class="navPaths" href="javascript: void(0);">
                <i class="mdi mdi-map-marker-path"></i>
                <span>Paths</span>
            </a>
            <ul class="sub-menu mm-collapse" aria-expanded="false">
                <li class="skillPathsLink"><a href="https://academy.hackthebox.com/paths"><i class="mdi mdi-chart-line-variant"></i> Skill Paths</a></li>
                                    <li class="jobRolePathsLink"><a href="https://academy.hackthebox.com/paths/jobrole"><i class="mdi mdi-briefcase"></i> Job Role Paths</a></li>
                                            </ul>
        </li>
                <li>
            <a class="navDashboard" href="https://academy.hackthebox.com/academy-relations"><i class="mdi mdi-sitemap"></i>
                Academy x HTB Labs</a>
        </li>
        <li class="menu-title">My Achievements</li>
        <li>
            <a class="navDashboard" href="https://academy.hackthebox.com/my-certificates"><i class="mdi mdi-certificate"></i>
                My Certificates </a></li>
        <li>
                    </li><li>
                <a class="navDashboard" href="https://academy.hackthebox.com/my-badges"><i class="mdi mdi-trophy"></i>
                    My Badges                         <span class="badge badge badge-primary float-right">  4</span></a>
            </li>
                <li>

                    </li><li class="menu-title">Referrals</li>
                <li>
                    <a class="navDashboard" href="https://academy.hackthebox.com/referral">
                        <i class="mdi mdi-gift"></i> Invite friends
                                                    <span class="badge mx-3 bg-success text-light font-size-11">NEW</span>
                                            </a>
                </li><li>
            </li><li>
        
        </li><li class="menu-title">Get Help</li>
        <li>
            <a class="navSupport" href="http://help.hackthebox.eu/" rel="noopener nofollow norefferer" target="_blank"><i class="mdi mdi-help-box"></i>Help Center</a></li>
        <li><a class="navSupport" data-toggle="tooltip" href="https://academy.hackthebox.com/faq" data-original-title="" title=""><i class="mdi mdi-help-circle"></i> FAQ</a></li>
        <li><a class="navSupport" href="https://discord.gg/hackthebox" rel="noopener nofollow norefferer" target="_blank"><i class="mdi mdi-discord"></i>
                Discord</a></li>

    </ul>
</div>

    </div>
</div>

        <div class="main-content">

            <div class="page-content">

                <div class="iterminal d-none">
    <div id="appVue"><div class="row mb-5 mb-lg-2 page-head"><div class="col-12"><div class="page-title-box d-flex align-items-center justify-content-between pb-0"><h4 class="page-title mb-0 font-size-18"></h4><div class="page-title-right"><ol class="breadcrumb m-0"><li class="breadcrumb-item"><a href="javascript: void(0);">Pages</a></li><li class="breadcrumb-item active">  </li></ol></div></div></div></div><div class=""><div data-v-4e75c04e="" id="terminal" data-testid="terminal" class="it-terminal"><div data-v-4e75c04e="" class="it-header"><div data-v-4e75c04e="" class="is-flex is-full-height is-align-items-center px-3"><button data-v-4e75c04e="" class="button it-btn-cirle is-danger"><svg data-v-4e75c04e="" width="24px" height="24px" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M5 7.5C5 7.22386 5.22386 7 5.5 7H9.5C9.77614 7 10 7.22386 10 7.5C10 7.77614 9.77614 8 9.5 8H5.5C5.22386 8 5 7.77614 5 7.5Z" fill="#ffffff"></path></svg></button><button data-v-4e75c04e="" data-testid="maximize" class="button it-btn-cirle is-warning mx-1"><svg data-v-4e75c04e="" width="15px" height="15px" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="none"><path stroke="#ffffff" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8V6a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v2M3 8v10a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8M3 8h18"></path><path fill="#ffffff" d="M3 6a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v2H3V6z"></path></svg></button><button data-v-4e75c04e="" data-testid="fullheight" class="button it-btn-cirle is-success"><svg data-v-4e75c04e="" width="15px" height="15px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path opacity="0.15" d="M4 6C4 5.44771 4.44772 5 5 5H19C19.5523 5 20 5.44772 20 6V15C20 15.5523 19.5523 16 19 16H5C4.44772 16 4 15.5523 4 15V6Z" fill="#ffffff"></path><path d="M12 20H16M12 20H8M12 20V16M12 16H5C4.44772 16 4 15.5523 4 15V6C4 5.44771 4.44772 5 5 5H19C19.5523 5 20 5.44772 20 6V15C20 15.5523 19.5523 16 19 16H12Z" stroke="#ffffff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></button><p data-v-4e75c04e="" data-testid="terminal-title" class="is-size-14 has-text-weight-bold ml-2 has-text-info"> Integrated Terminal </p></div></div><div data-v-4e75c04e="" data-testid="terminal-panel" class="is-flex is-full-height is-align-items-center is-justify-content-center"><span data-v-4e75c04e="" class="loader"></span></div></div></div></div>
</div>

<div class="row">

    <div class="col-12">
        <div class="page-title-box d-flex align-items-center justify-content-between">
            <h4 class="page-title mb-0 font-size-18 letter-spacing-1-2">Understanding Log Sources &amp; Investigating with Splunk
                                    <span class="badge mr-1 badge-soft-secondary font-size-13 capitalize color-white">
                        <img src="./saved_page_files/bolt.svg" class="mr-1" alt="mini-module badge">Mini-Module
                    </span>
                                &nbsp;
                <i style="cursor:pointer;" data-module-id="218" data-toggle="tooltip" data-title="Toggle To-Do" class="favouriteBtn  fa-sharp fa-solid  fa-heart text-danger" data-original-title="" title=""></i>
            </h4>

            <div class="page-title-right">
                <ol class="breadcrumb m-0">
                    <li class="breadcrumb-item"><a href="javascript: void(0);">Page 2</a></li>
                    <li class="breadcrumb-item active">Using Splunk Applications</li>
                </ol>
            </div>
        </div>
    </div>
</div>

<div class="row justify-content-xl-center">
    <div class="col-md-12 col-xl-9 col-xxl-7">

        <div class="training-module">

            <h1>Using Splunk Applications</h1>
<hr>
<h2>Splunk Applications</h2>
<p>Splunk applications, or apps, are packages that we add to our Splunk Enterprise or Splunk Cloud deployments to extend capabilities and manage specific types of operational data. Each application is tailored to handle data from specific technologies or use cases, effectively acting as a pre-built knowledge package for that data. Apps can provide capabilities ranging from custom data inputs, custom visualizations, dashboards, alerts, reports, and more.</p>
<p>Splunk Apps enable the coexistence of multiple workspaces on a single Splunk instance, catering to different use cases and user roles. These ready-made apps can be found on Splunkbase.</p>
<p>As an integral part of our cybersecurity operations, the Splunk apps designed for Security Information and Event Management (SIEM) purposes provide a range of capabilities to enhance our ability to detect, investigate, and respond to threats. They are designed to ingest, analyze, and visualize security-related data, enabling us to detect complex threats and perform in-depth investigations.</p>
<p>When using these apps in our Splunk environment, we need to consider factors such as data volume, hardware requirements, and licensing. Many apps can be resource-intensive, so we must ensure our Splunk deployment is sized correctly to handle the additional workload. Further, it's also important to ensure we have the correct licenses for any premium apps, and that we are aware of the potential for increased license usage due to the added data inputs.</p>
<p>In this segment, we'll be leveraging the <code>Sysmon App for Splunk</code> developed by Mike Haag.</p>
<p>To download, add, and use this application, follow the steps delineated below:</p>
<ol>
<li>
<p>Sign up for a free account at <a href="https://splunkbase.splunk.com/" target="_blank" rel="noopener nofollow">splunkbase</a>
<img src="./saved_page_files/116.png" alt="Image"></p>
</li>
<li>
<p>Once registered, log into your account</p>
</li>
<li>
<p>Head over to the <a href="https://splunkbase.splunk.com/app/3544" target="_blank" rel="noopener nofollow">Sysmon App for Splunk</a> page to download the application.
<img src="./saved_page_files/117.png" alt="Image"></p>
</li>
<li>
<p>Add the application as follows to your search head.
<img src="./saved_page_files/118.png" alt="Image"></p>
<p><img src="./saved_page_files/119.png" alt="Image"></p>
<p><img src="./saved_page_files/120.png" alt="Image"></p>
</li>
<li>
<p>Adjust the application's <a href="https://docs.splunk.com/Documentation/Splunk/latest/Knowledge/Definesearchmacros" target="_blank" rel="noopener nofollow">macro</a> so that events are loaded as follows.
<img src="./saved_page_files/121.png" alt="Image"></p>
<p><img src="./saved_page_files/122.png" alt="Image"></p>
<p><img src="./saved_page_files/123.png" alt="Image"></p>
<p><img src="./saved_page_files/124.png" alt="Image"></p>
</li>
</ol>
<p>Let's access the Sysmon App for Splunk by locating it in the "Apps" column on the Splunk home page and head over to the <code>File Activity</code> tab.
<img src="./saved_page_files/125.png" alt="Image"></p>
<p>Let's now specify "All time" on the time picker and click "Submit". Results are generated successfully; however, no results are appearing in the "Top Systems" section.
<img src="./saved_page_files/126.png" alt="Image"></p>
<p>We can fix that by clicking on "Edit" (upper right hand corner of the screen) and editing the search.
<img src="./saved_page_files/127.png" alt="Image"></p>
<p>The Sysmon Events with ID 11 do not contain a field named <code>Computer</code>, but they do include a field called <code>ComputerName</code>. Let's fix that and click "Apply"
<img src="./saved_page_files/128.png" alt="Image"></p>
<p>Results should now be generated successfully in the "Top Systems" section.
<img src="./saved_page_files/129.png" alt="Image"></p>
<div class="card bg-light">
    <div class="card-body">
				 <p class="mb-0">Feel free to explore and experiment with this Splunk application. An excellent exercise is to modify the searches when no results are generated due to non-existent fields being specified, continuing until the desired results are obtained. </p>
    </div>
</div>
<hr>
<h2>Practical Exercises</h2>
<p>Navigate to the bottom of this section and click on <code>Click here to spawn the target system!</code></p>
<p>Now, navigate to <code>http://[Target IP]:8000</code>, open the <code>Sysmon App for Splunk</code> application, and answer the questions below.</p>

            
                        <div id="vpn-switch" class="my-3 p-3 vpn-switch-card">
                <p class="font-size-14 color-white mb-0">VPN Servers</p>
                <p class="font-size-13 mb-0">
                    <i class="fas fa-exclamation-triangle text-warning"></i><span class="color-white ml-1">Warning:</span> Each
                    time you "Switch",
                    your connection keys are regenerated and you must re-download your VPN connection file.
                </p>
                <p class="font-size-13 mb-0">
                    All VM instances associated with the old VPN Server will be terminated when switching to
                    a new VPN server. <br>
                    Existing PwnBox instances will automatically switch to the new VPN server.</p>
                <div class="row mb-3">
                    <div class="col-12  mt-2">
                        <div class="d-none justify-content-center vpn-loader">
                            <div class="spinner-border text-success" role="status">
                                <span class="sr-only">Switching VPN...</span>
                            </div>
                        </div>

                        <div class="dropdown bootstrap-select custom-form-control vpnSelector badge-select"><select class="selectpicker custom-form-control vpnSelector badge-select" aria-label="vpn server" title="Select VPN Server" tabindex="-98"><option class="bs-title-option" value=""></option>
                                                            <option value="9" data-level="21" data-content="&lt;div class=&#39;d-flex justify-content-between align-items-center&#39;&gt; &lt;div class=&#39;server-title&#39;&gt;US Academy 3 &lt;/div&gt; &lt;div class=&#39;d-flex align-items-center&#39;&gt; &lt;span class=&#39;recommended&#39;&gt; &lt;img src=&#39;/images/sparkles-solid.svg&#39;/&gt;Recommended&lt;/span&gt;  &lt;div class=&#39;d-flex align-items-center justify-content-center mr-2 load load-success &#39;&gt;low Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" selected="">US Academy 3</option>
                                                            <option value="13" data-level="21" data-content="&lt;div class=&#39;d-flex justify-content-between align-items-center&#39;&gt; &lt;div class=&#39;server-title&#39;&gt;US Academy 4 &lt;/div&gt; &lt;div class=&#39;d-flex align-items-center&#39;&gt; &lt;span class=&#39;recommended&#39;&gt; &lt;img src=&#39;/images/sparkles-solid.svg&#39;/&gt;Recommended&lt;/span&gt;  &lt;div class=&#39;d-flex align-items-center justify-content-center mr-2 load load-success &#39;&gt;low Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;">US Academy 4</option>
                                                            <option value="12" data-level="22" data-content="&lt;div class=&#39;d-flex justify-content-between align-items-center&#39;&gt; &lt;div class=&#39;server-title&#39;&gt;EU Academy 5 &lt;/div&gt; &lt;div class=&#39;d-flex align-items-center&#39;&gt; &lt;span class=&#39;recommended&#39;&gt; &lt;img src=&#39;/images/sparkles-solid.svg&#39;/&gt;Recommended&lt;/span&gt;  &lt;div class=&#39;d-flex align-items-center justify-content-center mr-2 load load-success &#39;&gt;low Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;">EU Academy 5</option>
                                                            <option value="5" data-level="23" data-content="&lt;div class=&#39;d-flex justify-content-between align-items-center&#39;&gt; &lt;div class=&#39;server-title&#39;&gt;US Academy 2 &lt;/div&gt; &lt;div class=&#39;d-flex align-items-center&#39;&gt;  &lt;div class=&#39;d-flex align-items-center justify-content-center mr-2 load load-success &#39;&gt;low Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;">US Academy 2</option>
                                                            <option value="16" data-level="23" data-content="&lt;div class=&#39;d-flex justify-content-between align-items-center&#39;&gt; &lt;div class=&#39;server-title&#39;&gt;US Academy 5 &lt;/div&gt; &lt;div class=&#39;d-flex align-items-center&#39;&gt;  &lt;div class=&#39;d-flex align-items-center justify-content-center mr-2 load load-success &#39;&gt;low Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;">US Academy 5</option>
                                                            <option value="4" data-level="26" data-content="&lt;div class=&#39;d-flex justify-content-between align-items-center&#39;&gt; &lt;div class=&#39;server-title&#39;&gt;US Academy 1 &lt;/div&gt; &lt;div class=&#39;d-flex align-items-center&#39;&gt;  &lt;div class=&#39;d-flex align-items-center justify-content-center mr-2 load load-success &#39;&gt;low Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;">US Academy 1</option>
                                                            <option value="1" data-level="27" data-content="&lt;div class=&#39;d-flex justify-content-between align-items-center&#39;&gt; &lt;div class=&#39;server-title&#39;&gt;EU Academy 1 &lt;/div&gt; &lt;div class=&#39;d-flex align-items-center&#39;&gt;  &lt;div class=&#39;d-flex align-items-center justify-content-center mr-2 load load-success &#39;&gt;low Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;">EU Academy 1</option>
                                                            <option value="14" data-level="27" data-content="&lt;div class=&#39;d-flex justify-content-between align-items-center&#39;&gt; &lt;div class=&#39;server-title&#39;&gt;EU Academy 3 &lt;/div&gt; &lt;div class=&#39;d-flex align-items-center&#39;&gt;  &lt;div class=&#39;d-flex align-items-center justify-content-center mr-2 load load-success &#39;&gt;low Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;">EU Academy 3</option>
                                                            <option value="11" data-level="28" data-content="&lt;div class=&#39;d-flex justify-content-between align-items-center&#39;&gt; &lt;div class=&#39;server-title&#39;&gt;EU Academy 4 &lt;/div&gt; &lt;div class=&#39;d-flex align-items-center&#39;&gt;  &lt;div class=&#39;d-flex align-items-center justify-content-center mr-2 load load-success &#39;&gt;low Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;">EU Academy 4</option>
                                                            <option value="17" data-level="30" data-content="&lt;div class=&#39;d-flex justify-content-between align-items-center&#39;&gt; &lt;div class=&#39;server-title&#39;&gt;US Academy 6 &lt;/div&gt; &lt;div class=&#39;d-flex align-items-center&#39;&gt;  &lt;div class=&#39;d-flex align-items-center justify-content-center mr-2 load load-warning &#39;&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;">US Academy 6</option>
                                                            <option value="2" data-level="31" data-content="&lt;div class=&#39;d-flex justify-content-between align-items-center&#39;&gt; &lt;div class=&#39;server-title&#39;&gt;EU Academy 2 &lt;/div&gt; &lt;div class=&#39;d-flex align-items-center&#39;&gt;  &lt;div class=&#39;d-flex align-items-center justify-content-center mr-2 load load-warning &#39;&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;">EU Academy 2</option>
                                                            <option value="15" data-level="31" data-content="&lt;div class=&#39;d-flex justify-content-between align-items-center&#39;&gt; &lt;div class=&#39;server-title&#39;&gt;EU Academy 6 &lt;/div&gt; &lt;div class=&#39;d-flex align-items-center&#39;&gt;  &lt;div class=&#39;d-flex align-items-center justify-content-center mr-2 load load-warning &#39;&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;">EU Academy 6</option>
                                                    </select><button type="button" class="btn dropdown-toggle btn-light" data-toggle="dropdown" role="combobox" aria-owns="bs-select-1" aria-haspopup="listbox" aria-expanded="false" title="US Academy 3    Recommended  low Load"><div class="filter-option"><div class="filter-option-inner"><div class="filter-option-inner-inner"><div class="d-flex justify-content-between align-items-center"> <div class="server-title">US Academy 3 </div> <div class="d-flex align-items-center"> <span class="recommended"> <img src="./saved_page_files/sparkles-solid.svg">Recommended</span>  <div class="d-flex align-items-center justify-content-center mr-2 load load-success ">low Load  </div>  </div></div></div></div> </div></button><div class="dropdown-menu "><div class="inner show" role="listbox" id="bs-select-1" tabindex="-1"><ul class="dropdown-menu inner show" role="presentation"></ul></div></div></div>

                        <p class="font-size-14 color-white mb-0 mt-2">PROTOCOL</p>

                        <div class="d-flex">

                            <div class="custom-control custom-radio custom-control-inline">
                                <input type="radio" id="rd_1" name="vpn-protocol" class="custom-control-input" value="udp" checked="">
                                <label class="custom-control-label green font-size-14" for="rd_1">UDP
                                    1337</label>
                            </div>
                            <div class="custom-control custom-radio">
                                <input type="radio" id="rd_2" name="vpn-protocol" class="custom-control-input" value="tcp">
                                <label class="custom-control-label green font-size-14" for="rd_2">TCP
                                    443</label>
                            </div>
                        </div>

                        <div class="d-flex justify-content-center">
                            <button class="btn btn-outline-success btn-lg download-vpn-settings mt-3 px-5 font-size-12 ">
                                DOWNLOAD VPN CONNECTION FILE
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="mb-5 pwnbox-select-card"><wc-htb-pwnbox-selection-card regions="[{&quot;name&quot;:&quot;UK&quot;,&quot;value&quot;:&quot;uk&quot;,&quot;latency&quot;:191},{&quot;name&quot;:&quot;US EAST&quot;,&quot;value&quot;:&quot;us-east&quot;,&quot;latency&quot;:181},{&quot;name&quot;:&quot;US WEST&quot;,&quot;value&quot;:&quot;us-west&quot;,&quot;latency&quot;:62},{&quot;name&quot;:&quot;DE&quot;,&quot;value&quot;:&quot;de&quot;,&quot;latency&quot;:191},{&quot;name&quot;:&quot;IN&quot;,&quot;value&quot;:&quot;in&quot;,&quot;latency&quot;:315},{&quot;name&quot;:&quot;SG&quot;,&quot;value&quot;:&quot;sg&quot;,&quot;latency&quot;:349},{&quot;name&quot;:&quot;CA&quot;,&quot;value&quot;:&quot;ca&quot;,&quot;latency&quot;:74},{&quot;name&quot;:&quot;AU&quot;,&quot;value&quot;:&quot;au&quot;,&quot;latency&quot;:314}]" current-pwnbox="{&quot;title&quot;:&quot;US WEST&quot;,&quot;value&quot;:&quot;us-west&quot;,&quot;proxyLatencyURL&quot;:&quot;https://proxy-us-west.htb-cloud.com/latency_pixel.png&quot;}"><template shadowrootmode="open"><style>@import"https://use.typekit.net/ryt3opf.css";.htb-border-subtle-00{border:1px solid #182232}.htb-border-subtle-00-top{border-top:1px solid #182232}.htb-border-subtle-00-bottom{border-bottom:1px solid #182232}.htb-border-subtle-00-left{border-left:1px solid #182232}.htb-border-subtle-00-right{border-right:1px solid #182232}.htb-border-subtle-bg{border:1px solid #1e2939}.htb-border-subtle-bg-top{border-top:1px solid #1e2939}.htb-border-subtle-bg-bottom{border-bottom:1px solid #1e2939}.htb-border-subtle-bg-left{border-left:1px solid #1e2939}.htb-border-subtle-bg-right{border-right:1px solid #1e2939}.htb-border-subtle-01{border:1px solid #242f40}.htb-border-subtle-01-top{border-top:1px solid #242f40}.htb-border-subtle-01-bottom{border-bottom:1px solid #242f40}.htb-border-subtle-01-left{border-left:1px solid #242f40}.htb-border-subtle-01-right{border-right:1px solid #242f40}.htb-border-subtle-02{border:1px solid #293547}.htb-border-subtle-02-top{border-top:1px solid #293547}.htb-border-subtle-02-bottom{border-bottom:1px solid #293547}.htb-border-subtle-02-left{border-left:1px solid #293547}.htb-border-subtle-02-right{border-right:1px solid #293547}.htb-border-subtle-03{border:1px solid #2f3b4e}.htb-border-subtle-03-top{border-top:1px solid #2f3b4e}.htb-border-subtle-03-bottom{border-bottom:1px solid #2f3b4e}.htb-border-subtle-03-left{border-left:1px solid #2f3b4e}.htb-border-subtle-03-right{border-right:1px solid #2f3b4e}.htb-border-strong-00{border:1px solid #1e2939}.htb-border-strong-00-top{border-top:1px solid #1e2939}.htb-border-strong-00-bottom{border-bottom:1px solid #1e2939}.htb-border-strong-00-left{border-left:1px solid #1e2939}.htb-border-strong-00-right{border-right:1px solid #1e2939}.htb-border-strong-bg{border:1px solid #242f40}.htb-border-strong-bg-top{border-top:1px solid #242f40}.htb-border-strong-bg-bottom{border-bottom:1px solid #242f40}.htb-border-strong-bg-left{border-left:1px solid #242f40}.htb-border-strong-bg-right{border-right:1px solid #242f40}.htb-border-strong-01{border:1px solid #293547}.htb-border-strong-01-top{border-top:1px solid #293547}.htb-border-strong-01-bottom{border-bottom:1px solid #293547}.htb-border-strong-01-left{border-left:1px solid #293547}.htb-border-strong-01-right{border-right:1px solid #293547}.htb-border-strong-02{border:1px solid #2f3b4e}.htb-border-strong-02-top{border-top:1px solid #2f3b4e}.htb-border-strong-02-bottom{border-bottom:1px solid #2f3b4e}.htb-border-strong-02-left{border-left:1px solid #2f3b4e}.htb-border-strong-02-right{border-right:1px solid #2f3b4e}.htb-border-strong-03{border:1px solid #354154}.htb-border-strong-03-top{border-top:1px solid #354154}.htb-border-strong-03-bottom{border-bottom:1px solid #354154}.htb-border-strong-03-left{border-left:1px solid #354154}.htb-border-strong-03-right{border-right:1px solid #354154}.htb-border-active{border:1px solid #9fef00}.htb-border-active-top{border-top:1px solid #9fef00}.htb-border-active-bottom{border-bottom:1px solid #9fef00}.htb-border-active-left{border-left:1px solid #9fef00}.htb-border-active-right{border-right:1px solid #9fef00}.htb-border-focus{border:1px solid #f4f4f4}.htb-border-focus-top{border-top:1px solid #f4f4f4}.htb-border-focus-bottom{border-bottom:1px solid #f4f4f4}.htb-border-focus-left{border-left:1px solid #f4f4f4}.htb-border-focus-right{border-right:1px solid #f4f4f4}.htb-border-pressed{border:1px solid #354154}.htb-border-pressed-top{border-top:1px solid #354154}.htb-border-pressed-bottom{border-bottom:1px solid #354154}.htb-border-pressed-left{border-left:1px solid #354154}.htb-border-pressed-right{border-right:1px solid #354154}.htb-border-disabled{border:1px solid #526177}.htb-border-disabled-top{border-top:1px solid #526177}.htb-border-disabled-bottom{border-bottom:1px solid #526177}.htb-border-disabled-left{border-left:1px solid #526177}.htb-border-disabled-right{border-right:1px solid #526177}.htb-layer-00-bg{background-color:#101927!important}.htb-layer-00-bg-hoverable{cursor:pointer;background-color:#101927}.htb-layer-00-bg-hoverable:hover{background-color:#121c2b}.htb-layer-00-bg-hoverable:active{background-color:#182232}.htb-layer-00-bg-hoverable.selected{background-color:#0f1623}.htb-layer-background-bg{background-color:#121c2b!important}.htb-layer-background-bg-hoverable{cursor:pointer;background-color:#121c2b}.htb-layer-background-bg-hoverable:hover{background-color:#182232}.htb-layer-background-bg-hoverable:active{background-color:#1e2939}.htb-layer-background-bg-hoverable.selected{background-color:#101927}.htb-layer-01-bg{background-color:#182232!important}.htb-layer-01-bg-hoverable{cursor:pointer;background-color:#182232}.htb-layer-01-bg-hoverable:hover{background-color:#1e2939}.htb-layer-01-bg-hoverable:active{background-color:#242f40}.htb-layer-01-bg-hoverable.selected{background-color:#121c2b}.htb-layer-02-bg{background-color:#1e2939!important}.htb-layer-02-bg-hoverable{cursor:pointer;background-color:#1e2939}.htb-layer-02-bg-hoverable:hover{background-color:#242f40}.htb-layer-02-bg-hoverable:active{background-color:#293547}.htb-layer-02-bg-hoverable.selected{background-color:#182232}.htb-layer-03-bg{background-color:#242f40!important}.htb-layer-03-bg-hoverable{cursor:pointer;background-color:#242f40}.htb-layer-03-bg-hoverable:hover{background-color:#293547}.htb-layer-03-bg-hoverable:active{background-color:#2f3b4e}.htb-layer-03-bg-hoverable.selected{background-color:#1e2939}.htb-uppercase{text-transform:uppercase!important}.htb-lowercase{text-transform:lowercase!important}.htb-capitalize{text-transform:capitalize!important}.htb-text-left{text-align:left!important}.htb-text-center{text-align:center!important}.htb-text-right{text-align:right!important}.htb-text-justify{text-align:justify!important}.htb-text-transform-none{text-transform:none!important}.htb-text-underline{text-decoration:underline!important}.htb-text-primary{color:#f4f4f4!important}.htb-text-secondary{color:#8799b5!important}.htb-text-accent{color:#9fef00!important}.htb-text-primary-inverse{color:#121c2b!important}.htb-text-disabled{color:#526177!important}.htb-link{color:#b2f233!important}.htb-text-information{color:#4589ff!important}.htb-text-warning{color:#ffc744!important}.htb-text-error{color:#e4423b!important}.htb-text-placeholder{color:#526177!important}.htb-text-helper{color:#8799b5!important}.htb-link-hover{color:#7fbf00!important}.htb-link-pressed{color:#5f8f00!important}fieldset[disabled] .multiselect{pointer-events:none}.multiselect__spinner{position:absolute;right:1px;top:1px;width:40px;height:38px;background:#fff;display:block}.multiselect__spinner:before,.multiselect__spinner:after{position:absolute;content:"";top:50%;left:50%;margin:-8px 0 0 -8px;width:16px;height:16px;border-radius:100%;border-color:#41b883 transparent transparent;border-style:solid;border-width:2px;box-shadow:0 0 0 1px transparent}.multiselect__spinner:before{animation:spinning 2.4s cubic-bezier(.41,.26,.2,.62);animation-iteration-count:infinite}.multiselect__spinner:after{animation:spinning 2.4s cubic-bezier(.51,.09,.21,.8);animation-iteration-count:infinite}.multiselect__loading-enter-active,.multiselect__loading-leave-active{transition:opacity .4s ease-in-out;opacity:1}.multiselect__loading-enter,.multiselect__loading-leave-active{opacity:0}.multiselect,.multiselect__input,.multiselect__single{font-family:inherit;font-size:16px;touch-action:manipulation}.multiselect{box-sizing:content-box;display:block;position:relative;width:100%;min-height:40px;text-align:left;color:#35495e}.multiselect *{box-sizing:border-box}.multiselect:focus{outline:none}.multiselect--disabled{background:#ededed;pointer-events:none;opacity:.6}.multiselect--active{z-index:50}.multiselect--active:not(.multiselect--above) .multiselect__current,.multiselect--active:not(.multiselect--above) .multiselect__input,.multiselect--active:not(.multiselect--above) .multiselect__tags{border-bottom-left-radius:0;border-bottom-right-radius:0}.multiselect--active .multiselect__select{transform:rotate(180deg)}.multiselect--above.multiselect--active .multiselect__current,.multiselect--above.multiselect--active .multiselect__input,.multiselect--above.multiselect--active .multiselect__tags{border-top-left-radius:0;border-top-right-radius:0}.multiselect__input,.multiselect__single{position:relative;display:inline-block;min-height:20px;line-height:20px;border:none;border-radius:5px;background:#fff;padding:0 0 0 5px;width:100%;transition:border .1s ease;box-sizing:border-box;margin-bottom:8px;vertical-align:top}.multiselect__input::placeholder{color:#35495e}.multiselect__tag~.multiselect__input,.multiselect__tag~.multiselect__single{width:auto}.multiselect__input:hover,.multiselect__single:hover{border-color:#cfcfcf}.multiselect__input:focus,.multiselect__single:focus{border-color:#a8a8a8;outline:none}.multiselect__single{padding-left:5px;margin-bottom:8px}.multiselect__tags-wrap{display:inline}.multiselect__tags{min-height:40px;display:block;padding:8px 40px 0 8px;border-radius:5px;border:1px solid #e8e8e8;background:#fff;font-size:14px}.multiselect__tag{position:relative;display:inline-block;padding:4px 26px 4px 10px;border-radius:5px;margin-right:10px;color:#fff;line-height:1;background:#41b883;margin-bottom:5px;white-space:nowrap;overflow:hidden;max-width:100%;text-overflow:ellipsis}.multiselect__tag-icon{cursor:pointer;margin-left:7px;position:absolute;right:0;top:0;bottom:0;font-weight:700;font-style:initial;width:22px;text-align:center;line-height:22px;transition:all .2s ease;border-radius:5px}.multiselect__tag-icon:after{content:"×";color:#266d4d;font-size:14px}.multiselect__tag-icon:focus:after,.multiselect__tag-icon:hover:after{color:#fff}.multiselect__current{line-height:16px;min-height:40px;box-sizing:border-box;display:block;overflow:hidden;padding:8px 30px 0 12px;white-space:nowrap;margin:0;text-decoration:none;border-radius:5px;border:1px solid #e8e8e8;cursor:pointer}.multiselect__select{line-height:16px;display:block;position:absolute;box-sizing:border-box;width:40px;height:38px;right:1px;top:1px;padding:4px 8px;margin:0;text-decoration:none;text-align:center;cursor:pointer;transition:transform .2s ease}.multiselect__select:before{position:relative;right:0;top:65%;color:#999;margin-top:4px;border-style:solid;border-width:5px 5px 0 5px;border-color:#999 transparent transparent transparent;content:""}.multiselect__placeholder{color:#adadad;display:inline-block;margin-bottom:10px;padding-top:2px}.multiselect--active .multiselect__placeholder{display:none}.multiselect__content-wrapper{position:absolute;display:block;background:#fff;width:100%;max-height:240px;overflow:auto;border:1px solid #e8e8e8;border-top:none;border-bottom-left-radius:5px;border-bottom-right-radius:5px;z-index:50;-webkit-overflow-scrolling:touch}.multiselect__content{list-style:none;display:inline-block;padding:0;margin:0;min-width:100%;vertical-align:top}.multiselect--above .multiselect__content-wrapper{bottom:100%;border-radius:5px 5px 0 0;border-bottom:none;border-top:1px solid #e8e8e8}.multiselect__content::-webkit-scrollbar{display:none}.multiselect__element{display:block}.multiselect__option{display:block;padding:12px;min-height:40px;line-height:16px;text-decoration:none;text-transform:none;vertical-align:middle;position:relative;cursor:pointer;white-space:nowrap}.multiselect__option:after{top:0;right:0;position:absolute;line-height:40px;padding-right:12px;padding-left:20px;font-size:13px}.multiselect__option--highlight{background:#41b883;outline:none;color:#fff}.multiselect__option--highlight:after{content:attr(data-select);background:#41b883;color:#fff}.multiselect__option--selected{background:#f3f3f3;color:#35495e;font-weight:700}.multiselect__option--selected:after{content:attr(data-selected);color:silver;background:inherit}.multiselect__option--selected.multiselect__option--highlight{background:#ff6a6a;color:#fff}.multiselect__option--selected.multiselect__option--highlight:after{background:#ff6a6a;content:attr(data-deselect);color:#fff}.multiselect--disabled .multiselect__current,.multiselect--disabled .multiselect__select{background:#ededed;color:#a6a6a6}.multiselect__option--disabled{background:#ededed!important;color:#a6a6a6!important;cursor:text;pointer-events:none}.multiselect__option--group{background:#ededed;color:#35495e}.multiselect__option--group.multiselect__option--highlight{background:#35495e;color:#fff}.multiselect__option--group.multiselect__option--highlight:after{background:#35495e}.multiselect__option--disabled.multiselect__option--highlight{background:#dedede}.multiselect__option--group-selected.multiselect__option--highlight{background:#ff6a6a;color:#fff}.multiselect__option--group-selected.multiselect__option--highlight:after{background:#ff6a6a;content:attr(data-deselect);color:#fff}.multiselect-enter-active,.multiselect-leave-active{transition:all .15s ease}.multiselect-enter,.multiselect-leave-active{opacity:0}.multiselect__strong{margin-bottom:8px;line-height:20px;display:inline-block;vertical-align:top}*[dir=rtl] .multiselect{text-align:right}*[dir=rtl] .multiselect__select{right:auto;left:1px}*[dir=rtl] .multiselect__tags{padding:8px 8px 0 40px}*[dir=rtl] .multiselect__content{text-align:right}*[dir=rtl] .multiselect__option:after{right:auto;left:0}*[dir=rtl] .multiselect__clear{right:auto;left:12px}*[dir=rtl] .multiselect__spinner{right:auto;left:1px}@keyframes spinning{0%{transform:rotate(0)}to{transform:rotate(2turn)}}.m-0{margin:0rem!important}.p-0{padding:0rem!important}.mt-0{margin-top:0rem!important}.pt-0{padding-top:0rem!important}.mr-0{margin-right:0rem!important}.pr-0{padding-right:0rem!important}.mb-0{margin-bottom:0rem!important}.pb-0{padding-bottom:0rem!important}.ml-0{margin-left:0rem!important}.pl-0{padding-left:0rem!important}.mx-0{margin-left:0rem!important;margin-right:0rem!important}.my-0{margin-top:0rem!important;margin-bottom:0rem!important}.px-0{padding-left:0rem!important;padding-right:0rem!important}.py-0{padding-top:0rem!important;padding-bottom:0rem!important}.m-1{margin:.25rem!important}.p-1{padding:.25rem!important}.mt-1{margin-top:.25rem!important}.pt-1{padding-top:.25rem!important}.mr-1{margin-right:.25rem!important}.pr-1{padding-right:.25rem!important}.mb-1{margin-bottom:.25rem!important}.pb-1{padding-bottom:.25rem!important}.ml-1{margin-left:.25rem!important}.pl-1{padding-left:.25rem!important}.mx-1{margin-left:.25rem!important;margin-right:.25rem!important}.my-1{margin-top:.25rem!important;margin-bottom:.25rem!important}.px-1{padding-left:.25rem!important;padding-right:.25rem!important}.py-1{padding-top:.25rem!important;padding-bottom:.25rem!important}.m-2{margin:.5rem!important}.p-2{padding:.5rem!important}.mt-2{margin-top:.5rem!important}.pt-2{padding-top:.5rem!important}.mr-2{margin-right:.5rem!important}.pr-2{padding-right:.5rem!important}.mb-2{margin-bottom:.5rem!important}.pb-2{padding-bottom:.5rem!important}.ml-2{margin-left:.5rem!important}.pl-2{padding-left:.5rem!important}.mx-2{margin-left:.5rem!important;margin-right:.5rem!important}.my-2{margin-top:.5rem!important;margin-bottom:.5rem!important}.px-2{padding-left:.5rem!important;padding-right:.5rem!important}.py-2{padding-top:.5rem!important;padding-bottom:.5rem!important}.m-3{margin:.75rem!important}.p-3{padding:.75rem!important}.mt-3{margin-top:.75rem!important}.pt-3{padding-top:.75rem!important}.mr-3{margin-right:.75rem!important}.pr-3{padding-right:.75rem!important}.mb-3{margin-bottom:.75rem!important}.pb-3{padding-bottom:.75rem!important}.ml-3{margin-left:.75rem!important}.pl-3{padding-left:.75rem!important}.mx-3{margin-left:.75rem!important;margin-right:.75rem!important}.my-3{margin-top:.75rem!important;margin-bottom:.75rem!important}.px-3{padding-left:.75rem!important;padding-right:.75rem!important}.py-3{padding-top:.75rem!important;padding-bottom:.75rem!important}.m-4{margin:1rem!important}.p-4{padding:1rem!important}.mt-4{margin-top:1rem!important}.pt-4{padding-top:1rem!important}.mr-4{margin-right:1rem!important}.pr-4{padding-right:1rem!important}.mb-4{margin-bottom:1rem!important}.pb-4{padding-bottom:1rem!important}.ml-4{margin-left:1rem!important}.pl-4{padding-left:1rem!important}.mx-4{margin-left:1rem!important;margin-right:1rem!important}.my-4{margin-top:1rem!important;margin-bottom:1rem!important}.px-4{padding-left:1rem!important;padding-right:1rem!important}.py-4{padding-top:1rem!important;padding-bottom:1rem!important}.m-5{margin:1.5rem!important}.p-5{padding:1.5rem!important}.mt-5{margin-top:1.5rem!important}.pt-5{padding-top:1.5rem!important}.mr-5{margin-right:1.5rem!important}.pr-5{padding-right:1.5rem!important}.mb-5{margin-bottom:1.5rem!important}.pb-5{padding-bottom:1.5rem!important}.ml-5{margin-left:1.5rem!important}.pl-5{padding-left:1.5rem!important}.mx-5{margin-left:1.5rem!important;margin-right:1.5rem!important}.my-5{margin-top:1.5rem!important;margin-bottom:1.5rem!important}.px-5{padding-left:1.5rem!important;padding-right:1.5rem!important}.py-5{padding-top:1.5rem!important;padding-bottom:1.5rem!important}.m-6{margin:3rem!important}.p-6{padding:3rem!important}.mt-6{margin-top:3rem!important}.pt-6{padding-top:3rem!important}.mr-6{margin-right:3rem!important}.pr-6{padding-right:3rem!important}.mb-6{margin-bottom:3rem!important}.pb-6{padding-bottom:3rem!important}.ml-6{margin-left:3rem!important}.pl-6{padding-left:3rem!important}.mx-6{margin-left:3rem!important;margin-right:3rem!important}.my-6{margin-top:3rem!important;margin-bottom:3rem!important}.px-6{padding-left:3rem!important;padding-right:3rem!important}.py-6{padding-top:3rem!important;padding-bottom:3rem!important}body{font-family:neue-haas-unica,sans-serif;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.text-center{text-align:center}.text-left{text-align:left}.border-radius-6{border-radius:6px}.d-flex{display:flex;flex-direction:row}@media (max-width: 600px){.d-flex{flex-direction:column}}.flex-column{flex-direction:column}.align-items-center{align-items:center}.align-items-start{align-items:start}.multiselect__option{color:#b0bbd4!important;font-size:14px;font-style:normal;font-weight:500;line-height:20px;letter-spacing:.14px}.multiselect__option:hover{color:#f2f4f8!important;font-weight:700!important}.multiselect__option--highlight{background-color:#9fef001a!important;outline:none;color:#f2f4f8!important}.multiselect__option--highlight:after{content:attr(data-select);background:#9fef00!important;color:#182432!important;font-weight:300!important}.multiselect__option--selected{background-color:#212e3e!important;color:#f2f4f8!important}.multiselect__tags{background-color:#121c2b!important;color:#a4b1cd!important;border:none!important}.multiselect__tag{background-color:#9fef00!important;color:#182432!important}.multiselect__content-wrapper{background-color:#121c2b!important;border:none!important}.multiselect__placeholder{color:#f4f4f4!important}.multiselect__tag-icon:hover{background-color:#86c903!important}.multiselect__option--selected.multiselect__option--highlight{background-color:#9fef001a!important;color:#f2f4f8!important}.multiselect__option--selected.multiselect__option--highlight:after{background:#ff6a6a!important;content:attr(data-deselect);color:#fff!important}.multiselect .multiselect__input,.multiselect__single{font-size:14px;background-color:#121c2b!important;color:#f4f4f4!important}.has-error .multiselect__tags{color:#e4423b!important;border-radius:5px!important;border:2px solid #e4423b!important}.has-success .multiselect__tags{color:#9fef00!important;border-radius:5px;border-color:2px solid #9fef00!important}.pwnbox-card{background:#1A2332;border-radius:8px}.pwnbox-card.disabled{pointer-events:none}.pwnbox-card .card-icon-wrapper{border:2px solid #9fef00;border-radius:50%;display:flex;width:44px;height:44px;justify-content:center;align-items:center}.pwnbox-card .card-icon{position:relative;left:8px;top:4px}.pwnbox-card .card-title{font-weight:700;font-size:16px;line-height:24px}.pwnbox-card .card-subtitle{color:#8799b5;font-size:14px;font-weight:500;line-height:20px;letter-spacing:.14px;text-align:left}.pwnbox-card .selector-label{color:#8799b5;font-size:12px;font-style:normal;font-weight:500;line-height:18px;letter-spacing:.24px}.pwnbox-card .spawn-btn{font-family:neue-haas-unica,sans-serif;font-size:10px;text-wrap:nowrap;color:#121c2b;background-color:#9fef00;border:none;border-radius:.4rem;padding:10px 30px;cursor:pointer;text-align:center;text-decoration:none;text-transform:uppercase;display:inline-block;margin:4px 2px;letter-spacing:1.2px!important}.pwnbox-card .spawn-btn:hover{background-color:#b2f233}.pwnbox-card .spawn-btn:disabled{pointer-events:none;background-color:#7fbf00;border-color:#7fbf00}.pwnbox-card .latency-container{display:flex;justify-content:space-between}.badge{margin-left:16px;font-size:10px;padding:3px 10px;border-radius:400px;height:18px;justify-content:center;display:flex;align-items:center}.badge.success{color:#9fef00;background-color:#9fef0033}.badge.warning{color:#ffc744;background-color:#ffc74433}.badge.danger{color:#e4423b;background-color:#e4423b33}
</style><div class="text-center my-5 p-4 pwnbox-card"><div class="d-flex align-items-center"><div class="card-icon-wrapper mr-3"><svg width="32" height="32" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg" class="card-icon"><g id="Frame 36"><path id="Vector" fill-rule="evenodd" clip-rule="evenodd" d="M15.1432 6.447C15.1363 6.04084 15.0475 5.64024 14.8822 5.26916C14.717 4.89809 14.4785 4.56416 14.1812 4.28735C13.8839 4.01055 13.5338 3.79655 13.1519 3.65816C12.77 3.51977 12.3641 3.45983 11.9585 3.48193C11.5977 2.76147 11.0424 2.15647 10.3554 1.73548C9.66845 1.3145 8.87728 1.09437 8.07158 1.10005C6.99334 1.08448 5.94962 1.48003 5.15255 2.20633C4.35547 2.93264 3.86484 3.93518 3.78038 5.01022C3.45056 4.93726 3.10868 4.93827 2.7793 5.01317C2.44992 5.08807 2.14122 5.235 1.87538 5.4434C1.60955 5.65181 1.39318 5.91651 1.24182 6.21849C1.09046 6.52048 1.00788 6.85224 1 7.18993C1 9.4545 3.45925 9.41956 3.45925 9.41956H12.3761C12.3761 9.41956 15.1432 9.06931 15.1432 6.447Z" stroke="white" stroke-width="0.998341" stroke-linecap="round" stroke-linejoin="round"></path><path id="Vector_2" fill-rule="evenodd" clip-rule="evenodd" d="M15.1432 18.987C15.1432 19.318 15.0117 19.6354 14.7777 19.8694C14.5436 20.1035 14.2262 20.2349 13.8952 20.2349H2.24793C1.91696 20.2349 1.59954 20.1035 1.36551 19.8694C1.13148 19.6354 1 19.318 1 18.987V17.3231C1 16.9922 1.13148 16.6747 1.36551 16.4407C1.59954 16.2067 1.91696 16.0752 2.24793 16.0752H13.8952C14.2262 16.0752 14.5436 16.2067 14.7777 16.4407C15.0117 16.6747 15.1432 16.9922 15.1432 17.3231V18.987Z" stroke="#9FEF00" stroke-width="0.998341" stroke-linecap="round" stroke-linejoin="round"></path><path id="Vector_3" fill-rule="evenodd" clip-rule="evenodd" d="M15.1432 14.8269C15.1432 15.1578 15.0117 15.4753 14.7777 15.7093C14.5436 15.9433 14.2262 16.0748 13.8952 16.0748H2.24793C1.91696 16.0748 1.59954 15.9433 1.36551 15.7093C1.13148 15.4753 1 15.1578 1 14.8269V13.163C1 12.832 1.13148 12.5146 1.36551 12.2805C1.59954 12.0465 1.91696 11.915 2.24793 11.915H13.8952C14.2262 11.915 14.5436 12.0465 14.7777 12.2805C15.0117 12.5146 15.1432 12.832 15.1432 13.163V14.8269Z" stroke="#9FEF00" stroke-width="0.998341" stroke-linecap="round" stroke-linejoin="round"></path><circle id="Ellipse 120" cx="3.70098" cy="13.9998" r="0.7" fill="#9FEF00"></circle><circle id="Ellipse 122" cx="3.70098" cy="18.2" r="0.5" stroke="#9FEF00" stroke-width="0.4"></circle><circle id="Ellipse 121" cx="5.80059" cy="13.9998" r="0.7" fill="#9FEF00"></circle><circle id="Ellipse 123" cx="5.80059" cy="18.2" r="0.5" stroke="#9FEF00" stroke-width="0.4"></circle></g></svg></div><div class="d-flex flex-column align-items-start"><h1 class="card-title htb-text-primary my-0" data-testid="card-title">Connect to Pwnbox</h1><p class="card-subtitle my-0" data-testid="card-subtitle"> Your own web-based Parrot Linux instance to play our labs. </p></div></div><div class="mt-4 text-left"><label class="selector-label mb-2" data-testid="label">Pwnbox Location</label><div class="d-flex"><div tabindex="0" class="multiselect my-1 mr-2" role="combobox" aria-owns="listbox-null" data-testid="pwnbox-location-selector"><div class="multiselect__select"></div><div class="multiselect__tags"><div class="multiselect__tags-wrap" style="display: none;"></div><!--v-if--><div class="multiselect__spinner" style="display: none;"></div><!--v-if--><span class="multiselect__single"><div class="latency-container" data-testid="pwnbox-option-item"><span data-testid="option-name">US WEST</span><span data-testid="option-latency" class="badge success">62ms</span></div></span><!--v-if--></div><div class="multiselect__content-wrapper" tabindex="-1" style="max-height: 300px; display: none;"><ul class="multiselect__content" role="listbox" id="listbox-null" style="display: inline-block;"><!--v-if--><li class="multiselect__element" id="null-0" role="option"><span class="multiselect__option--highlight multiselect__option" data-select="" data-selected="Selected" data-deselect=""><div class="latency-container" data-testid="pwnbox-option-item"><span data-testid="option-name">UK</span><span data-testid="option-latency" class="badge danger">191ms</span></div></span><!--v-if--></li><li class="multiselect__element" id="null-1" role="option"><span class="multiselect__option" data-select="" data-selected="Selected" data-deselect=""><div class="latency-container" data-testid="pwnbox-option-item"><span data-testid="option-name">US EAST</span><span data-testid="option-latency" class="badge danger">181ms</span></div></span><!--v-if--></li><li class="multiselect__element" id="null-2" role="option"><span class="multiselect__option" data-select="" data-selected="Selected" data-deselect=""><div class="latency-container" data-testid="pwnbox-option-item"><span data-testid="option-name">US WEST</span><span data-testid="option-latency" class="badge success">62ms</span></div></span><!--v-if--></li><li class="multiselect__element" id="null-3" role="option"><span class="multiselect__option" data-select="" data-selected="Selected" data-deselect=""><div class="latency-container" data-testid="pwnbox-option-item"><span data-testid="option-name">DE</span><span data-testid="option-latency" class="badge danger">191ms</span></div></span><!--v-if--></li><li class="multiselect__element" id="null-4" role="option"><span class="multiselect__option" data-select="" data-selected="Selected" data-deselect=""><div class="latency-container" data-testid="pwnbox-option-item"><span data-testid="option-name">IN</span><span data-testid="option-latency" class="badge danger">315ms</span></div></span><!--v-if--></li><li class="multiselect__element" id="null-5" role="option"><span class="multiselect__option" data-select="" data-selected="Selected" data-deselect=""><div class="latency-container" data-testid="pwnbox-option-item"><span data-testid="option-name">SG</span><span data-testid="option-latency" class="badge danger">349ms</span></div></span><!--v-if--></li><li class="multiselect__element" id="null-6" role="option"><span class="multiselect__option" data-select="" data-selected="Selected" data-deselect=""><div class="latency-container" data-testid="pwnbox-option-item"><span data-testid="option-name">CA</span><span data-testid="option-latency" class="badge success">74ms</span></div></span><!--v-if--></li><li class="multiselect__element" id="null-7" role="option"><span class="multiselect__option" data-select="" data-selected="Selected" data-deselect=""><div class="latency-container" data-testid="pwnbox-option-item"><span data-testid="option-name">AU</span><span data-testid="option-latency" class="badge danger">314ms</span></div></span><!--v-if--></li><li style="display: none;"><span class="multiselect__option">No elements found. Consider changing the search query.</span></li><li style="display: none;"><span class="multiselect__option">List is empty.</span></li></ul></div></div><!----></div><p class="d-flex align-items-center htb-text-secondary" data-testid="location-switch-warning"><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="mr-1"><g id="Alerts &amp; Feedback/alert-circle" clip-path="url(#clip0_1523_165)"><path id="Icon" d="M9.99996 6.6665V9.99984M9.99996 13.3332H10.0083M18.3333 9.99984C18.3333 14.6022 14.6023 18.3332 9.99996 18.3332C5.39759 18.3332 1.66663 14.6022 1.66663 9.99984C1.66663 5.39746 5.39759 1.6665 9.99996 1.6665C14.6023 1.6665 18.3333 5.39746 18.3333 9.99984Z" stroke="#4589FF" stroke-width="1.66667" stroke-linecap="round" stroke-linejoin="round"></path></g><defs><clippath id="clip0_1523_165"><rect width="20" height="20" fill="white"></rect></clippath></defs></svg>Terminate Pwnbox to switch location </p></div></div></template></wc-htb-pwnbox-selection-card></div>

            <div id="screen" style="height: 600px; border: 1px solid;">
                <div class="screenPlaceholder">
                    <div class="instanceLoading" style="display: none;">
                        <h1 class="text-center" style="margin-top: 270px;"><i class="fa fa-circle-notch fa-spin"></i>
                        </h1>
                        <div class="text-center">Instance is starting...</div>
                    </div>
                    <div class="instanceTerminating" style="display: none;">
                        <h1 class="text-center" style="margin-top: 270px;"><i class="fa fa-circle-notch fa-spin"></i>
                        </h1>
                        <div class="text-center">Terminating instance...</div>
                    </div>
                    <div class="row instanceStart max-width-canvas">
                        <div class="col-4"></div>
                        <div class="col-4">
                            <button class="startInstanceBtn btn btn-success text-light btn-lg btn-block " style="margin-top: 270px;">Start Instance
                            </button>
                            <p class="text-center mt-2 font-size-13 font-secondary">
                                <span class="text-success spawnsLeft">
                                                                        <i class="fal fa-infinity"></i>
                                                                    </span> / 1 spawns left
                            </p>
                        </div>
                        <div class="col-4"></div>
                    </div>
                </div>
            </div>
            <div class="row align-center justify-center my-4">
                <div class="col-5 justify-start">
                    <button style="display:none;" target="_blank" class="instance-button fullScreenBtn btn btn-light btn-sm float-left "><i class="fad fa-expand text-success mr-1"></i> &nbsp;Full Screen
                    </button>
                    <button style="display:none;" class="instance-button terminateInstanceBtn btn btn-light btn-sm ml-2"><i class="fad fa-times text-danger"></i> &nbsp;Terminate
                    </button>
                    <button style="display:none;" class="instance-button resetInstanceBtn btn btn-light btn-sm ml-1"><i class="fad fa-sync text-warning mr-2"></i> &nbsp;Reset
                    </button>
                    <div class="btn-group " role="group">
                        <button style="display:none;cursor: default;" class="instance-button extendInstanceBtn btn btn-light btn-sm ml-1">Life Left:
                            <span class="lifeLeft"></span>m
                        </button>
                                                <button style="display:none;" data-toggle="tooltip" data-title="Extend Life" class=" extendInstanceBtn extendInstanceBtnClicker btn btn-light btn-sm " data-original-title="" title=""><i class="fa fa-plus text-success"></i></button>
                                            </div>
                </div>

                <div id="statusText" class="col-7 justify-end pt-2 pr-2 font-size-small text-right">Waiting to
                    start...
                </div>
            </div>
                                                    <div id="solutionsModuleSetting" class="d-inline-block mb-2 solutionSettings solutionSettingsOffsets">
                    <div class="border border-secondary p-2 rounded">
                        <div class="custom-control custom-switch d-flex">
                            <input type="checkbox" class="custom-control-input" id="showSolutionsModuleSetting">
                            <label class="custom-control-label font-size-14 font-weight-normal text-white" for="showSolutionsModuleSetting">
                                Enable step-by-step solutions for all questions
                            </label>
                                                    </div>
                    </div>
                </div>
                        <div class="card" id="questionsDiv">
                <div class="card-body">
                    <div class="row">
                        <div class="col-9">
                            <h4 class="card-title mt-0 font-size-medium">Questions</h4>
                            <p class="card-title-desc font-size-large font-size-15">Answer the question(s) below
                                to complete this Section and earn cubes!</p>
                                                        <span class="spawnTargetBtn spawn-target-text-clone d-none">Click here to spawn the target
                                system!</span>
                            <p class="card-title-desc font-size-large font-size-15 mb-0">
    Target(s): <span class="text-success">
        <span class="target" style="cursor:pointer;"><span class="spawnTargetBtn" style="cursor:pointer;">Click here to spawn the target system!</span></span>
    </span>
    <button class="resetTargetBtn btn btn-light btn-sm" data-toggle="tooltip" data-title="Reset Target(s)" style="cursor: pointer; display: none;" data-original-title="" title="" disabled="">
        <i class="fad fa-sync text-warning"></i>
    </button>
    <br>
    </p><div class="align-items-center targetLifeContainer d-none">
        <span class="targetLifeTimeContainer" style="display: none;">
            Life Left: <span class="targetLifeTime font-size-15">0</span> minute(s)
                            <button data-toggle="tooltip" data-title="Extend Life by 1 hour (up to 6 hours total lifespan)" class="extendTargetSystemBtn btn btn-light btn-sm module-button" data-original-title="" title="">
                    <i class="fa fa-plus text-success extend-icon"></i>
                    <div class="extend-loader spinner-border spinner-border-small text-success d-none" role="status">
                    </div>
                </button>
                <button class="text-danger btn btn-light btn-sm module-button font-size-16 mb-1" data-toggle="modal" data-target="#terminateVmModal">
                    Terminate <span class="fa-regular fa-x text-danger font-size-13 ml-2"></span>
                </button>
                    </span>
    </div>
<p></p>
                                                    </div>
                        <div class="col-3 text-right float-right">
                                                                                    <a href="https://academy.hackthebox.com/vpn/key" class="btn btn-light bg-color-blue-nav mt-2 d-flex align-items-center" data-toggle="tooltip" data-title="Key is already installed in &quot;My Workstation&quot;" target="_blank" rel="noopener nofollow" data-original-title="" title="">
                                <div><i class="fad fa-chart-network mr-2"></i></div>
                                <div class="text-center w-100">Download VPN Connection File</div>
                            </a>
                                                    </div>

                    </div>
                    <div>
                                                <div>
                                                        <label class="module-question" for="1806"><span class="badge badge-soft-dark font-size-14 mr-2">+ 1 <i class="fad fa-cube text-success"></i></span> Access the Sysmon App for Splunk and go to the "Reports" tab. Fix the search associated with the "Net - net view" report and provide the complete executed command as your answer. Answer format: net view /Domain:_.local
                            </label>

                            <div class="row">
                                <div class="col-lg-12 mb-4">
                                                                        <input class="form-control bg-color-blue-nav" id="answer1806" type="text" color="green" placeholder="Submit your answer here..." maxlength="191">
                                                                    </div>
                                <div class="d-flex justify-content-end w-100 mr-3">
                                                                        <p id="questionStreakPointsText-1806" class="mb-0 mr-3 mt-1 font-size-14 font-medium text-white">
                                        +10 Streak pts</p>
                                                                        <div class="mb-4 mr-1 d-flex align-items-center">
                                        <button class="btn btn-primary btn-block btnAnswer" id="btnAnswer1806" data-question-id="1806">
                                            <div class="submit-button-text">
                                                <i class="fad fa-flag-checkered mr-2"></i> Submit
                                            </div>
                                            <div class="submit-button-loader mx-4 d-none">
                                                <i class="fa fa-circle-notch fa-spin"></i>
                                            </div>
                                        </button>
                                    </div>
                                    
                                                                        <div class="mb-4  mr-1">
                                        <button class="btn btn-outline-warning btn-block" data-toggle="modal" id="hintBtn1806" data-target="#hint1806"><i class="fad fa-life-ring mr-2"></i> Hint
                                        </button>
                                    </div>
                                    
                                                                        <div id="showSolutionBtn" class="mb-4 mr-1">
                                        <button class="btn btn-success d-flex align-items-center w-100 color-dark" onclick="openWalkthroughModal(&quot;0&quot;,&quot;Using Splunk Applications&quot;)">
                                            <i class="fa fa-book mr-2"></i> Show Solution
                                        </button>
                                    </div>
                                                                    </div>

                            </div>
                            <div class=" custom-hr ">
                            </div>
                        </div>
                                                <div>
                                                        <label class="module-question" for="1807"><span class="badge badge-soft-dark font-size-14 mr-2">+ 1 <i class="fad fa-cube text-success"></i></span> Access the Sysmon App for Splunk, go to the "Network Activity" tab, and choose "Network Connections". Fix the search and provide the number of connections that SharpHound.exe has initiated as your answer.
                            </label>

                            <div class="row">
                                <div class="col-lg-12 mb-4">
                                                                        <input class="form-control bg-color-blue-nav" id="answer1807" type="text" color="green" placeholder="Submit your answer here..." maxlength="191">
                                                                    </div>
                                <div class="d-flex justify-content-end w-100 mr-3">
                                                                        <p id="questionStreakPointsText-1807" class="mb-0 mr-3 mt-1 font-size-14 font-medium text-white">
                                        +10 Streak pts</p>
                                                                        <div class="mb-4 mr-1 d-flex align-items-center">
                                        <button class="btn btn-primary btn-block btnAnswer" id="btnAnswer1807" data-question-id="1807">
                                            <div class="submit-button-text">
                                                <i class="fad fa-flag-checkered mr-2"></i> Submit
                                            </div>
                                            <div class="submit-button-loader mx-4 d-none">
                                                <i class="fa fa-circle-notch fa-spin"></i>
                                            </div>
                                        </button>
                                    </div>
                                    
                                    
                                                                        <div id="showSolutionBtn" class="mb-4 mr-1">
                                        <button class="btn btn-success d-flex align-items-center w-100 color-dark" onclick="openWalkthroughModal(&quot;1&quot;,&quot;Using Splunk Applications&quot;)">
                                            <i class="fa fa-book mr-2"></i> Show Solution
                                        </button>
                                    </div>
                                                                    </div>

                            </div>
                            <div class="">
                            </div>
                        </div>
                                            </div>
                </div>
            </div>
                                </div>

        <div class="card bg-color-blue-nav" style="margin: 30px 0">
            <div class="card-body">
                                <a href="https://academy.hackthebox.com/module/218/section/2356" class="btn btn-light module-button py-2" style="float: left"><i class="fa fa-arrow-alt-left mr-1"></i> Previous</a>
                                                                <form action="https://academy.hackthebox.com/module" method="POST" class="form-inline" id="completeForm" style="float: right">
                    <input type="hidden" name="module_id" value="218">
                    <input type="hidden" name="page_id" value="3">
                    <input type="hidden" name="completed" value="1">
                                        <p id="completeBtnPoints" class="mb-0 mr-3 font-size-14 font-medium text-white d-none">
                        +10 Streak pts</p>
                                        <button id="completeBtn" class="btn btn-outline-success" style="display: none;">
                        <div id="complete-button-text">
                            <i class="fa fa-check-circle"></i> Mark Complete &amp; Next
                        </div>
                        <div id="complete-button-loader" class="mx-5 d-none">
                            <i class="fa fa-circle-notch fa-spin"></i>
                        </div>
                    </button>
                </form>
                
                <a href="https://academy.hackthebox.com/module/218/section/2357" class="btn btn-light ml-2 module-button py-2" style="float: left">Next <i class="ml-1 fa fa-arrow-alt-right"></i></a>
                            </div>
        </div>
    </div>
    <div class="col-md-12 col-xl-3 col-xxl-3">
        <div id="table-of-contents">

                        <div class="card">
                <div class="card-body bg-color-blue-nav">
                                                                                <a href="https://academy.hackthebox.com/module/218/section/2389#questionsDiv" class="btn btn-light btn-block module-button"><i class="fad fa-question mr-2"></i> Go to Questions</a>
                                    </div>
            </div>
                        <div class="card" id="TOC">
                <div class="card-body bg-color-blue-nav">
                    <h5 class="card-title font-size-15 mb-4">Table of Contents</h5>
                                         <h6 class="mt-4 mb-2">Splunk Fundamentals</h6>                     <a href="https://academy.hackthebox.com/module/218/section/2356" class="btn   btn-sm btn-block mt-1 py-2 text-left btn-lighter">
                                                <i class="fad fa-cube text-success mt-1 mr-2"></i>&nbsp;
                                                <span class="font-size-13">Introduction To Splunk &amp; SPL</span>
                                                                                                <i class="fad fa-check-square text-success float-right mt-1" style="top: 2px"></i>
                                                                    </a>
                                                            <a href="https://academy.hackthebox.com/module/218/section/2389" class="btn   text-primary  btn-sm btn-block mt-1 py-2 text-left btn-lighter">
                                                <i class="fad fa-cube text-success mt-1 mr-2"></i>&nbsp;
                                                <span class="font-size-13">Using Splunk Applications</span>
                                                                    </a>
                                         <h6 class="mt-4 mb-2">Investigating With Splunk</h6>                     <a href="https://academy.hackthebox.com/module/218/section/2357" class="btn   btn-sm btn-block mt-1 py-2 text-left btn-lighter">
                                                <i class="fad fa-cube text-success mt-1 mr-2"></i>&nbsp;
                                                <span class="font-size-13">Intrusion Detection With Splunk (Real-world Scenario)</span>
                                                                    </a>
                                                            <a href="https://academy.hackthebox.com/module/218/section/2388" class="btn   btn-sm btn-block mt-1 py-2 text-left btn-lighter">
                                                <i class="fad fa-cube text-success mt-1 mr-2"></i>&nbsp;
                                                <span class="font-size-13">Detecting Attacker Behavior With Splunk Based On TTPs</span>
                                                                    </a>
                                                            <a href="https://academy.hackthebox.com/module/218/section/2390" class="btn   btn-sm btn-block mt-1 py-2 text-left btn-lighter">
                                                <i class="fad fa-cube text-success mt-1 mr-2"></i>&nbsp;
                                                <span class="font-size-13">Detecting Attacker Behavior With Splunk Based On Analytics</span>
                                                                    </a>
                                         <h6 class="mt-4 mb-2">Skills Assessment</h6>                     <a href="https://academy.hackthebox.com/module/218/section/2358" class="btn   btn-sm btn-block mt-1 py-2 text-left btn-lighter">
                                                <i class="fad fa-cube text-success mt-1 mr-2"></i>&nbsp;
                                                <span class="font-size-13">Skills Assessment</span>
                                                                    </a>
                                    </div>
            </div>
            <div class="card">
                <div class="card-body bg-color-blue-nav">
                    <h5 class="card-title mb-4">My Workstation</h5>
                    <div class="row">
                        <div class="col-12">
                            <div id="sidePreview" style="height: 160px; border: 1px solid #323232; border-radius: 5px; background-color: #0a121c; text-align: center">
                                <div class="screenPlaceholder">
                                    <p class="instanceStart" style="padding-top:70px; letter-spacing: 5px;">
                                        OFFLINE</p>
                                    <p class="instanceLoading " style="padding-top:70px; display: none"><i class="fa fa-circle-notch fa-spin"></i> Starting...</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-12 mt-2">
                            <div class="instanceStart">
                                <button class="startInstanceBtn btn btn-success text-light btn-sm mt-2 btn-block module-button py-2  ">
                                    <i class="fad fa-play-circle text-light"></i> &nbsp;Start Instance
                                </button>
                                <p class="text-center mt-2 font-size-13 font-secondary">
                                    <span class="text-success spawnsLeft">
                                                                                <i class="fal fa-infinity"></i>
                                                                            </span> / 1 spawns left
                                </p>
                            </div>
                            <button style="display:none;" class="fullScreenBtn btn btn-light btn-sm mt-2 module-button py-2"><i class="fad fa-expand text-success"></i> &nbsp;Interact
                            </button>
                            <button style="display:none;" class="terminateInstanceBtn btn btn-light btn-sm mt-2 module-button py-2"><i class="fad fa-times text-danger"></i> &nbsp;Terminate
                            </button>
                            <button style="display:none;" class="resetInstanceBtn btn btn-light btn-sm mt-2 module-button py-2"><i class="fad fa-sync text-warning"></i> &nbsp;Reset
                            </button>
                            <div class="btn-group" role="group">
                                <button style="display:none; cursor: default;" class=" extendInstanceBtn btn btn-light btn-sm mt-2 module-button py-2">Life
                                    Left: <span class="lifeLeft"></span>m
                                </button>
                                                                <button style="display:none;" data-toggle="tooltip" data-title="Extend Life" class=" extendInstanceBtn extendInstanceBtnClicker btn btn-light btn-sm mt-2 module-button py-2" data-original-title="" title="">
                                    <i class="fa fa-plus text-success"></i></button>
                                                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>

<div id="hint1806" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="hint1806" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-body">
                <div class="text-center">
                    <h5><i class="fad fa-life-ring text-success"></i>&nbsp; Hint</h5>
                    <br>
                    <h6>Remove any extra white spaces</h6>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="hint1807" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="hint1807" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-body">
                <div class="text-center">
                    <h5><i class="fad fa-life-ring text-success"></i>&nbsp; Hint</h5>
                    <br>
                    <h6></h6>
                </div>
            </div>
        </div>
    </div>
</div>


<div id="cheatSheetModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="unlockModuleModal" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-body">
                <div class="text-center text-break">
                    <h5><i class="fad fa-file-alt"></i>&nbsp; Cheat Sheet</h5>
                    <p>The cheat sheet is a useful command reference for this module.</p>
                    
                </div>
            </div>
            <div class="modal-footer">
                <a class="btn btn-light btn-block" href="https://academy.hackthebox.com/module/cheatsheet/218">Download
                    Cheatsheet</a>
            </div>
        </div>
    </div>
</div>


<div id="linkDiscordModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="linkDiscordModal" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header text-center">
                            <h5 class="modal-title w-100">Do you need help with this question?</h5>
                        </div>
            <div class="modal-body">
                <div class="text-center">
                    <img src="./saved_page_files/discord-alternative.svg" alt="discord icon">
                    <p class="mb-1">It looks like you have not linked your Discord account!</p>
                    <p>You can receive question guidance via Discord. </p>
                    <a href="https://academy.hackthebox.com/account/discord/link" class="btn btn-outline-success btn-block">
                        Link your Discord account
                    </a>
                </div>
            </div>
        </div>
    </div>
</div><div id="referralModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="referralModal" aria-hidden="true" data-backdrop="static">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header text-center border-0">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true"><img src="./saved_page_files/close.svg" alt="close"></span>
                </button>
            </div>
            <div class="modal-body">
                <div class="text-center">
                    <img src="./saved_page_files/htb-coin.svg" alt="coin icon">
                    <h1 class="text-white">Refer &amp; Earn</h1>
                    <p class="text-secondary font-size-20">
                        Refer a Friend, Earn Cubes, Unlock Academy Modules!
                    </p>
                    <div class="d-flex flex-column">
                        <a href="https://academy.hackthebox.com/referral">
                            <button type="button" class="btn btn-success btn-invite-friend text-light my-4">
                                Invite Friends
                            </button>
                        </a>
                        <button type="button" id="disableReferralModalBtn" onclick="disableModalRedisplay()" class="btn mt-2 mb-3 d-none">
                            Don't show it again
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div><div id="pwnboxSwitchWarningModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="pwnboxSwitchWarningModal" aria-hidden="true" data-backdrop="static">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header text-center">
                <h2 class="d-inline-flex align-items-center text-white"><span class="font-size-18"><i class="far fa-exclamation-triangle text-danger mr-2"></i></span>Warning</h2>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true"><img src="./saved_page_files/close.svg" alt="close" height="16" width="16"></span>
                </button>
            </div>
            <div class="modal-body pt-0">
                <div class="text-left">
                    <h1 class="text-white"></h1>
                    <div class="text-secondary font-size-14 px-2">
                        <p>
                            The current instance of Pwnbox <span class="font-medium text-white">will be terminated</span>   when switching to a new region.
                        </p>
                        <p>
                            <span class="font-medium text-white">All progress you've made will be lost.</span>  Do you want to continue?
                        </p>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" id="cancelPwnboxSwitchBtn" class="btn cancel-btn px-5">
                    Cancel
                </button>
                <button type="button" id="continuePwnboxSwitchBtn" class="btn continue-btn px-5 text-light">
                    <span id="continuePwnboxSwitchBtnText">Continue</span>
                    <div class="pwnboxSwitchModalLoader spinner-border d-none" role="status">
                        <span class="sr-only">Switching VPN...</span>
                    </div>
                </button>
            </div>
        </div>
    </div>
</div><div id="vpnSwitchWarningModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="vpnSwitchWarningModal" aria-hidden="true" data-backdrop="static">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header text-center">
                <h2 class="d-inline-flex align-items-center text-white"><span class="font-size-18"><i class="far fa-exclamation-triangle text-danger mr-2"></i></span>Warning</h2>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true"><img src="./saved_page_files/close.svg" alt="close" height="16" width="16"></span>
                </button>
            </div>
            <div class="modal-body pt-0">
                <div class="text-left">
                    <h1 class="text-white"></h1>
                    <div class="text-secondary font-size-14 px-2">
                        <p>
                            All VM instances associated with the old VPN Server <span class="font-medium text-white">will be terminated</span> when switching to
                            a new VPN server. Existing PwnBox instances
                            <span class="font-medium text-white">will automatically switch</span>
                            to the new VPN server.
                        </p>
                        <p>
                            <span class="font-medium text-white">All progress you've made, will
                                be lost,</span> do you want to continue?
                        </p>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" id="cancelVpnSwitchBtn" class="btn cancel-btn px-5">
                    Cancel
                </button>
                <button type="button" id="continueVpnSwitchBtn" class="btn continue-btn px-5 text-light">
                    <span id="continueVpnSwitchBtnText">Continue</span>
                    <div class="vpnSwitchModalLoader spinner-border d-none" role="status">
                        <span class="sr-only">Switching VPN...</span>
                    </div>
                </button>
            </div>
        </div>
    </div>
</div><div id="solutionPreferencesModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="solutionPreferencesModal" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content pt-4 pl-4 pr-4 pb-3">
            <div class="modal-header text-center flex-column align-items-center p-0 font-size-18 font-bold">
                <img src="./saved_page_files/contact-support.svg" alt="contact support icon">
                <h5 class="modal-title w-100 text-white mt-2">Do you need help with this question?</h5>
            </div>
            <div class="modal-body p-0 mt-2 font-size-16">
                <div class="text-center">
                    <p class="mb-0">You have the option to enable step-by-step solutions for all questions.</p>
                    <p class="mb-0">You can manage this preference at any time through your profile settings.</p>
                </div>
            </div>
            <div class="modal-footer align-items-center justify-content-center p-0 mt-4 gap-12">
                <button class="btn btn-outline-secondary text-white font-medium" onclick="handleSolutionPreferencesModalAction(false)">
                    Don't show Solutions
                </button>
                <button class="btn btn-success text-light font-medium" onclick="handleSolutionPreferencesModalAction(true)">
                    Activate Solutions
                </button>
            </div>
        </div>
    </div>
</div>

    <div id="terminateVmModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="terminateVmModal" aria-hidden="true" data-backdrop="static">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header text-center">
                <h2 class="d-inline-flex align-items-center text-white"><span class="font-size-18"></span>Terminate Target VM</h2>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true"><img src="./saved_page_files/close.svg" alt="close" height="16" width="16"></span>
                </button>
            </div>
            <div class="modal-body pt-0">
                <div class="text-left">
                    <h1 class="text-white"></h1>
                    <div class="text-secondary font-size-14 px-2">
                        <p>
                            You will  <span class="font-medium text-white">not be able to access your target VM,</span>
                                you can spawn a new target if you need it. The Pwnbox will still be working.
                        </p>
                        <p>
                            Do you want to continue?
                        </p>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" id="cancelTerminateVmModal" class="btn cancel-btn px-5">
                    Cancel
                </button>
                <button type="button" id="continueTerminateVmModal" data-module-id="218" data-section-id="2389" class="btn continue-btn px-5 text-light">
                    <span class="continueTerminateVmText">Continue</span>
                    <div class="terminateVmLoader spinner-border d-none" role="status">
                        <span class="sr-only">Terminating VM...</span>
                    </div>
                </button>
            </div>
        </div>
    </div>
</div>
    
    
    
    <div id="overloadedVpnWarningModal" class="modal fade" role="dialog" tabindex="-1" aria-labelledby="vpnLoadedModal" aria-hidden="true" data-backdrop="static">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header text-center border-0">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true"><img src="./saved_page_files/close.svg" alt="close"></span>
                </button>
            </div>
            <div class="modal-body d-flex flex-column align-items-center p-4">
                <i class="fa-solid fa-triangle-exclamation font-size-48 text-warning mb-3"></i>
                <h5 class="modal-title font-size-18 font-bold color-white mb-2" id="vpnLoadedModalInfoLabel">VPN Server Overloaded</h5>
                <p class="mb-4 text-center font-size-16 font-weight-normal">The selected VPN is not optimal. We strongly suggest switching to a
                    <span class="recommended font-size-16 mr-0">
                        <img src="./saved_page_files/sparkles-solid.svg" alt="sparkles icon"> Recommended
                    </span>
                    VPN server from the dropdown menu for better performance.
                </p>
                <div class="d-flex align-items-center gap-12">
                    <button type="button" id="stayToVpnServerWarning" class="btn btn-outline-secondary">
                        Stay here
                    </button>
                    <a id="overloadedVpnServerWarningAction">
                        <button type="button" class="btn btn-danger">
                            Switch VPN anyway
                        </button>
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="streaks-container">
    </div>
<div id="walkthroughModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="walkthroughModal" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
            <div class="modal-header text-center">
                <h5 class="modal-title w-100">Walkthrough</h5>
            </div>
            <div class="modal-body">
                <div class="spinner-border text-success walkthrough-loader d-none d-block mx-auto" role="status">
                    <span class="sr-only">Loading...</span>
                </div>
                <div class="training-module d-none">
                    <h1>Understanding Log Sources &amp; Investigating with Splunk Module</h1>
<h2>Section Questions Writeup</h2>
<h4><strong>Tier</strong>: 2</h4>
<h4><strong>Difficulty</strong>: Medium</h4>
<h4><strong>Type</strong>: Defensive</h4>
<h4><strong>Created By</strong>: waldoirc</h4>
<h4><strong>Co-Authors</strong>: dbougioukas</h4>
<h2>Acronyms Used in Writeups</h2>
<div class="table-responsive"><table class="table table-striped text-left">
<thead>
<tr>
<th align="center">Acronym</th>
<th align="center">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">STMIP</td>
<td align="center">Spawned Target Machine IP Address</td>
</tr>
<tr>
<td align="center">STMPO</td>
<td align="center">Spawned Target Machine Port</td>
</tr>
<tr>
<td align="center">PMVPN</td>
<td align="center">Personal Machine with a Connection to the Academy's VPN</td>
</tr>
<tr>
<td align="center">PWNIP</td>
<td align="center">Pwnbox IP Address (or PMVPN IP Address)</td>
</tr>
<tr>
<td align="center">PWNPO</td>
<td align="center">Pwnbox Port (or PMVPN Port)</td>
</tr>
</tbody>
</table></div>
<h1>Introduction To Splunk &amp; SPL</h1>
<h2>Question 1</h2>
<h3>"Navigate to http://[Target IP]:8000, open the "Search &amp; Reporting" application, and find through an SPL search against all data the account name with the highest amount of Kerberos authentication ticket requests. Enter it as your answer."</h3>
<p>Students need to first navigate to http://STMIP:8000 and open the "Search &amp; Reporting" application:</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_1.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_1.png"></p>
<p>Next, students need to adjust the time period from <code>Last 24 hours</code> to <code>all time</code>:</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_2.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_2.png"></p>
<p>Then, students need to search for events in the "main" index where the EventCode is <code>4768</code>, while using the <code>stats</code> command to count the occurrences of each unique value in the Account_Name field:</p>
<pre><code>index="main" EventCode=4768 | stats count by Account_Name
</code></pre>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_3.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_3.png"></p>
<p>Students will find <code>waldo</code> has the highest number of TGT requests, with 12 total.</p>
<p>Answer: {hidden}</p>
<h1>Introduction To Splunk &amp; SPL</h1>
<h2>Question 2</h2>
<h3>"Navigate to http://[Target IP]:8000, open the "Search &amp; Reporting" application, and find through an SPL search against all 4624 events the count of distinct computers accessed by the account name SYSTEM. Enter it as your answer."</h3>
<p>Students need to first navigate to http://STMIP:8000 and open the "Search &amp; Reporting" application:</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_1.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_1.png"></p>
<p>Next, students need to adjust the time period from <code>Last 24 hours</code> to <code>all time</code>:</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_2.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_2.png"></p>
<p>Then, students need a query that searches for event code <code>4624</code> in the "main" index. Additionally, students need to use the <code>stats dc</code> command to calculate the distinct count of workstations (unique values of "ComputerName") and grouping by the values in the Account_Name field:</p>
<pre><code>index="main" EventCode=4624 | stats dc(ComputerName) as unique_workstations by Account_Name
</code></pre>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_4.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_4.png"></p>
<p>Students will see the SYSTEM user has accessed <code>10</code> unique workstations.</p>
<p>Answer: {hidden}</p>
<h1>Introduction To Splunk &amp; SPL</h1>
<h2>Question 3</h2>
<h3>"Navigate to http://[Target IP]:8000, open the "Search &amp; Reporting" application, and find through an SPL search against all 4624 events the account name that made the most login attempts within a span of 10 minutes. Enter it as your answer."</h3>
<p>Students need to first navigate to http://STMIP:8000 and open the "Search &amp; Reporting" application:</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_1.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_1.png"></p>
<p>Next, students need to adjust the time period from <code>Last 24 hours</code> to <code>all time</code>:</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_2.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_2.png"></p>
<p>Then, students need to search for events in the "main" index where the EventCode is <code>4624</code>. Additionally, students need to use the <code>stats</code> command to calculate the count of events as "login_attempts", and the range of time as "period" and grouping by the Account_Name field. Finally, the results must be filtered to only include those records where the time range is less than 600 seconds (10 minutes):</p>
<pre><code>index="main" EventCode=4624 | stats count as login_attempts, range(_time) as period by Account_Name | where period &lt; 600
</code></pre>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_5.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_5.png"></p>
<p>Students will find the <code>aparsa</code> user has the most login attempts.</p>
<p>Answer: {hidden}</p>
<h1>Using Splunk Applications</h1>
<h2>Question 1</h2>
<h3>"Access the Sysmon App for Splunk and go to the "Reports" tab. Fix the search associated with the "Net - net view" report and provide the complete executed command as your answer. Answer format: net view /Domain:_.local"</h3>
<p>Students need to navigate to https://splunkbase.splunk.com/app/3544 and download the Sysmon App for Splunk:</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_6.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_6.png"></p>
<p>Then, students need to then navigate to http://STMIP:8000 and select <code>manage apps</code>:</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_7.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_7.png"></p>
<p>Subsequently, students need to select <code>Install app from file</code> :</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_8.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_8.png"></p>
<p>And then browse for the newly downloaded <code>sysmom-app-for-splunk_200.gz</code> file:</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_9.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_9.png"></p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_10.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_10.png"></p>
<p>After clicking <code>upload</code>, students will be prompted to restart Splunk:</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_11.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_11.png"></p>
<p>Giving the software a few moments, once the restart is complete, students need to adjust the application's macro so that events are loaded:</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_12.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_12.png"></p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_13.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_13.png"></p>
<p>Students need to select <code>Sysmon App for Splunk</code> as the app, and <code>sysmon</code> as the macro:</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_14.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_14.png"></p>
<p>Consequently, students need to adjust the Definition and Save:</p>
<div class="window_container"><div class="window_content"><div class="window_top">Code: <span class="text-success">shell</span></div><pre class=" language-shell"><code class=" language-shell"><span class="token assign-left variable">index</span><span class="token operator">=</span><span class="token string">"main"</span> <span class="token assign-left variable">sourcetype</span><span class="token operator">=</span><span class="token string">"WinEventLog:Sysmon"</span>
</code></pre></div></div>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_15.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_15.png"></p>
<p>Now, students need to go to the Sysmon App for Splunk App:</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_16.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_16.png"></p>
<p>Students need to select the Reports tab, identifying the <code>Net - net view</code> report and choosing to Open in Search:</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_17.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_17.png"></p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_18.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_18.png"></p>
<p>After clicking Edit -&gt; open in Search, students will see the current query returns no events:</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_19.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_19.png"></p>
<p>Students need to first use a simple, modified version of the original query in order to generate an event, removing any fields that might be causing an error:</p>
<div class="window_container"><div class="window_content">
                      <div class="window_top">
                          <span class="window_dot bg-danger"></span>
                          <span class="window_dot bg-warning"></span>
                          <span class="window_dot bg-success"></span>
                          <span class="window_title">Using Splunk Applications</span>
                      </div>
                  <pre class=" language-shell-session" style="line-height: 0px;"><code class=" language-shell-session"><span class="token output">`sysmon` CommandLine="net  view"
</span></code></pre></div></div>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_20.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_20.png"></p>
<p>Subsequently, students need to inspect the field names, identifying that the error is due incorrect fields being referenced in the initial query:</p>
<p><code>process</code> should be changed to <code>Image</code></p>
<p><code>Computer</code> should be changed to  <code>ComputerName</code></p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_21.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_21.png"></p>
<p>Therefore, students need to correct the command accordingly:</p>
<div class="window_container"><div class="window_content">
                      <div class="window_top">
                          <span class="window_dot bg-danger"></span>
                          <span class="window_dot bg-warning"></span>
                          <span class="window_dot bg-success"></span>
                          <span class="window_title">Using Splunk Applications</span>
                      </div>
                  <pre class=" language-shell-session" style="line-height: 0px;"><code class=" language-shell-session"><span class="token output">`sysmon` Image="*net.exe" (CommandLine="net  view*") | stats count by ComputerName,CommandLine
</span></code></pre></div></div>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_22.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_22.png"></p>
<p>Adjusting for white spaces, the complete executed command is shown to be <code>net view /Domain:uniwaldo.local</code>.</p>
<p>Answer: {hidden}</p>
<h1>Using Splunk Applications</h1>
<h2>Question 2</h2>
<h3>"Access the Sysmon App for Splunk, go to the "Network Activity" tab, and choose "Network Connections". Fix the search and provide the number of connections that SharpHound.exe has initiated as your answer."</h3>
<p>Students need to navigate to https://splunkbase.splunk.com/app/3544 and download the Sysmon App for Splunk:</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_6.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_6.png"></p>
<p>Then, students need to then navigate to http://STMIP:8000 and select <code>manage apps</code>:</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_7.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_7.png"></p>
<p>Subsequently, students need to select <code>Install app from file</code> :</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_8.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_8.png"></p>
<p>And then browse for the newly downloaded <code>sysmom-app-for-splunk_200.gz</code> file:</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_9.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_9.png"></p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_10.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_10.png"></p>
<p>After clicking <code>upload</code>, students will be prompted to restart Splunk:</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_11.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_11.png"></p>
<p>Giving the software a few moments, once the restart is complete, students need to adjust the application's macro so that events are loaded:</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_23.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_23.png"></p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_13.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_13.png"></p>
<p>Students need to select <code>Sysmon App for Splunk</code> as the app, and <code>sysmon</code> as the macro:</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_14.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_14.png"></p>
<p>Consequently, students need to adjust the Definition and Save:</p>
<div class="window_container"><div class="window_content">
                      <div class="window_top">
                          <span class="window_dot bg-danger"></span>
                          <span class="window_dot bg-warning"></span>
                          <span class="window_dot bg-success"></span>
                          <span class="window_title">Using Splunk Applications</span>
                      </div>
                  <pre class=" language-shell-session" style="line-height: 0px;"><code class=" language-shell-session"><span class="token output">index="main" sourcetype="WinEventLog:Sysmon"
</span></code></pre></div></div>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_15.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_15.png"></p>
<p>Now, students need to navigate to the Sysmon App for Splunk App:</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_16.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_16.png"></p>
<p>After accessing the app, students need to go to the "Network Activity" tab, and choose "Network Connections":</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_24.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_24.png"></p>
<p>Then, students need to Open in Search:</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_25.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_25.png"></p>
<p>Adjusting the time range to <code>All time</code>, students will see there are still no results:</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_26.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_26.png"></p>
<p>Students need to use a simpler query to generate some events, then identify what fields exist in a typical event (Event ID 3):</p>
<div class="window_container"><div class="window_content">
                      <div class="window_top">
                          <span class="window_dot bg-danger"></span>
                          <span class="window_dot bg-warning"></span>
                          <span class="window_dot bg-success"></span>
                          <span class="window_title">Using Splunk Applications</span>
                      </div>
                  <pre class=" language-shell-session" style="line-height: 0px;"><code class=" language-shell-session"><span class="token output">`sysmon` EventCode=3 Image="*"
</span></code></pre></div></div>
<p>Exploring the events, students will see the errors are due to:</p>
<p><code>dest_port</code> should be <code>DestinationPort</code></p>
<p><code>dest_ip</code> should be <code>DestinationIP</code></p>
<p><code>dest_host</code> should be <code>DestinationHostname</code></p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_27.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_27.png"></p>
<p>Therefore, the adjusted command becomes:</p>
<div class="window_container"><div class="window_content">
                      <div class="window_top">
                          <span class="window_dot bg-danger"></span>
                          <span class="window_dot bg-warning"></span>
                          <span class="window_dot bg-success"></span>
                          <span class="window_title">Using Splunk Applications</span>
                      </div>
                  <pre class=" language-shell-session" style="line-height: 0px;"><code class=" language-shell-session"><span class="token output">`sysmon` EventCode=3 Image="*" Protocol="*" DestinationPort="*" "*" | eval Destination=coalesce(DestinationHostname,DestinationIp) | stats count, values(Destination) AS "Destinations", values(DestinationPort) AS "Ports", values(Protocol) AS "Protocols" by Image | fields Image Destinations Ports Protocols count
</span></code></pre></div></div>
<p>After populating the results, students need to browse page <code>2</code> of the results:</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_28.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_28.png"></p>
<p>The query shows there have been <code>6</code> connections associated with Sharphound.exe.</p>
<p>Answer: {hidden}</p>
<h1>Intrusion Detection With Splunk (Real-world Scenario)</h1>
<h2>Question 1</h2>
<h3>"Navigate to http://[Target IP]:8000, open the "Search &amp; Reporting" application, and find through an SPL search against all data the other process that dumped lsass. Enter its name as your answer. Answer format: _.exe"</h3>
<p>Students need to first navigate to http://STMIP:8000 and open the "Search &amp; Reporting" application:</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_1.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_1.png"></p>
<p>Next, students need to adjust the time period from <code>Last 24 hours</code> to <code>all time</code>:</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_2.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_2.png"></p>
<p>Now, students need to enter a nSPL query to search Sysmon events in the "main" index with <code>EventCode 10</code> (ProcessAccess), where the TargetImage is <code>lsass.exe</code> and the CallTrace information contains <code>*UNKNOWN*</code> (which is indicative of shellcode execution):</p>
<div class="window_container"><div class="window_content">
                      <div class="window_top">
                          <span class="window_dot bg-danger"></span>
                          <span class="window_dot bg-warning"></span>
                          <span class="window_dot bg-success"></span>
                          <span class="window_title">Intrusion Detection With Splunk (Real-world Scenario)</span>
                      </div>
                  <pre class=" language-shell-session" style="line-height: 0px;"><code class=" language-shell-session"><span class="token output">index="main" sourcetype="WinEventLog:Sysmon" EventCode=10 TargetImage="C:\\Windows\\system32\\lsass.exe" CallTrace="*UNKNOWN*" | stats count by SourceImage, CallTrace
</span></code></pre></div></div>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_29.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_29.png"></p>
<p>Students will see that <code>rundll32.exe</code> is the other process that dumped lsass.</p>
<p>Answer: {hidden}</p>
<h1>Intrusion Detection With Splunk (Real-world Scenario)</h1>
<h2>Question 2</h2>
<h3>"Navigate to http://[Target IP]:8000, open the "Search &amp; Reporting" application, and find through SPL searches against all data the method through which the other process dumped lsass. Enter the misused DLL's name as your answer. Answer format: _.dll"</h3>
<p>Students need to first navigate to http://STMIP:8000 and open the "Search &amp; Reporting" application:</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_1.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_1.png"></p>
<p>Next, students need to adjust the time period from <code>Last 24 hours</code> to <code>all time</code>:</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_2.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_2.png"></p>
<p>From the previous exercises, students should know that <code>rundll32.exe</code> was identified as the process that dumped lsass. Therefore, students need run a query searching for <code>EventCode 10</code> (ProcessAccess), specifically looking for events where the TargetImage is lsass.exe, the SourceImage contains "rundll32," and the CallTrace information is not UNKNOWN. This is to allow for individual analysis of affected .dll files during the event:</p>
<div class="window_container"><div class="window_content">
                      <div class="window_top">
                          <span class="window_dot bg-danger"></span>
                          <span class="window_dot bg-warning"></span>
                          <span class="window_dot bg-success"></span>
                          <span class="window_title">Intrusion Detection With Splunk (Real-world Scenario)</span>
                      </div>
                  <pre class=" language-shell-session" style="line-height: 0px;"><code class=" language-shell-session"><span class="token output">index="main" sourcetype="WinEventLog:Sysmon" EventCode=10 TargetImage="C:\\Windows\\system32\\lsass.exe" SourceImage="*rundll32*" CallTrace!="*UNKNOWN*"
</span></code></pre></div></div>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_30.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_30.png"></p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_31.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_31.png"></p>
<p>Students will have to  understand what the different shown dynamic link libraries (DLL) are used for. After conducting external <a href="https://www.ired.team/offensive-security/credential-access-and-credential-dumping/dump-credentials-from-lsass-process-without-mimikatz" target="_blank" rel="noopener nofollow">research</a>, students will identify that <code>comsvcs.dll</code> is the misused dynamic link library.</p>
<p>Answer: {hidden}</p>
<h1>Intrusion Detection With Splunk (Real-world Scenario)</h1>
<h2>Question 3</h2>
<h3>"Navigate to http://[Target IP]:8000, open the "Search &amp; Reporting" application, and find through an SPL search against all data any suspicious loads of clr.dll that could indicate a C# injection/execute-assembly attack. Then, again through SPL searches, find if any of the suspicious processes that were returned in the first place was used to temporarily execute code. Enter its name as your answer. Answer format: _.exe"</h3>
<p>Students need to first navigate to http://STMIP:8000 and open the "Search &amp; Reporting" application:</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_1.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_1.png"></p>
<p>Next, students need to adjust the time period from <code>Last 24 hours</code> to <code>all time</code>:</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_2.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_2.png"></p>
<p>Now, students need to use a query that searches for events with <code>EventCode 7</code> containing term "clr.dll", then calculates the count of occurrences based on the "Image" field:</p>
<div class="window_container"><div class="window_content">
                      <div class="window_top">
                          <span class="window_dot bg-danger"></span>
                          <span class="window_dot bg-warning"></span>
                          <span class="window_dot bg-success"></span>
                          <span class="window_title">Intrusion Detection With Splunk (Real-world Scenario)</span>
                      </div>
                  <pre class=" language-shell-session" style="line-height: 0px;"><code class=" language-shell-session"><span class="token output">index="main" sourcetype="WinEventLog:Sysmon" EventCode=7 clr.dll | stats count by Image
</span></code></pre></div></div>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_32.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_32.png"></p>
<p>From here, students need to analyze events with <code>EventCode 1</code> (corresponding to a ProcessCreate event), sorting by count to find the images with the least amount of <code>clr.dll</code> loads (as processes with a large number of clr.dll loads would likely be considered normal behavior.)</p>
<div class="window_container"><div class="window_content">
                      <div class="window_top">
                          <span class="window_dot bg-danger"></span>
                          <span class="window_dot bg-warning"></span>
                          <span class="window_dot bg-success"></span>
                          <span class="window_title">Intrusion Detection With Splunk (Real-world Scenario)</span>
                      </div>
                  <pre class=" language-shell-session" style="line-height: 0px;"><code class=" language-shell-session"><span class="token output">index="main" sourcetype="WinEventLog:Sysmon" EventCode=1 Image="*rundll32.exe*" | stats count by ParentImage
</span></code></pre></div></div>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_33.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_33.png"></p>
<p>Students will find several "unusual" processes such <code>SharpHound.exe</code>, <code>randomfile.exe</code>, <code>rundll32.exe</code>, and <code>notepad.exe</code>. Subsequently, students need to identify the parents of the abovementioned processes one by one:</p>
<div class="window_container"><div class="window_content">
                      <div class="window_top">
                          <span class="window_dot bg-danger"></span>
                          <span class="window_dot bg-warning"></span>
                          <span class="window_dot bg-success"></span>
                          <span class="window_title">Intrusion Detection With Splunk (Real-world Scenario)</span>
                      </div>
                  <pre class=" language-shell-session" style="line-height: 0px;"><code class=" language-shell-session"><span class="token output">index="main" sourcetype="WinEventLog:Sysmon" EventCode=1 Image="*rundll32.exe*" | stats count by ParentImage
</span></code></pre></div></div>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_34.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_34.png"></p>
<p>Students should notice that among the parents of<code> rundll32.exe</code> are <code>randomfile.exe</code> and <code>PSEXECSCVCS.exe</code> (which most probably tries to blend in by misspelling the legitimate psexesvc.exe). This is a strong indication that <code>rundll32.exe</code> was used as a sacrificial process.</p>
<p>Answer: {hidden}</p>
<h1>Intrusion Detection With Splunk (Real-world Scenario)</h1>
<h2>Question 4</h2>
<h3>"Navigate to http://[Target IP]:8000, open the "Search &amp; Reporting" application, and find through SPL searches against all data the two IP addresses of the C2 callback server. Answer format: 10.0.0.1XX and 10.0.0.XX"</h3>
<p>Students need to first navigate to http://STMIP:8000 and open the "Search &amp; Reporting" application:</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_1.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_1.png"></p>
<p>Next, students need to adjust the time period from <code>Last 24 hours</code> to <code>all time</code>:</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_2.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_2.png"></p>
<p>Now, students need to use a query that searches for events with an <code>EventCode of 3</code> (corresponding to network connections) and the file name "randomfile.exe" (which was previously identified being potentially malicious). Additionally, students need to calculates the count of occurrences for each unique Destination IP address associated with the events:</p>
<div class="window_container"><div class="window_content">
                      <div class="window_top">
                          <span class="window_dot bg-danger"></span>
                          <span class="window_dot bg-warning"></span>
                          <span class="window_dot bg-success"></span>
                          <span class="window_title">Intrusion Detection With Splunk (Real-world Scenario)</span>
                      </div>
                  <pre class=" language-shell-session" style="line-height: 0px;"><code class=" language-shell-session"><span class="token output">index="main" sourcetype="WinEventLog:Sysmon" EventCode=3 randomfile.exe | stats count by DestinationIp &lt;-- We focus on randomfile.exe and rundll32.exe 
</span></code></pre></div></div>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_35.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_35.png"></p>
<p>The logs show that that a network connection was established with <code>10.0.0.91</code>. Students need to repeat this query, testing it against the other potentially malicious files:</p>
<div class="window_container"><div class="window_content">
                      <div class="window_top">
                          <span class="window_dot bg-danger"></span>
                          <span class="window_dot bg-warning"></span>
                          <span class="window_dot bg-success"></span>
                          <span class="window_title">Intrusion Detection With Splunk (Real-world Scenario)</span>
                      </div>
                  <pre class=" language-shell-session" style="line-height: 0px;"><code class=" language-shell-session"><span class="token output">index="main" sourcetype="WinEventLog:Sysmon" EventCode=3 rundll32.exe | stats count by DestinationIp
</span></code></pre></div></div>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_36.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_36.png"></p>
<p>After inspecting the network connections associated with <code>rundll32.exe</code>, students will find both IP addresses of the C2 : <code>10.0.0.186 and 10.0.0.91</code>.</p>
<p>Answer: {hidden}</p>
<h1>Intrusion Detection With Splunk (Real-world Scenario)</h1>
<h2>Question 5</h2>
<h3>"Navigate to http://[Target IP]:8000, open the "Search &amp; Reporting" application, and find through SPL searches against all data the port that one of the two C2 callback server IPs used to connect to one of the compromised machines. Enter it as your answer."</h3>
<p>Students need to first navigate to http://STMIP:8000 and open the "Search &amp; Reporting" application:</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_1.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_1.png"></p>
<p>Next, students need to adjust the time period from <code>Last 24 hours</code> to <code>all time</code>:</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_2.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_2.png"></p>
<p>Now, students need to use an SPL query that searches for events with of <code>EventCode 3</code>, and the specific Source IP address of 10.0.0.186 (previously identified as a C2 endpoint). Additionally, students need to calculate the count of occurrences for each unique combination of Destination IP address and Destination Port associated with those events.</p>
<div class="window_container"><div class="window_content">
                      <div class="window_top">
                          <span class="window_dot bg-danger"></span>
                          <span class="window_dot bg-warning"></span>
                          <span class="window_dot bg-success"></span>
                          <span class="window_title">Intrusion Detection With Splunk (Real-world Scenario)</span>
                      </div>
                  <pre class=" language-shell-session" style="line-height: 0px;"><code class=" language-shell-session"><span class="token output">index="main" sourcetype="WinEventLog:Sysmon" EventCode=3 SourceIp=10.0.0.186 | stats count by DestinationIp, DestinationPort
</span></code></pre></div></div>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_37.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_37.png"></p>
<p>Students will find that the C2 server was interacting with the compromised host, 10.0.0.47, on port <code>3389</code>.</p>
<p>Answer: {hidden}</p>
<h1># Detecting Attacker Behavior With Splunk Based On TTPs</h1>
<h2>Question 1</h2>
<h3>"Navigate to http://[Target IP]:8000, open the "Search &amp; Reporting" application, and find through SPL searches against all data the password utilized during the PsExec activity. Enter it as your answer."</h3>
<p>Students need to first navigate to http://STMIP:8000 and open the "Search &amp; Reporting" application:</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_1.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_1.png"></p>
<p>Next, students need to adjust the time period from <code>Last 24 hours</code> to <code>all time</code>:</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_2.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_2.png"></p>
<p>Then, students need to resume the investigation, using a query to search events while excluding any native API calls being done on the system. Additionally Students will have to exclude any native processes such as <code>Microsoft.NET</code> and <code>Explorer.exe</code> . Subsequently, students need to recognize that SourceImage is the parent process and the TargetImage is the child process:</p>
<div class="window_container"><div class="window_content">
                      <div class="window_top">
                          <span class="window_dot bg-danger"></span>
                          <span class="window_dot bg-warning"></span>
                          <span class="window_dot bg-success"></span>
                          <span class="window_title"># Detecting Attacker Behavior With Splunk Based On TTPs</span>
                      </div>
                  <pre class=" language-shell-session" style="line-height: 0px;"><code class=" language-shell-session"><span class="token output">index="main" CallTrace="*UNKNOWN*" SourceImage!="*Microsoft.NET*" CallTrace!=*ni.dll* CallTrace!=*clr.dll* CallTrace!=*wow64* SourceImage!="C:\\Windows\\Explorer.EXE" | where SourceImage!=TargetImage | stats count by SourceImage
</span></code></pre></div></div>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_38.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_38.png"></p>
<p>The <code>PSEXECSVCS.exe</code> stands out as unusual. Students need to use a query to search events in the "main" index with the sourcetype "WinEventLog:Sysmon", while filtering for events containing "psexecscvcs.exe" and then calculating the count of events by their EventCode:</p>
<div class="window_container"><div class="window_content">
                      <div class="window_top">
                          <span class="window_dot bg-danger"></span>
                          <span class="window_dot bg-warning"></span>
                          <span class="window_dot bg-success"></span>
                          <span class="window_title"># Detecting Attacker Behavior With Splunk Based On TTPs</span>
                      </div>
                  <pre class=" language-shell-session" style="line-height: 0px;"><code class=" language-shell-session"><span class="token output">index="main" sourcetype="WinEventLog:Sysmon" psexecscvcs.exe | stats count by EventCode
</span></code></pre></div></div>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_39.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_39.png"></p>
<p>Students will have to recall the meaning behind the event codes. Of particular interest is  <code>EventCode 11</code> (which corresponds
to FileCreate), allowing students to trace files back to the server that dropped it. Therefore, students need to use an additional query to provide a summary of the number of FileCreate events associated with the "psexecscvcs.exe" process, along with the corresponding file details and the host where these events were recorded:</p>
<div class="window_container"><div class="window_content">
                      <div class="window_top">
                          <span class="window_dot bg-danger"></span>
                          <span class="window_dot bg-warning"></span>
                          <span class="window_dot bg-success"></span>
                          <span class="window_title"># Detecting Attacker Behavior With Splunk Based On TTPs</span>
                      </div>
                  <pre class=" language-shell-session" style="line-height: 0px;"><code class=" language-shell-session"><span class="token output">index="main" sourcetype="WinEventLog:Sysmon" psexecscvcs.exe EventCode=11 | stats count by Image, TargetFilename, host
</span></code></pre></div></div>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_40.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_40.png"></p>
<p>Students will note the host where the binary was dropped - <code>DESKTOP-UN7T4R8</code>. Therefore, students need to identify and count the number of different event codes tied to it. Students need to focus on <code>EventCode 1</code> (corresponding to process creation), and utilize a query for CommandLine arguments containing "<em>psexec</em>" :</p>
<div class="window_container"><div class="window_content">
                      <div class="window_top">
                          <span class="window_dot bg-danger"></span>
                          <span class="window_dot bg-warning"></span>
                          <span class="window_dot bg-success"></span>
                          <span class="window_title"># Detecting Attacker Behavior With Splunk Based On TTPs</span>
                      </div>
                  <pre class=" language-shell-session" style="line-height: 0px;"><code class=" language-shell-session"><span class="token output">index="main" sourcetype="WinEventLog:Sysmon" DESKTOP-UN7T4R8 CommandLine="*psexec*" EventCode=1 | stats count by CommandLine
</span></code></pre></div></div>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_41.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_41.png"></p>
<p>Students will see the password <code>Password@123</code> was used during the execution of the <code>psexec64.exe</code> binary. Subsequently, to understand from where binary was ran, students need to append the host field to the query:</p>
<div class="window_container"><div class="window_content">
                      <div class="window_top">
                          <span class="window_dot bg-danger"></span>
                          <span class="window_dot bg-warning"></span>
                          <span class="window_dot bg-success"></span>
                          <span class="window_title"># Detecting Attacker Behavior With Splunk Based On TTPs</span>
                      </div>
                  <pre class=" language-shell-session" style="line-height: 0px;"><code class=" language-shell-session"><span class="token output">index="main" sourcetype="WinEventLog:Sysmon" DESKTOP-UN7T4R8 CommandLine="*psexec*" EventCode=1 | stats count by CommandLine, host
</span></code></pre></div></div>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_42.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_42.png"></p>
<p>Students will find that the host from which the command was ran is DESKTOP-EGSS5IS .</p>
<p>Answer: {hidden}</p>
<h1>Detecting Attacker Behavior With Splunk Based On Analytics</h1>
<h2>Question 1</h2>
<h3>"Navigate to http://[Target IP]:8000, open the "Search &amp; Reporting" application, and find through an analytics-driven SPL search against all data the source process images that are creating an unusually high number of threads in other processes. Enter the outlier process name as your answer where the number of injected threads is greater than two standard deviations above the average. Answer format: _.exe"</h3>
<p>Students need to first navigate to http://STMIP:8000 and open the "Search &amp; Reporting" application:</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_1.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_1.png"></p>
<p>Next, students need to adjust the time period from <code>Last 24 hours</code> to <code>all time</code>:</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_2.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_2.png"></p>
<p>Students need to use an SPL query for Sysmon <code>EventCode 8</code> (CreateRemoteThread) that calculates the number of threads (renamed to numThreads) for each SourceImage, then calculates the average and standard deviation of numThreads. Additionally, it needs to identify outliers by comparing the numThreads value to the average, plus two times the standard deviation. Finally, the results need to be filtered to only show events where numThreads is considered an outlier (isOutlier=1):</p>
<div class="window_container"><div class="window_content">
                      <div class="window_top">
                          <span class="window_dot bg-danger"></span>
                          <span class="window_dot bg-warning"></span>
                          <span class="window_dot bg-success"></span>
                          <span class="window_title">Detecting Attacker Behavior With Splunk Based On Analytics</span>
                      </div>
                  <pre class=" language-shell-session" style="line-height: 0px;"><code class=" language-shell-session"><span class="token output">index="main" sourcetype="WinEventLog:Sysmon" EventCode=8 | stats count as numThreads by SourceImage | eventstats avg(numThreads) as avg stdev(numThreads) as stdev | eval isOutlier = if(numThreads &gt; avg + (2*stdev), 1, 0) | where isOutlier=1
</span></code></pre></div></div>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_43.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_43.png"></p>
<p>The query reveals that <code>randomfile.exe</code> is the outlier process.</p>
<p>Answer: {hidden}</p>
<h1>Skills Assessment</h1>
<h1>Question 1</h1>
<h3>"Navigate to http://[Target IP]:8000, open the "Search &amp; Reporting" application, and find through SPL searches against all data the process that created remote threads in rundll32.exe. Answer format: _.exe"</h3>
<p>Students need to first navigate to http://STMIP:8000 and open the "Search &amp; Reporting" application:</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_1.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_1.png"></p>
<p>Next, students need to adjust the time period from <code>Last 24 hours</code> to <code>all time</code>:</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_2.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_2.png"></p>
<p>Now, students need to use a query, targeting Sysmon logs with <code>EventCode 8</code> (CreateRemoteThread), while calculating the count of the events and grouping them by the "SourceImage" and "TargetImage" fields:</p>
<div class="window_container"><div class="window_content">
                      <div class="window_top">
                          <span class="window_dot bg-danger"></span>
                          <span class="window_dot bg-warning"></span>
                          <span class="window_dot bg-success"></span>
                          <span class="window_title">Question 1</span>
                      </div>
                  <pre class=" language-shell-session" style="line-height: 0px;"><code class=" language-shell-session"><span class="token output">index="main" sourcetype="WinEventLog:Sysmon" EventCode=8 | stats count by SourceImage TargetImage
</span></code></pre></div></div>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_44.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_44.png"></p>
<p>Students will find find that <code>randomfile.exe</code> created remote threads in rundll32.exe.</p>
<p>Answer: {hidden}</p>
<h1>Skills Assessment</h1>
<h2>Question 2</h2>
<h3>"Navigate to http://[Target IP]:8000, open the "Search &amp; Reporting" application, and find through SPL searches against all data the process that started the infection. Answer format: _.exe"</h3>
<p>Students need to first navigate to http://STMIP:8000 and open the "Search &amp; Reporting" application:</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_1.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_1.png"></p>
<p>Next, students need to adjust the time period from <code>Last 24 hours</code> to <code>all time</code>:</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_2.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_2.png"></p>
<p>To start the analysis, students need to identify all events that make use of either of the two C2 endpoints, <code>10.0.0.91 and 19.0.0.186</code>. Additionally, students need to reverse the order of the search results, so that the first result is the oldest:</p>
<div class="window_container"><div class="window_content">
                      <div class="window_top">
                          <span class="window_dot bg-danger"></span>
                          <span class="window_dot bg-warning"></span>
                          <span class="window_dot bg-success"></span>
                          <span class="window_title">Skills Assessment</span>
                      </div>
                  <pre class=" language-shell-session" style="line-height: 0px;"><code class=" language-shell-session"><span class="token output">index="main" sourcetype="WinEventLog:Sysmon" (DestinationIp=10.0.0.91 OR DestinationIp=10.0.0.186) | reverse
</span></code></pre></div></div>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_45.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_45.png"></p>
<p>Analyzing the first event, students will find reference to <code>demon.exe</code>. Consequently, students need to run an additional query look at all available event codes associated with this suspicious file:</p>
<div class="window_container"><div class="window_content">
                      <div class="window_top">
                          <span class="window_dot bg-danger"></span>
                          <span class="window_dot bg-warning"></span>
                          <span class="window_dot bg-success"></span>
                          <span class="window_title">Skills Assessment</span>
                      </div>
                  <pre class=" language-shell-session" style="line-height: 0px;"><code class=" language-shell-session"><span class="token output">index="main" sourcetype="WinEventLog:Sysmon" "demon.exe" | stats count by EventCode
</span></code></pre></div></div>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_46.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_46.png"></p>
<p>Students will see there are numerous events types. Moving forward, there are two approaches students can take.</p>
<h3>Approach #1 : EventCode 11 (FileCreate)</h3>
<p>For the first approach. students need to focus on <code>EventCode 11</code>, using another query to find all of the events that contain "demon.exe". Additionally, the query needs to be sorted so the first result is the oldest:</p>
<div class="window_container"><div class="window_content">
                      <div class="window_top">
                          <span class="window_dot bg-danger"></span>
                          <span class="window_dot bg-warning"></span>
                          <span class="window_dot bg-success"></span>
                          <span class="window_title">Skills Assessment</span>
                      </div>
                  <pre class=" language-shell-session" style="line-height: 0px;"><code class=" language-shell-session"><span class="token output">index="main" sourcetype="WinEventLog:Sysmon" "demon.exe" EventCode=11 | table Image, TargetFilename, _time | sort + _time
</span></code></pre></div></div>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_47.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_47.png"></p>
<p>These events only show that <code>demon.exe</code> was downloaded around <code>2022-10-015 13:39:40</code>, and did not directly create any other files. However, students need to consider that other files that may have been downloaded around this same time period.</p>
<p>Subsequently, students need to perform another search, filtering for SmartScreen (a software related to Microsoft Edge that is ran during file downloads):</p>
<div class="window_container"><div class="window_content">
                      <div class="window_top">
                          <span class="window_dot bg-danger"></span>
                          <span class="window_dot bg-warning"></span>
                          <span class="window_dot bg-success"></span>
                          <span class="window_title">Skills Assessment</span>
                      </div>
                  <pre class=" language-shell-session" style="line-height: 0px;"><code class=" language-shell-session"><span class="token output">index="main" sourcetype="WinEventLog:Sysmon" EventCode=11 "*SmartScreen"| table Image, TargetFilename, _time | sort + _time
</span></code></pre></div></div>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_48.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_48.png"></p>
<p>Looking through the events, students will see multiple file downloads took place, between <code>2022-10-05 13:32:35</code> and <code>2022-10-05 13:38:21</code>. Thus, students need to search events again (still using EventCode11), and manually inspect the events within the aforementioned time frame. Of particular interest is the download that occurred at <code>2022-10-05 13:33:13</code>:</p>
<pre><code>index="main" sourcetype="WinEventLog:Sysmon" EventCode=11 earliest="10/05/2022:13:32:35" latest="10/05/2022:13:38:21" | table Image, TargetFilename, _time | sort + _time
</code></pre>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_49.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_49.png"></p>
<p>By narrowing down this "needle in a haystack" approach, students will ultimately discover the downloaded file <code>demon.dll</code> (as denoted by the Zone.Identifier). As another potential indicator of compromise, students need to perform a search against all Sysmon logs looking for occurrences of <code>demon.dll</code>:</p>
<div class="window_container"><div class="window_content">
                      <div class="window_top">
                          <span class="window_dot bg-danger"></span>
                          <span class="window_dot bg-warning"></span>
                          <span class="window_dot bg-success"></span>
                          <span class="window_title">Skills Assessment</span>
                      </div>
                  <pre class=" language-shell-session" style="line-height: 0px;"><code class=" language-shell-session"><span class="token output">index="main" sourcetype="WinEventLog:Sysmon" "*demon.dll*"
</span></code></pre></div></div>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_50.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_50.png"></p>
<p>Immediately, students will find evidence of EventCode 1 (ProcessCreation), with <code>rundll32.exe</code> being used against the <code>demon.dll</code>.</p>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_51.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_51.png"></p>
<p>Ultimately, students can determine that <code>rundll32.exe</code> is the process that started the initial infection, by way of injecting the <code>demon.dll</code> .</p>
<p>Answer: {hidden}</p>
<h3>Approach #2 : EventCode 1 (ProcessCreate)</h3>
<p>Using the second approach, students need begin by targeting <code>EventCode 1</code>, using a query to create a table with the Image, CommandLine, ParentImage, ParentCommandLine, and <em>time</em> fields. Additionally, it should be sorted in ascending order by _time:</p>
<div class="window_container"><div class="window_content">
                      <div class="window_top">
                          <span class="window_dot bg-danger"></span>
                          <span class="window_dot bg-warning"></span>
                          <span class="window_dot bg-success"></span>
                          <span class="window_title">Skills Assessment</span>
                      </div>
                  <pre class=" language-shell-session" style="line-height: 0px;"><code class=" language-shell-session"><span class="token output">index="main" sourcetype="WinEventLog:Sysmon" EventCode=1 | table Image, CommandLine, ParentImage, ParentCommandLine, _time | sort + _time
</span></code></pre></div></div>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_52.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_52.png"></p>
<p>While this produces a useful visualization of process creation events, it is still a large number of events to go through, and might prove difficult to find the first suspicious file. Therefore, students need to adjust the query , looking for any events containing "<em>demon</em>" and not "<em>demon.exe</em>". This is to look for potential stagers (DLL, VBS, HTA, etc.) called demon* that may have been associated with the previously discovered demon.exe:</p>
<div class="window_container"><div class="window_content">
                      <div class="window_top">
                          <span class="window_dot bg-danger"></span>
                          <span class="window_dot bg-warning"></span>
                          <span class="window_dot bg-success"></span>
                          <span class="window_title">Skills Assessment</span>
                      </div>
                  <pre class=" language-shell-session" style="line-height: 0px;"><code class=" language-shell-session"><span class="token output">index="main" sourcetype="WinEventLog:Sysmon" ("*demon*" NOT "*demon.exe*") EventCode=1 | table Image, CommandLine, ParentImage, ParentCommandLine, _time | sort + _time &lt;-- Search for occurrences of "demon"
</span></code></pre></div></div>
<p><img src="./saved_page_files/Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_53.png" alt="Understanding_Log_Sources_&amp;_Investigating_with_Splunk_Walkthrough_Image_53.png"></p>
<p>Students will quickly discover evidence of <code>demon.dll</code> being loaded by <code>rundll32.exe</code> , confirming the initial infection.</p>
<p>Answer: {hidden}</p>

                </div>
            </div>
        </div>
    </div>
</div>


            </div>

            <footer class="footer">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-sm-6">

                        </div>
                        <div class="col-sm-6">
                            <div class="text-sm-right d-none d-sm-block">
                                Powered by &nbsp; <a href="https://www.hackthebox.com/" target="_blank"><img style="margin-bottom: 1px;" src="./saved_page_files/logo-htb.svg" height="20px" alt="Hack The Box logo"></a>
                            </div>
                        </div>
                    </div>
                </div>
            </footer>
        </div>

    </div>

</div>

<script src="./saved_page_files/jquery.min.js.download"></script>

<link rel="preload" as="style" href="./saved_page_files/vue-radial-progress-a171cc18.css"><link rel="preload" as="style" href="./saved_page_files/app-1eef33f6.css"><link rel="modulepreload" href="./saved_page_files/app-d1506807.js.download"><link rel="modulepreload" href="https://academy.hackthebox.com/build/assets/lodash-c1890673.js"><link rel="modulepreload" href="https://academy.hackthebox.com/build/assets/vue-pusher-c7cc617c.js"><link rel="modulepreload" href="https://academy.hackthebox.com/build/assets/vue-markdown-render-2c038111.js"><link rel="modulepreload" href="https://academy.hackthebox.com/build/assets/vue-router-d40907bb.js"><link rel="modulepreload" href="https://academy.hackthebox.com/build/assets/vuex-25bbbfbe.js"><link rel="modulepreload" href="https://academy.hackthebox.com/build/assets/vue-radial-progress-4ea27d40.js"><link rel="modulepreload" href="https://academy.hackthebox.com/build/assets/popper-f4af5ef6.js"><link rel="modulepreload" href="https://academy.hackthebox.com/build/assets/vuejs-countdown-timer-d930b9aa.js"><link rel="modulepreload" href="https://academy.hackthebox.com/build/assets/vue-screen-5ca5066c.js"><link rel="modulepreload" href="https://academy.hackthebox.com/build/assets/vue2-perfect-scrollbar-dc6fc349.js"><link rel="modulepreload" href="./saved_page_files/main-aa08c8bc.js.download"><link rel="modulepreload" href="https://academy.hackthebox.com/build/assets/just-detect-adblock-220f5df6.js"><link rel="modulepreload" href="./saved_page_files/referral-6739fc5a.js.download"><link rel="modulepreload" href="./saved_page_files/prism-b645253c.js.download"><link rel="modulepreload" href="./saved_page_files/detectBrowser-fc4c37dc.js.download"><link rel="modulepreload" href="./saved_page_files/core-helpers-7a2a3e55.js.download"><link rel="modulepreload" href="https://academy.hackthebox.com/build/assets/index-c70e2865.js"><link rel="modulepreload" href="./saved_page_files/htbNote-235de7b5.js.download"><link rel="stylesheet" href="./saved_page_files/vue-radial-progress-a171cc18.css"><link rel="stylesheet" href="./saved_page_files/app-1eef33f6.css"><script type="module" src="./saved_page_files/app-d1506807.js.download"></script><script type="module" src="./saved_page_files/main-aa08c8bc.js.download"></script><script type="module" src="./saved_page_files/referral-6739fc5a.js.download"></script><script type="module" src="./saved_page_files/prism-b645253c.js.download"></script><script type="module" src="./saved_page_files/detectBrowser-fc4c37dc.js.download"></script><script type="module" src="./saved_page_files/core-helpers-7a2a3e55.js.download"></script><script type="module" src="./saved_page_files/htbNote-235de7b5.js.download"></script>
<script src="./saved_page_files/bootstrap.bundle.min.js.download"></script>
<script src="./saved_page_files/simplebar.min.js.download"></script>
<script src="./saved_page_files/waves.min.js.download"></script>
<script src="./saved_page_files/toastr.min.js.download"></script>

<script>
    $(document).ready(function () {
        const csrfToken = 'o1DARWgBFx6IH2FtqiFTXfhZhd8KfTUKWFxRIrZm';
        const apiToken = '6DhKbr1vvJuGgBmHQ4mJtXFgk5rSpVsMPbsJphDprHErk0zKVXz45N1RSi2aCS6l3R4d5mIXRe1zHRMv';

        initAxios(csrfToken, apiToken);
    });

            $(document).ready(function () {
            const startEvent = new CustomEvent("HtbNote:InitializeNote", {
                detail: {
                    noteId: "60c0ae5c-27fb-4a2f-865d-1ded2cf6a627",
                    token: "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJIVEIgQWNhZGVteSIsInVzZXJfaWQiOiJwcm9kdWN0aW9uLTIwOTU3NjkiLCJyb2xlIjoidXNlciIsImlhdCI6MTc0MTM4NzcyNywiZXhwIjoxNzQxNDc0MTI3fQ.57c6AY49Q_uhO6XDOTtbsyrT00c5fOKAmzR9UfPnfM8"
                }
            });

            window.dispatchEvent(startEvent);
        });
    </script>
<script src="./saved_page_files/bootstrap-select.min.js.download"></script>
<script type="module">
    import {register} from '/assets/libs/core-web-components/index.js';

    register();
</script>

<script>
      let currentBrowser;
      let isPwnboxActive = false;
      let isTargetActive = false;
      let vmCheckTimer;
      let areSolutionsEnabled = false;
      const _showSolutionsSettingSwitch = $('#showSolutionsModuleSetting');
      const isAnnualUser = true;
      const isAdmin = false;
      const isCompanyAdmin = false;

      window.addEventListener('SpawnedPwnBox', () => {
          isPwnboxActive = true;
      }, false);

      window.addEventListener('TerminatedPwnBox', () => {
          isPwnboxActive = false;
      }, false);

      setTimeout(() => {
          currentBrowser = window.detectBrowser();
      }, 1000);

      const AXIOS_ERROR_HANDLING_MESSAGE = 'Something went wrong, please try again later.';

                setTimeout(() => {
              initReferralScheme();
          }, 1000);
      
      $('table').addClass('table table-striped text-left').wrap('<div class="table-responsive"></div>');

      $('.training-module a').attr('target', '_blank').attr('rel', 'noopener nofollow');

      $('.favouriteBtn').click(function () {
          let id = $(this).data('module-id');

          axios.get('/api/modules/favourite/' + id).then(response => {
              let data = response.data;
              if (data.fav === 1) {
            $(this).removeClass('fa-sharp fa-solid fa-regular').addClass('fa-sharp fa-solid');
                  toastr['success'](data.message, 'Success');
              } else {
            $(this).removeClass('fa-sharp fa-solid fa-regular').addClass('fa-regular');
                  toastr['success'](data.message, 'Success');
              }
          }).catch(err => {
              toastr['error'](AXIOS_ERROR_HANDLING_MESSAGE, 'Error');
          });
      });

      function encode_utf8(string) {
          return unescape(encodeURIComponent(string));
      }

      function checkSolutionsSettings() {
        axios.get('/api/v2/user/settings/walkthroughs_enabled').then(response => {
            areSolutionsEnabled = response.data.data.value;

            if(areSolutionsEnabled) {
                _showSolutionsSettingSwitch.prop('checked', true);
            }
        }).catch(error => {
            toastr['error'](data.message, 'Error');
        });
      }

      function manageSolutionsSettings(enableWriteupSettings) {
        return axios.put('/api/v2/user/settings/walkthroughs_enabled', {
            value: enableWriteupSettings
        });
      }

      function handleSolutionPreferencesModalAction(enableWriteupSettings) {
        manageSolutionsSettings(!areSolutionsEnabled).then(response => {
            if (response.status === 204) {
                areSolutionsEnabled = enableWriteupSettings;
                if (areSolutionsEnabled) {
                    // refresh page to update UI
                    window.location.reload();
                }
            }
        }).catch(error => {
            toastr['error'](error.message, 'Error');
        }).finally(() => {
            $('#solutionPreferencesModal').modal('hide');
        });
      }

      _showSolutionsSettingSwitch.on('click', () => {
            if(isAnnualUser || isAdmin || isCompanyAdmin) {
                _showSolutionsSettingSwitch.prop('disabled', true);
                manageSolutionsSettings(!areSolutionsEnabled)
                    .then(response => {
                        if (response.status === 204) {
                            areSolutionsEnabled = !areSolutionsEnabled;
                             // refresh page to update UI
                             window.location.reload();
                        }
                    }).catch(error => {
                        toastr['error'](error.message, 'Error');
                    }).finally(() => {
                        // We add a small delay to avoid possible spam/abuse
                        setTimeout(() => {
                            _showSolutionsSettingSwitch.prop('disabled', false);
                        }, 1500);
                    });
            }
        });

      $('.btnAnswer').click(function () {
          let question_id = $(this).data('question-id');
          $(this).attr('disabled', 1);
          $(this).find('.submit-button-text').addClass('d-none');
          $(this).find('.submit-button-loader').removeClass('d-none');
          let utf8EncodedString = encode_utf8($('#answer' + question_id).val());
          axios.post('/api/check/answer', {
              answer: btoa(utf8EncodedString),
              question_id: question_id
          }).then(response => {
              let data = response.data;
              if (data.success === 0) {
                  $(this).removeAttr('disabled');

                  if(data.should_show_walkthrough_modal) {
                    openSolutionPreferencesModal();
                  }

                  toastr['error'](data.message, 'Error');
              } else {
                  $(this).attr('disabled', 1);
                  $('#answer' + question_id).attr('disabled', 1);
                  $('#answer' + question_id).addClass('text-success');
                  $('#hintBtn' + question_id).attr('disabled', 1);
                  $(`.d-discord-${question_id}`).addClass('d-none');
                  $('#questionStreakPointsText-' + question_id).addClass('d-none');
                  toastr['success'](data.message, 'Success');
                  completeCheck();
              }
              $(this).find('.submit-button-text').removeClass('d-none');
              $(this).find('.submit-button-loader').addClass('d-none');
          }).catch(err => {
              toastr['error'](AXIOS_ERROR_HANDLING_MESSAGE, 'Error');
          });
      });

      $('.btnAnswerExercise').click(function () {
          let exercise_id = $(this).data('exercise-id');
          $(this).attr('disabled', 1);
          $(this).find('.submit-button-text').addClass('d-none');
          $(this).find('.submit-button-loader').removeClass('d-none');
          let utf8EncodedString = encode_utf8($(`#exerciseAnswer${exercise_id}`).val());
          axios.post(`/api/check/exercise/${exercise_id}/answer`, {
              answer: btoa(utf8EncodedString)
          }).then(response => {
              let data = response.data;
              if (data.success === 0) {
                  $(this).removeAttr('disabled');
                  toastr['error'](data.message, 'Error');
              } else {
                  $(this).attr('disabled', 1);
                  $(`#exerciseAnswer${exercise_id}`).attr('disabled', 1);
                  $(`#exerciseAnswer${exercise_id}`).addClass('text-success');
                  toastr['success'](data.message, 'Success');
              }
              $(this).find('.submit-button-text').removeClass('d-none');
              $(this).find('.submit-button-loader').addClass('d-none');
          }).catch(err => {
              toastr['error'](AXIOS_ERROR_HANDLING_MESSAGE, 'Error');
          });
      });

      $('.btnAnswerExerciseMultiple').click(function () {
          $(this).attr('disabled', 1);
          $(this).find('.submit-button-text').addClass('d-none');
          $(this).find('.submit-button-loader').removeClass('d-none');
          let exercise_id = $(this).data('exercise-id');
          $(this).attr('disabled', 1);
          let utf8EncodedString = $(`#exerciseAnswer${exercise_id}`).find('input:checked').val();
          axios.post(`/api/check/exercise/${exercise_id}/answer`, {
              answer: btoa(utf8EncodedString)
          }).then(response => {
              let data = response.data;
              if (data.success === 0) {
                  $(this).removeAttr('disabled');
                  toastr['error'](data.message, 'Error');
                  $(`#exerciseAnswer${exercise_id} input[type=radio]:checked`).parent().parent().find(`.exercise-answer-justification`).removeClass('d-none');
                  $(`#exerciseAnswer${exercise_id} input[type=radio]:checked`).attr('disabled', 1);
                  $(`#exerciseAnswer${exercise_id} input[type=radio]:checked`).parent().find('label').addClass('text-danger red');
              } else {
                  $(this).attr('disabled', 1);
                  $(`#exerciseAnswer${exercise_id}`).attr('disabled', 1);
                  $(`#exerciseAnswer${exercise_id} input[type=radio]:checked`).parent().find('label').addClass('text-success green');
                  $(`#exerciseAnswer${exercise_id} input[type=radio]:checked`).parent().find('label').removeClass('red');
                  $(`#exerciseAnswer${exercise_id} input[type=radio]`).attr('disabled', 1);
                  $(`#exerciseAnswer${exercise_id} .exercise-answer-justification`).removeClass('d-none');
                  toastr['success'](data.message, 'Success');
              }
              $(this).find('.submit-button-text').removeClass('d-none');
              $(this).find('.submit-button-loader').addClass('d-none');
          }).catch(err => {
              toastr['error'](AXIOS_ERROR_HANDLING_MESSAGE, 'Error');
          });
      });

      $('.reveal-modal').click(e => {
          let id = $(e.target).data('exercise-id');
          $(`#revealExerciseAnswer${id}`).modal('hide');
      });

      $(document).ready(function () {
        let isOnOverloadedVpnServer;
        const overLoadedVpnServerStatusKey = 'htb-vpn-overloaded-status';
        isOnOverloadedVpnServer= '' ?? false;
        const isNotInformedForVpnLoad = JSON.parse(localStorage.getItem(overLoadedVpnServerStatusKey) === null);

        if(isOnOverloadedVpnServer && isNotInformedForVpnLoad) {
            $('#overloadedVpnInfoModal').modal('show');
        }

          setTimeout(() => {
            // we add a delay before calling this function
            // in order the axios headers to have been set
            completeCheck();
            checkSolutionsSettings();

          }, 500);

          setTimeout(() => {
            $('.bootstrap-select').find('button').attr("title","");
          }, 5000);

          $('pre').filter(function () {
              return this.className.match(/\blanguage-/);
          }).each(function () {
              let heading = $(this).prevAll().closest('h1').last().text();

              if (this.className === ' language-shell-session') {
                  wrapTerminal(this, heading);
              } else if (this.className === ' language-powershell-session') {
                  wrapPSTerminal(this, heading);
              } else if (this.className === ' language-cmd-session') {
                  wrapCMDTerminal(this, heading);
              } else if (this.className.startsWith(' language-')) {
                  var language = this.className.split('-').pop();
                  wrapCodeBlock(this, language);
              }
          });

          wrapBrowser($('.website-screenshot'));

          $('span:contains(\'[!bash!]\')').html('<span class="text-gray">icantthinkofaname23@htb</span><span class="text-success">[/htb]</span>');

          let _vpnSelector = $('.vpnSelector');
          let _selectedServer = _vpnSelector.val();
          let _vpnLoader = $('.vpn-loader');

          let _vpnSwitchWarningModal = $('#vpnSwitchWarningModal');
          let _continueVpnSwitchBtn = $('#continueVpnSwitchBtn');
          let _continueVpnSwitchBtnText = $('#continueVpnSwitchBtnText');
          let _cancelVpnSwitchBtn = $('#cancelVpnSwitchBtn');
          let _vpnSwitchWarningModalLoader = $('.vpnSwitchModalLoader');

          // Modal for warning the user about switching to an overloaded server
          let _overloadedVpnWarningModal = $('#overloadedVpnWarningModal');

          // Modal for informing the user already being on an overloaded server
          let _overloadedVpnInfoModal = $('#overloadedVpnInfoModal');

          // Reverts the selected server to the last selected server
          function cancelVpnServerChange() {
            _overloadedVpnWarningModal.modal('hide');
            _vpnSelector.val(_selectedServer);
            _vpnSelector.selectpicker('refresh');
          }

          _overloadedVpnWarningModal.find('#stayToVpnServerWarning, .close').on('click', () => {
            cancelVpnServerChange();
          });

          _overloadedVpnWarningModal.find('#overloadedVpnServerWarningAction').on('click', () => {
            localStorage.setItem(overLoadedVpnServerStatusKey, JSON.stringify('complete'));
            _overloadedVpnWarningModal.modal('hide');
            switchVpnServer(true);
          });

          _overloadedVpnInfoModal.find('#stayToVpnServerInfo, #overloadedVpnInfoAction, .close').on('click', () => {
            _vpnSelector.val(_selectedServer);
            _vpnSelector.selectpicker('refresh');
            _overloadedVpnInfoModal.modal('hide');
          });

          _overloadedVpnInfoModal.on('hidden.bs.modal', () => {
            localStorage.setItem(overLoadedVpnServerStatusKey, JSON.stringify('complete'));
          });

          _vpnSelector.change(function () {
              if (isPwnboxActive) {
                _vpnSwitchWarningModal.modal('show');
              } else {
                let vpnLoadLevel = $('.vpnSelector option:selected').data('level');
                if (vpnLoadLevel >= 70) {
                    _overloadedVpnWarningModal.modal('show');
                } else {
                    switchVpnServer();
                }
              }
          });

          function switchVpnServer(displayError = true) {
            let vpnId = $('.vpnSelector option:selected').val();
            if (!vpnId) return;

            _vpnLoader.removeClass('d-none');
            _vpnLoader.addClass('d-flex');
            $('.bootstrap-select').addClass('d-none');

            // Display button loader and disable the buttons while
            // waiting for the request to finish
            _continueVpnSwitchBtnText.addClass('d-none');
            _vpnSwitchWarningModalLoader.removeClass('d-none');
            _continueVpnSwitchBtn.addClass('disabled');
            _cancelVpnSwitchBtn.addClass('disabled');
            _vpnSwitchWarningModal.find('.close').addClass('disabled');

            axios.post(`/api/v2/vpn-servers/${vpnId}/switch`, {}).then(response => {
                _vpnLoader.removeClass('d-flex');
                _vpnLoader.addClass('d-none');
                $('.bootstrap-select').removeClass('d-none');

                toastr['success']('Vpn server switched successfully', 'Success');
                $('.startInstanceBtn').each(function () {
                    $(this).removeClass('disabled');
                });

                _selectedServer = _vpnSelector.val();
                _vpnSwitchWarningModal.modal('hide');
                _continueVpnSwitchBtnText.removeClass('d-none');
                _vpnSwitchWarningModalLoader.addClass('d-none');
                _continueVpnSwitchBtn.removeClass('disabled');
                _cancelVpnSwitchBtn.removeClass('disabled');
                _vpnSwitchWarningModal.find('.close').removeClass('disabled');

                if (isTargetActive) {
                    $('.target').html('<i class="fad fa-circle-notch fa-spin"></i> Target is spawning...');
                    $('.targetIp').html('<i class="fad fa-circle-notch fa-spin"></i>');
                    $('.target-protocol-ip').html('<i class="fad fa-circle-notch fa-spin"></i>');
                    $('.resetTargetBtn').hide();
                    $('.resetTargetBtn').prop('disabled', true);

                    vmCheckTimer = setInterval(function () {
                        window.checkMultipleVMs();
                    }, 5 * 1000);
                }

            }).catch(err => {
                clearInterval(vmCheckTimer);
                _vpnLoader.removeClass('d-flex');
                _vpnLoader.addClass('d-none');
                $('.bootstrap-select').removeClass('d-none');
                if(displayError) {
                    toastr['error'](err.response.data.message, 'Error');
                }
                _vpnSelector.val(_selectedServer);
                $('.selectpicker').selectpicker('refresh')
                _vpnSwitchWarningModal.modal('hide');
                _continueVpnSwitchBtnText.removeClass('d-none');
                _vpnSwitchWarningModalLoader.addClass('d-none');
                _continueVpnSwitchBtn.removeClass('disabled');
                _cancelVpnSwitchBtn.removeClass('disabled');
                _vpnSwitchWarningModal.find('.close').removeClass('disabled');
            });

          }

          _continueVpnSwitchBtn.on('click', () => {
              switchVpnServer();
          });

          _vpnSwitchWarningModal.find('.close').on('click', () => {
              _vpnSelector.val(_selectedServer);
              _vpnSwitchWarningModal.modal('hide');
          });

          _cancelVpnSwitchBtn.on('click', () => {
              _vpnSelector.val(_selectedServer);
              _vpnSwitchWarningModal.modal('hide');
          });

          _vpnSwitchWarningModal.on('hidden.bs.modal', () => {
              _continueVpnSwitchBtnText.removeClass('d-none');
              _vpnSwitchWarningModalLoader.addClass('d-none');

              // Reset button state on modal close
              _continueVpnSwitchBtn.removeClass('disabled');
              _cancelVpnSwitchBtn.removeClass('disabled');
              _vpnSwitchWarningModal.find('.close').removeClass('disabled');
          });

      });

      $('.download-vpn-settings').click(() => {
          let type = 'regular';
          let protocol = $('input[name="vpn-protocol"]:checked').val();
          axios.get(`/api/v2/vpn-servers/key/download?type=${type}&protocol=${protocol}`).then(response => {
              const url = window.URL.createObjectURL(new Blob([response.data]));
              const link = document.createElement('a');
              link.href = url;
              link.setAttribute('download', `academy-${type}.ovpn`);
              document.body.appendChild(link);
              link.click();
          }).catch(err => {
              toastr['error'](err.response.data.message, 'Error');
          });
      });

      $('#completeBtn').click(() => {
          $('#completeBtn').addClass('disabled');
          $('#complete-button-text').addClass('d-none');
          $('#complete-button-loader').removeClass('d-none');
      });

      function completeCheck() {
          axios.get('/api/check/complete/2389').then(response => {
              let data = response.data;
              if (data.success === 1) {
                  if (data.completed === true) {
                      $('#completeBtn').show();
                      $('#completeBtnPoints').removeClass('d-none');
                  }
              }
          }).catch(err => {
              toastr['error'](AXIOS_ERROR_HANDLING_MESSAGE, 'Error');
          });
      }

      function wrapTerminal(element, heading) {
          $(element).css('line-height', '0px');
          $(element).wrap('<div class="window_content"></div>')
              .parent().wrap('<div class="window_container"></div>')
              .prepend(`
                      <div class='window_top'>
                          <span class='window_dot bg-danger'></span>
                          <span class='window_dot bg-warning'></span>
                          <span class='window_dot bg-success'></span>
                          <span class='window_title'>${heading}</span>
                      </div>
                  `);
      }

      function wrapPSTerminal(element, heading) {
          $(element).css('background', '#012456').children().css('color', 'white');
          $(element).css('line-height', '0px');
          $(element).wrap('<div class="window_content"></div>')
              .parent().wrap('<div class="window_container"></div>')
              .prepend(`
                      <div class='window_top'>
                          <span class='window_dot bg-danger'></span>
                          <span class='window_dot bg-warning'></span>
                          <span class='window_dot bg-success'></span>
                          <span class='window_title'>${heading}</span>
                      </div>
                  `);
      }

      function wrapCMDTerminal(element, heading) {
          $(element).css('background', 'black').children().css('color', 'white');
          $(element).css('line-height', '0px');
          $(element).wrap('<div class="window_content"></div>')
              .parent().wrap('<div class="window_container"></div>')
              .prepend(`
                      <div class='window_top'>
                          <span class='window_dot bg-danger'></span>
                          <span class='window_dot bg-warning'></span>
                          <span class='window_dot bg-success'></span>
                          <span class='window_title'>${heading}</span>
                      </div>
                  `);
      }

      function wrapCodeBlock(element, lang) {
          $(element).wrap('<div class="window_content"></div>')
              .parent().wrap('<div class="window_container"></div>')
              .prepend('<div class="window_top">Code: <span class="text-success">' + lang + '</div>');
      }

      function wrapBrowserOld(element) {
          $(element).css('border', '0px').css('border-radius', '0');
          let url = element.data('url');
          $(element).wrap('<div class="window_content"></div>')
              .parent().wrap('<div class="window_container"></div>')
              .prepend(`
                      <div class='window_top'>
                          <span class='window_dot bg-danger'></span>
                          <span class='window_dot bg-warning'></span>
                          <span class='window_dot bg-success'></span>
                          <input type='text' class='website-screenshot-url' disabled value='${url}'>
                          <span class='float-right'><i class='fa fa-home'></i></span>
                      </div>
                  `);
      }

      function wrapBrowser(element) {
          $(element).css('border', '0px').css('border-radius', '0');

          $(element).each(function (index, e) {
              let url = $(e).data('url');
              $(e).wrap('<div class="window_content"></div>')
                  .parent().wrap('<div class="window_container"></div>')
                  .prepend(`
                          <div class='window_top'>
                              <span class='mr-2'>
                                  <i class='fa fa-arrow-circle-left'></i> <i class='fa fa-arrow-right'></i> <i class='fa fa-redo'></i> <i class='fa fa-home'></i>
                              </span>
                              <input type='text' class='website-screenshot-url' disabled value='${url}'>
                              <span class='float-right'><i class='fa fa-bars'></i></span>
                          </div>
                      `);
          });
      }

      // This one is used by the requestHelpModal
      function requestHelp() {
          let question_id = $('#requestHelpModal').data('question_id');
          axios.post(`/api/question/${question_id}/help`)
              .then(({ data }) => {
                  $('#requestHelpModal').modal('hide');
                  if (data.success == 0) {
                      toastr['error'](data.message, 'Error');
                      return;
                  }
                  toastr['success']('Request sent!', 'Success');
              }).catch(err => {
                  toastr['error'](AXIOS_ERROR_HANDLING_MESSAGE, 'Error');
              });
      }

      function openRequestModal(question_id) {
          $('#requestHelpModal').modal('show').data('question_id', question_id);
      }

      function openSolutionPreferencesModal() {
        $('#solutionPreferencesModal').modal('show');
      };

      function openWalkthroughModal(index, sectionTitle) {
          let _walkthrougModal = $('#walkthroughModal');
          const _walkthroughContent = $('#walkthroughModal').find('.training-module');
          const _walkthroughLoader = $('.walkthrough-loader');
          _walkthrougModal.modal('show');
          _walkthrougModal.on('shown.bs.modal', function (event) {
              const indexNumber = new Number(index);

              _walkthroughLoader.removeClass('d-none');
              _walkthroughLoader.addClass('d-block');

              let question = `Question ${indexNumber + 1}`;
              let element = $('h1').filter(function () {
                  // Filter all the h1 headers, to find the exact section title
                  return $(this).text().trim().toLowerCase() === sectionTitle.toLowerCase();
              }).nextAll('h2').filter(function () {
                  // then filter all the h2 headers, to find the exact question as well
                  return $(this).text().trim().toLowerCase() === question.toLowerCase();
              }).first();

              if (element.length) {
                  setTimeout(() => {
                      _walkthroughLoader.addClass('d-none');
                      _walkthroughLoader.removeClass('d-block');
                      _walkthroughContent.removeClass('d-none');

                      _walkthrougModal.animate({
                          scrollTop: element.offset().top - _walkthrougModal.offset().top + _walkthrougModal.scrollTop()
                      }, 500);
                  }, 1500);
              } else {
                  _walkthroughLoader.addClass('d-none');
                  _walkthroughLoader.removeClass('d-block');
                  _walkthroughContent.removeClass('d-none');
              }
          });
          _walkthrougModal.on('hidden.bs.modal', function (event) {
              // Make sure that content gets hidden again
              // in case the user re-opens the modal multiple times
              _walkthroughContent.addClass('d-none');
          });
      }

      
      function initStreakToast(autoHideOption = true) {
          const streakToast = $('#streak-toast');
          streakToast.toast({ autohide: autoHideOption, delay: 20000 }).toast('show');
      }

      function initStreaksNotificationContent(streaksTemplate) {
          return new Promise((resolve, reject) => {
              const _streaksContainer = $('.streaks-container');
              _streaksContainer.html(streaksTemplate);
              resolve();
          });

      }
</script>

<script type="module">
    import RFB from '/assets/libs/vnc/core/rfb.js';

      let rfb;
      let sidePreview;
      let desktopName;
      let pwnboxActive = false;
      $(document).ready(function () {
          getRegions();
          const userId = '1659683';
          Echo.private(`user-${userId}`)
              .listen('.streak.completed', data => {
                  initStreaksNotificationContent(data.streak_popup).then(() => {
                      initStreakToast();
                  });
              })
              .listen('.streak.progressed', data => {
                  initStreaksNotificationContent(data.streak_popup).then(() => {
                      initStreakToast();
                  });
              })
              .listen('.streak.started', data => {
                  const { event, current_streak } = data.streak_data;
                  initStreaksNotificationContent(data.streak_popup).then(() => {
                    const enableToastAutohide = event === 'streak.started' && current_streak === 0 ? false : true;
                    initStreakToast(enableToastAutohide);
                  });
              });
      });

      function connectedToServer(e) {
          status('Connected to ' + desktopName);
          $('.fullScreenBtn').show();
          $('.resetInstanceBtn').show();
          $('.terminateInstanceBtn').show();
          $('.extendInstanceBtn').show();
          $('.instanceLoading').hide();
          $('.instanceStart').hide();
          $('.resetInstanceBtn').prop('disabled', false);
          $('.fullScreenBtn').prop('disabled', false);
          $('.extendInstanceBtn').prop('disabled', false);
          $('.terminateInstanceBtn').prop('disabled', false);

          document.querySelector('canvas').addEventListener('focus', (event) => {
              if (currentBrowser.firefox) {
                  window.copyToClipboard(event.target.textContent);
              } else {
                  navigator.clipboard.readText()
                      .then(text => {
                          writeToClipboard(text);
                      })
                      .catch(err => {
                          console.error('Something went wrong while accessing clipboard', err);
                      });
              }
          });
      }

      function disconnectedFromServer(e) {
          status('Disconnected');
          $('.screenPlaceholder').show();
          stopCountdown();
      }

      function clipboardReceived(e) {
          navigator.clipboard.writeText(e.detail.text)
              .then(() => {
                  // Success!
              })
              .catch(err => {
                  console.error('Something went wrong while copying to clipboard.', err);
              });
      }

      function updateDesktopName(e) {
          desktopName = e.detail.name;
      }

      function status(text) {
          $('#statusText').html(text);
      }

      function readQueryVariable(name) {
          const re = new RegExp('.*[?&]' + name + '=([^&#]*)'),
              match = document.location.href.match(re);

          if (match) {
              return decodeURIComponent(match[1]);
          }

          return null;
      }

      function writeToClipboard(text) {
          rfb.clipboardPasteFrom(text);
      }

      let host = '';
      let password = '';
      let countdown = '';
      let targetCountdown = '';
      let targetRemainingTimeInSeconds = '';
      let url = '';
      let spawnInterval = null;

      function getPwnbox() {
          return new Promise((resolve, reject) => {
              axios.get('/api/get/pwnbox').then(response => {
                  let data = response.data;
                  if (data.success === 1 && data.instance.status === 'ready') {
                      host = `proxy-${data.instance.location}.htb-cloud.com/bird/${data.instance.hostname}`;
                      password = data.instance.password;
                      $('.lifeLeft').html(data.instance.life_remaining);
                      startCountdown();
                      $('.screenPlaceholder').hide();
                      url = 'https://vnc.htb-cloud.com/index.html?host=' + host + '&password=' + password;
                      isPwnboxActive = true;

                      if (document.querySelector('wc-htb-pwnbox-selection-card')) {
                          document.querySelector('wc-htb-pwnbox-selection-card').setAttribute('pwnbox-active', true);
                      }
                      connect();
                      if (spawnInterval !== null) {
                          clearInterval(spawnInterval);
                      }
                      resolve('success getting pwnbox');
                  } else {
                      $('.screenPlaceholder').show();
                  }
              }).catch(err => {
                  toastr['error'](AXIOS_ERROR_HANDLING_MESSAGE, 'Error');
                  reject(err);
              });
          });
      }

                function extendPwnbox() {
              axios.get('/api/extend/pwnbox').then(response => {
                  let data = response.data;
                  if (data.success === 1) {
                      $('.lifeLeft').html(data.instance.life_remaining);
                      stopCountdown().then(() => {
                          startCountdown();
                          toastr['success']('Time extended for 60 minutes.', 'Success');
                      });
                  } else {
                      toastr['error'](data.message, 'Error');
                  }

              }).catch(err => {
                  toastr['error'](AXIOS_ERROR_HANDLING_MESSAGE, 'Error');
              });
          }

      
      function initStartCountdown() {
          let life = parseInt($('.lifeLeft').html()) - 1;
          $('.lifeLeft').html(life);
      }

      function startCountdown() {
          countdown = setInterval(function () {
              initStartCountdown();
          }, 60 * 1000);
      }

      function stopCountdown() {
          return new Promise((resolve) => {
              clearInterval(countdown);
              resolve();
          });
      }

      function terminatePwnbox() {
          return new Promise((resolve, reject) => {
              $('.resetInstanceBtn').prop('disabled', true);
              $('.terminateInstanceBtn').prop('disabled', true);
              $('.fullScreenBtn').prop('disabled', true);
              $('.extendInstanceBtn').prop('disabled', true);
              $('.instanceStart').hide();

              $('.instanceTerminating').show();

              status('Terminating Interactive Instance...');

              axios.delete('/api/terminate/pwnbox')
                  .then(({ data }) => {
                      if (data.success === 1) {
                          $('.startInstanceBtn').show();
                          $('.instanceStart').show();
                          $('.instanceTerminating').hide();
                          $('.resetInstanceBtn').hide();
                          $('.terminateInstanceBtn').hide();
                          $('.fullScreenBtn').hide();
                          $('.extendInstanceBtn').hide();

                          isPwnboxActive = false;

                          $('.iterminal').addClass('d-none');

                          toastr['success']('Instance has been terminated.', 'Success');

                          /**
                           *  Dispatch an event when pwnBox is terminated
                           */
                          var terminatePwnBoxEvent = new CustomEvent('TerminatedPwnBox');
                          window.dispatchEvent(terminatePwnBoxEvent);

                          resolve('succes terminating pwnbox');

                      } else {
                          toastr['error'](data.message, 'Error');
                          connect();
                          $('.resetInstanceBtn').prop('disabled', false);
                          $('.fullScreenBtn').prop('disabled', false);
                          $('.extendInstanceBtn').prop('disabled', false);
                          $('.terminateInstanceBtn').prop('disabled', false);
                      }
                  }).catch(err => {
                      reject(err);
                      toastr['error'](AXIOS_ERROR_HANDLING_MESSAGE, 'Error');
                  });
          }).catch(error => {
              reject(error);
          });
      }

      let _wcPwnbox = document.querySelector('wc-htb-pwnbox-selection-card');

      function errorHandling(value) {
          switchToRegion = value.detail[0];
          _pwnboxSwitchWarningModal.modal('show');
      }

      function getSelectedPwnboxLocation(event) {
          if (pwnboxActive) {
              selectedPwnBoxLocation = currentPwnboxLocation;
              return;
          }
          selectedPwnboxLocation = event.detail[0];
      }

      function getCurrentPwnboxLocation(server) {
          currentPwnboxLocation = server;
      }

      function setCurrentPwnboxServer(server) {
          _wcPwnbox.setAttribute('current-pwnbox', server);
      }

      let selectedPwnboxLocation;
      let currentPwnboxLocation;
      let switchToRegion;

      let pwnboxRegions;

      let _pwnboxSwitchWarningModal = $('#pwnboxSwitchWarningModal');
      let _cancelPwnboxSwitchBtn = $('#cancelPwnboxSwitchBtn');
      let _continuePwnboxSwitchBtn = $('#continuePwnboxSwitchBtn');
      let _continuePwnboxSwitchBtnText = $('#continuePwnboxSwitchBtnText');
      let _pwnboxSwitchModalLoader = $('.pwnboxSwitchModalLoader');

      _cancelPwnboxSwitchBtn.on('click', () => {
          initWcPwnbox(pwnboxRegions);
          _pwnboxSwitchWarningModal.modal('hide');
      });

      _continuePwnboxSwitchBtn.on('click', () => {
          _continuePwnboxSwitchBtnText.addClass('d-none');
          _pwnboxSwitchModalLoader.removeClass('d-none');
          _continuePwnboxSwitchBtn.addClass('disabled');
          _cancelPwnboxSwitchBtn.addClass('disabled');

          let oldCurrentPwnbox = selectedPwnboxLocation = currentPwnboxLocation = switchToRegion;

          $('.screenPlaceholder').show();
          $('.instanceStart').show();
                        rfb.disconnect();
                    sidePreview.disconnect();
          terminatePwnbox().then(() => {

              startPwnbox().then(() => {
                  _pwnboxSwitchWarningModal.modal('hide');
                  _continuePwnboxSwitchBtnText.removeClass('d-none');
                  _pwnboxSwitchModalLoader.addClass('d-none');
                  _continuePwnboxSwitchBtn.removeClass('disabled');
                  _cancelPwnboxSwitchBtn.removeClass('disabled');
                  initWcPwnbox(pwnboxRegions);
              }).catch(() => {
                  _pwnboxSwitchWarningModal.modal('hide');
                  _continuePwnboxSwitchBtnText.removeClass('d-none');
                  _pwnboxSwitchModalLoader.addClass('d-none');
                  _continuePwnboxSwitchBtn.removeClass('disabled');
                  _cancelPwnboxSwitchBtn.removeClass('disabled');
                  initWcPwnbox(pwnboxRegions);
              });
          }).catch(error => {
              toastr['error'](error.message, 'Error');
              currentPwnboxLocation = oldCurrentPwnbox;
              initWcPwnbox(pwnboxRegions);
          });
      });

      function initWcPwnbox(regions) {
          /**
           *  Creates pwnbox server select component
           */
          const pwnboxSelector = document.createElement('wc-htb-pwnbox-selection-card');
          pwnboxSelector.setAttribute('regions', JSON.stringify(regions));
          pwnboxSelector.setAttribute('current-pwnbox', JSON.stringify(currentPwnboxLocation));

          $('.pwnbox-select-card').html(pwnboxSelector);
          pwnboxSelector.addEventListener('getSelectedPwnboxLocation', getSelectedPwnboxLocation);
          pwnboxSelector.addEventListener('actionNotAllowed', errorHandling);
          selectedPwnboxLocation = currentPwnboxLocation;

          if (isPwnboxActive) document.querySelector('wc-htb-pwnbox-selection-card').setAttribute('pwnbox-active', true);
      }

      function getRegions() {
          axios.get('/api/v2/pwnbox/regions').then(response => {
              const data = response.data.data;
              currentPwnboxLocation = response.data.meta.currentRegion;
              const regions = [];

              const latencyPromises = data.map((region) => {
                  const item = { name: region.title, value: region.value };
                  // Use Promise.resolve to ensure each iteration of the loop returns a Promise
                  return Promise.resolve()
                      .then(() => getServerLatency(region.proxyLatencyURL))
                      .then((response) => {
                          item.latency = response;
                          regions.push(item);
                      });
              });

              pwnboxRegions = regions;

              Promise.all(latencyPromises).then(() => {
                  // This code will run after all the getServerLatency calls have completed

                  initWcPwnbox(regions);
                  /**
                   * getting pwnbox status and setting isPwnboxActive flag
                   * if isPwnboxActive is true we are passing the respective attribute to the web component
                   */
                  getPwnbox().then(() => {
                      if (isPwnboxActive) {
                          document.querySelector('wc-htb-pwnbox-selection-card').setAttribute('pwnbox-active', true);
                      }
                  });
              })
                  .catch((error) => {
                      // Handle any errors that occurred during the Promise.all chain
                      console.error('An error occurred:', error);
                  });

          }).catch(err => {
              toastr['error'](AXIOS_ERROR_HANDLING_MESSAGE, 'Error');
          });
      }

      function startPwnbox() {
          return new Promise((resolve, reject) => {

              $('.resetInstanceBtn').prop('disabled', true);
              $('.fullScreenBtn').prop('disabled', true);
              $('.extendInstanceBtn').prop('disabled', true);
              $('.terminateInstanceBtn').prop('disabled', true);
              $('.instanceStart').hide();
              $('.instanceLoading').show();
              $('.startInstanceBtn').hide();

              status('Starting Interactive Instance...');

              grecaptcha.ready(function () {
                  grecaptcha.execute('6LeI6LsaAAAAAKgdStgBC6B4UVbXlpYNaYGN46Ah', { action: 'spawnPwnbox' }).then(function (token) {
                      if (token) {
                          axios.get(`/api/spawn/pwnbox?g-recaptcha-response=${token}&region=${selectedPwnboxLocation.value}`).then(response => {
                              let data = response.data;
                              if (data.success === 1) {
                                  spawnInterval = setInterval(() => {
                                      getPwnbox();
                                  }, 2000);
                              } else {
                                  if (data.code === 1 || (data.code === 3 && isPwnboxActive)) {
                                      $('.resetInstanceBtn').prop('disabled', false);
                                      $('.fullScreenBtn').prop('disabled', false);
                                      $('.extendInstanceBtn').prop('disabled', false);
                                      $('.terminateInstanceBtn').prop('disabled', false);
                                      connect();

                                      if (data.code === 3) {
                                          $('.instanceLoading').hide();
                                          startCountdown();
                                      }
                                  } else {
                                      $('.startInstanceBtn').show();
                                      $('.instanceStart').show();
                                      $('.instanceLoading').hide();
                                  }

                                  toastr['error'](data.message, 'Error');
                              }
                              resolve('success start pwnbox');
                          }).catch(err => {
                              toastr['error'](AXIOS_ERROR_HANDLING_MESSAGE, 'Error');
                          });
                      } else {
                          $('.resetInstanceBtn').prop('disabled', false);
                          $('.fullScreenBtn').prop('disabled', false);
                          $('.extendInstanceBtn').prop('disabled', false);
                          $('.terminateInstanceBtn').prop('disabled', false);
                          $('.instanceStart').show();
                          $('.instanceLoading').hide();
                          $('.startInstanceBtn').show();
                      }
                  });
              });
          }).catch(error => {
              reject(error);
          });
      }

      $('.fullScreenBtn').click(function () {
          window.open(url, '_blank');
      });

      $('.startInstanceBtn').click(function () {
          if (!selectedPwnboxLocation?.value) {
              toastr['warning']('Please select Pwnbox server', 'Warning');
              return;
          }
          startPwnbox(selectedPwnboxLocation.value);
      });

      $('.resetInstanceBtn').click(function () {
          $('.screenPlaceholder').show();
          $('.instanceStart').show();
                        rfb.disconnect();
              $('.iterminal').addClass('d-none');
              // This event is dispatched when the pwnbox is terminated and it is catched on the Terminal component
              // to set the pwnboxStatus to null
              let terminatePwnBoxEvent = new CustomEvent('TerminatedPwnBox');
              window.dispatchEvent(terminatePwnBoxEvent);
                    sidePreview.disconnect();
          startPwnbox(selectedPwnboxLocation.value);
      });

      $('.terminateInstanceBtn').click(function () {
          $('.screenPlaceholder').show();
          $('.instanceStart').show();
                        rfb.disconnect();
                    sidePreview.disconnect();
          terminatePwnbox();
      });

      $('.extendInstanceBtnClicker').click(function () {
          extendPwnbox();
      });

      $('.resetTargetBtn').click(function () {
          $('.resetTargetBtn').prop('disabled', true);
          $('.resetTargetBtn').hide();
          stopTargetCountdown().then(()=>{
                                    $('.targetLifeContainer').addClass('d-none');
            $('.targetLifeContainer').removeClass('d-flex');
            spawnMultipleVMs();
                      });
      });

                function extendTargetSystem() {
            return new Promise((resolve, reject) => {
                axios.post('/api/extend/vms/2389').then(response => {
                  let data = response.data;
                  if (data.success === 1) {
                    checkMultipleVMs().then(response => {
                        if(response.status === 200) {
                            let entrypoints = response.data.data.entrypoints;
                            const targetsDeploying = entrypoints.some(entrypoints => entrypoints.status === 'deploying');

                            if (targetsDeploying) {
                                $('.targetIp').html('<i class="fad fa-circle-notch fa-spin"></i>');
                                $('.target-protocol-ip').html('<i class="fad fa-circle-notch fa-spin"></i>');
                                vmCheckTimer = setInterval(function () {
                                    checkMultipleVMs(true);
                                }, 5 * 1000);
                            } else {
                                const availableTargets = entrypoints.filter(entrypoint => entrypoint.status === 'ready');

                                initializeTimeLeft(availableTargets[0]?.remaining_life_in_seconds);
                                stopTargetCountdown().then(() => {
                                    startTargetCountdown();
                                    toastr['success']('Time extended for 60 minutes.', 'Success');
                                });
                                resolve();
                            }
                        };
                    }).catch(err => {
                        clearInterval(vmCheckTimer);
                        toastr['error'](AXIOS_ERROR_HANDLING_MESSAGE, 'Error');
                        $('.targetLifeContainer').addClass('d-flex');
                        $('.targetLifeContainer').removeClass('d-none');
                        resetSpawnTargetSystemText();
                    });
                  } else {
                      toastr['error'](data.message, 'Error');
                      reject('Unable to extend vm');
                  }
              }).catch(err => {
                  toastr['error'](AXIOS_ERROR_HANDLING_MESSAGE, 'Error');
                  reject(err);
              });
            });
          }

      $('.extendTargetSystemBtn').click(function () {
        $('.extendTargetSystemBtn').prop('disabled', true);
        $('.extend-icon').addClass('d-none');
        $('.extend-loader').removeClass('d-none');
          extendTargetSystem().finally(()=>{
            $('.extendTargetSystemBtn').prop('disabled', false);
            $('.extend-loader').addClass('d-none');
            $('.extend-icon').removeClass('d-none');
          });
      });
      
      function connect() {
          status('Connecting to ' + host.split('/')[2] + '...');

                        rfb = new RFB(document.getElementById('screen'), 'wss://' + host,
                  { credentials: { password: password } });
          //Listeners
          rfb.addEventListener('desktopname', updateDesktopName);
          rfb.addEventListener('clipboard', clipboardReceived);

          rfb.resizeSession = true;
          rfb.viewOnly = false;
          
          sidePreview = new RFB(document.getElementById('sidePreview'), 'wss://' + host,
              { credentials: { password: password } });

          sidePreview.addEventListener('connect', connectedToServer);
          sidePreview.addEventListener('disconnect', disconnectedFromServer);

          sidePreview.resizeSession = false;
          sidePreview.viewOnly = true;
          sidePreview.scaleViewport = true;

          /**
           *  Dispatch an event when pwnBox is spawned
           */
          var spawnedPwnBoxEvent = new CustomEvent('SpawnedPwnBox');
          window.dispatchEvent(spawnedPwnBoxEvent);
      }


                    $(document).on('click', '.spawnTargetBtn', function () {
              spawnMultipleVMs();
        });

        function fetchMultipleVMs() {
            return axios.get('/api/v2/modules/218/sections/2389/lab');
        }

        function spawnMultipleVMs() {
            $('.target').html('<i class="fad fa-circle-notch fa-spin"></i> Target(s) are spawning...');
            $('.targetIp').html('<i class="fad fa-circle-notch fa-spin"></i>');
            $('.target-protocol-ip').html('<i class="fad fa-circle-notch fa-spin"></i>');

            axios.get('/api/spawn/vms/2389').then(response => {
                let data = response.data;
                if (data.success === 1) {
                    isTargetActive = true;
                    vmCheckTimer = setInterval(function () {
                        checkMultipleVMs(true);
                    }, 5 * 1000);
                } else {
                    toastr['error'](data.message, 'Error');
                    isTargetActive = false;
                    resetSpawnTargetSystemText();
                }
            }).catch(err => {
                    toastr['error'](AXIOS_ERROR_HANDLING_MESSAGE, 'Error');
                    isTargetActive = false;
            });
        }

       window.copyVmIP = function copyVmIP(textContent) {
            window.copyToClipboard(textContent).then(() => {
                    toastr['success']('Target copied to clipboard', 'Success');
                })
                .catch(err => {
                    console.log('Something went wrong while copying to clipboard.', err);
                });
        }

        window.checkMultipleVMs =  function checkMultipleVMs(showAlert = false) {
            return fetchMultipleVMs().then(response => {
               if (response.status === 200) {
                $('.target').html('<i class="fad fa-circle-notch fa-spin"></i> Target(s) are spawning...');
                $('.target-protocol-ip').html('<i class="fad fa-circle-notch fa-spin"></i>');

                let entrypoints = response.data.data.entrypoints;
                displayActiveTargets(entrypoints);
              }

              return response;
          }).catch(err => {
              clearInterval(vmCheckTimer);
              toastr['error'](AXIOS_ERROR_HANDLING_MESSAGE, 'Error');
              $('.targetLifeContainer').addClass('d-flex');
              $('.targetLifeContainer').removeClass('d-none');
              resetSpawnTargetSystemText();
          });
        }

        // Handles the display of the active VMs
        // If all the VMs are ready, we display the IPs
        // If not, we keep checking every 5 seconds until one of the VMs is ready
        function displayActiveTargets (entrypoints, showAlert = false) {
            const availableTargets = entrypoints.filter(entrypoint => entrypoint.status === 'ready');
            // Reset timers and texts if there are no VMs available
            if (entrypoints.length === 0) {
                clearInterval(vmCheckTimer);
                if (showAlert) {
                    toastr['error']('No active VMs', 'Error');
                }
                $('.targetLifeContainer').addClass('d-none');
                $('.targetLifeContainer').removeClass('d-flex');
                resetSpawnTargetSystemText();

                return;
            }

            // If all the VMs are ready, we display the IPs
            let shouldDisplayTargets = availableTargets.length === entrypoints.length;
            // Format the IPs and Names of the VMs
            const targetsIPsText = availableTargets.map((target, index) => `<span class="target-${index} cursor-pointer" onclick="copyVmIP(event.target.textContent)" >` + target.ip_address + '</span>'+
                '<span style="color: #8799B5;"> (' + target.vm_template +') </span>')
                .join('<span style="color: #8799B5;"> ,</span>');

            if (shouldDisplayTargets) {
                let relatedVmName;
                let targetProtocolIp;
                let protocolVm;

                                    relatedVmName = '';
                    targetProtocolIp = targetsIPsText;
                    if (relatedVmName && relatedVmName !== null) {
                        protocolVm = availableTargets.find((target) => target.vm_template === relatedVmName);
                        if (protocolVm) {
                            targetProtocolIp = '<span class="cursor-pointer" onclick="copyVmIP(event.target.textContent)">'+`${protocolVm.ip_address}`+'</span>' +
                                '<span style="color: #8799B5;"> (' + `${relatedVmName}` + ')' + '</span>';
                        } else {
                            targetProtocolIp = relatedVmName;
                        }
                    }

                    $('.target-protocol-ip-1806').html(targetProtocolIp);
                                    relatedVmName = '';
                    targetProtocolIp = targetsIPsText;
                    if (relatedVmName && relatedVmName !== null) {
                        protocolVm = availableTargets.find((target) => target.vm_template === relatedVmName);
                        if (protocolVm) {
                            targetProtocolIp = '<span class="cursor-pointer" onclick="copyVmIP(event.target.textContent)">'+`${protocolVm.ip_address}`+'</span>' +
                                '<span style="color: #8799B5;"> (' + `${relatedVmName}` + ')' + '</span>';
                        } else {
                            targetProtocolIp = relatedVmName;
                        }
                    }

                    $('.target-protocol-ip-1807').html(targetProtocolIp);
                
                clearInterval(vmCheckTimer);

                // Pass the required data  to the target container
                $('.target').html(targetsIPsText);
                $('.resetTargetBtn').show();
                $('.targetIp').html(targetsIPsText);
                $('.targetLifeTimeContainer').show();

                // The entrypoints array is sorted by the remaining life of the VMs
                // from the smaller to the bigger value. So by taking the first element
                // we get the VM with the smallest remaining life
                initializeTimeLeft(availableTargets[0]?.remaining_life_in_seconds);
                $('.resetTargetBtn').prop('disabled', false);

                stopTargetCountdown().then(() => {
                    startTargetCountdown();
                });

                $('.targetLifeContainer').addClass('d-flex');
                $('.targetLifeContainer').removeClass('d-none');
            }
        }

      setTimeout(() => {
          // Check if the VMs are ready
          // If not, start re-checking every 5 seconds
          // until one of the VMs is ready
          checkMultipleVMs().then(response => {

              if(response.status === 200) {
                let entrypoints = response.data.data.entrypoints;
                const targetsDeploying = entrypoints.some(entrypoints => entrypoints.status === 'deploying');

                if (targetsDeploying) {
                    $('.targetIp').html('<i class="fad fa-circle-notch fa-spin"></i>');
                    $('.target-protocol-ip').html('<i class="fad fa-circle-notch fa-spin"></i>');
                    vmCheckTimer = setInterval(function () {
                        checkMultipleVMs(true);
                    }, 5 * 1000);
                } else {
                    displayActiveTargets(entrypoints);
                }
            };
          }).catch(err => {
              clearInterval(vmCheckTimer);
              toastr['error'](AXIOS_ERROR_HANDLING_MESSAGE, 'Error');
              $('.targetLifeContainer').addClass('d-flex');
              $('.targetLifeContainer').removeClass('d-none');
              resetSpawnTargetSystemText();
          });
      }, 3000);
      
              let _cancelTerminateVmModal = $('#cancelTerminateVmModal');
        let _continueTerminateVmModal = $('#continueTerminateVmModal');
        let _terminateVmModal = $('#terminateVmModal')
        let _terminateVmLoader = $('.terminateVmLoader');
        let _terminateVmText = $('.continueTerminateVmText');

        $(_cancelTerminateVmModal).click(()=>{
            _terminateVmModal.modal('hide');
        });

        _continueTerminateVmModal.click( function() {
            let _moduleId = $(this).data('module-id');
            let _sectionId = $(this).data('section-id');
            _terminateVmText.addClass('d-none');
            _terminateVmLoader.removeClass('d-none')
            $(this).prop('disabled',true);

            axios.delete(`/api/terminate/vms/${_sectionId}`)
              .then(({ data }) => {
                $(this).prop('disabled',false);
                _terminateVmText.removeClass('d-none');
                _terminateVmLoader.addClass('d-none');
                _terminateVmModal.modal('hide');

               if(data.success){
                    const _spawnTargetTextClone = $('.spawn-target-text-clone').clone();

                    _spawnTargetTextClone.removeClass('d-none');
                    _spawnTargetTextClone.removeClass('spawn-target-text-clone');
                    $('.target').html(_spawnTargetTextClone);
                    $('.resetTargetBtn').hide();
                    $('.targetLifeTimeContainer').hide();


                    toastr['success']('Target VM has been terminated successfully!', 'Success');

                    stopTargetCountdown();
               } else {
                    toastr['error'](error.message, 'Error');
               }
              }).catch(error => {
                $(this).prop('disabled',false);
                _terminateVmText.removeClass('d-none');
                _terminateVmLoader.addClass('d-none');
                _terminateVmModal.modal('hide');
                toastr['error'](AXIOS_ERROR_HANDLING_MESSAGE, 'Error');
            });
        });
      
      function calculateTimeLeftInMinutes() {
          if (targetRemainingTimeInSeconds === null) {
            return 0;
          }
          targetRemainingTimeInSeconds -= 1;
          return Math.ceil(targetRemainingTimeInSeconds/60);
      }

      function initializeTimeLeft(remainingTime){
        targetRemainingTimeInSeconds = remainingTime;
        renderLifeTimeLeft();
      }

      function renderLifeTimeLeft() {
        let life = calculateTimeLeftInMinutes();

        if (life <= 0) {
          $('.targetLifeTimeContainer').hide();
          clearInterval(targetCountdown);
          resetSpawnTargetSystemText();
        } else {
          $('.targetLifeTime').html(life);
        }
      }

      function startTargetCountdown() {
          targetCountdown = setInterval(function() {
            renderLifeTimeLeft();
          }, 1000);
      }

      function stopTargetCountdown() {
          return new Promise((resolve) => {
              clearInterval(targetCountdown);
              resolve();
          });
      }

      function resetSpawnTargetSystemText() {
          $('.resetTargetBtn').prop('disabled', true);
          $('.resetTargetBtn').hide();
          $('.targetIp').html("");
          $('.target-protocol-ip').html("");
          $('.targetLifeTimeContainer').hide();
          $('.target').html('<span class="spawnTargetBtn" style="cursor:pointer;">Click here to spawn the target system!</span>');
      }

      $(document).click(function(e) {
        if(
            !$('#htb-note-dummy-popup').is($(e.target))
            && $('#htb-note-dummy-popup').find($(e.target)).length === 0
            && !$('#htb-note-dummy-button').is($(e.target))
        ) {
            hideDummyNotesPopup(); // Call the function to hide the popup
        }
      });
</script>

<script defer="" src="./saved_page_files/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon="{&quot;rayId&quot;:&quot;91cda46edfc351fa&quot;,&quot;serverTiming&quot;:{&quot;name&quot;:{&quot;cfExtPri&quot;:true,&quot;cfL4&quot;:true,&quot;cfSpeedBrain&quot;:true,&quot;cfCacheStatus&quot;:true}},&quot;version&quot;:&quot;2025.1.0&quot;,&quot;token&quot;:&quot;9d8cb854dbf443df9a649c27660a2bb6&quot;}" crossorigin="anonymous"></script>



<script type="text/javascript" async="" src="./saved_page_files/recurly.js.download"></script><div><div class="grecaptcha-badge" data-style="bottomright" style="width: 256px; height: 60px; display: block; transition: right 0.3s; position: fixed; bottom: 14px; right: -186px; box-shadow: gray 0px 0px 5px; border-radius: 2px; overflow: hidden;"><div class="grecaptcha-logo"><iframe title="reCAPTCHA" width="256" height="60" role="presentation" name="a-9pdkyr1oirw5" frameborder="0" scrolling="no" sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-top-navigation allow-modals allow-popups-to-escape-sandbox allow-storage-access-by-user-activation" src="./saved_page_files/anchor.html"></iframe></div><div class="grecaptcha-error"></div><textarea id="g-recaptcha-response-100000" name="g-recaptcha-response" class="g-recaptcha-response" style="width: 250px; height: 40px; border: 1px solid rgb(193, 193, 193); margin: 10px 25px; padding: 0px; resize: none; display: none;"></textarea></div><iframe style="display: none;" src="./saved_page_files/saved_resource(1).html"></iframe></div><iframe id="intercom-frame" style="position: absolute !important; opacity: 0 !important; width: 1px !important; height: 1px !important; top: 0 !important; left: 0 !important; border: none !important; display: block !important; z-index: -1 !important; pointer-events: none;" aria-hidden="true" tabindex="-1" title="Intercom" src="./saved_page_files/saved_resource(2).html"></iframe><img src="./saved_page_files/adsct" height="1" width="1" style="display: none;"><img src="./saved_page_files/adsct(1)" height="1" width="1" style="display: none;"><div class="intercom-lightweight-app"><div class="intercom-lightweight-app-launcher intercom-launcher" role="button" tabindex="0" aria-label="Open Intercom Messenger" aria-live="polite"><div class="intercom-lightweight-app-launcher-icon intercom-lightweight-app-launcher-icon-open"><img src="./saved_page_files/efef1192e4fa386f159825fbf792ed52.png" alt="" class="intercom-lightweight-app-launcher-custom-icon-open"></div><div class="intercom-lightweight-app-launcher-icon intercom-lightweight-app-launcher-icon-minimize"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path fill-rule="evenodd" clip-rule="evenodd" d="M18.601 8.39897C18.269 8.06702 17.7309 8.06702 17.3989 8.39897L12 13.7979L6.60099 8.39897C6.26904 8.06702 5.73086 8.06702 5.39891 8.39897C5.06696 8.73091 5.06696 9.2691 5.39891 9.60105L11.3989 15.601C11.7309 15.933 12.269 15.933 12.601 15.601L18.601 9.60105C18.9329 9.2691 18.9329 8.73091 18.601 8.39897Z" fill="white"></path>
</svg>
</div></div><style id="intercom-lightweight-app-style" type="text/css">
  @keyframes intercom-lightweight-app-launcher {
    from {
      opacity: 0;
      transform: scale(0.5);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  @keyframes intercom-lightweight-app-gradient {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @keyframes intercom-lightweight-app-messenger {
    0% {
      opacity: 0;
      transform: scale(0);
    }
    40% {
      opacity: 1;
    }
    100% {
      transform: scale(1);
    }
  }

  .intercom-lightweight-app {
    position: fixed;
    z-index: 2147483001;
    width: 0;
    height: 0;
    font-family: intercom-font, "Helvetica Neue", "Apple Color Emoji", Helvetica, Arial, sans-serif;
  }

  .intercom-lightweight-app-gradient {
    position: fixed;
    z-index: 2147483002;
    width: 500px;
    height: 500px;
    bottom: 0;
    right: 0;
    pointer-events: none;
    background: radial-gradient(
      ellipse at bottom right,
      rgba(29, 39, 54, 0.16) 0%,
      rgba(29, 39, 54, 0) 72%);
    animation: intercom-lightweight-app-gradient 200ms ease-out;
  }

  .intercom-lightweight-app-launcher {
    position: fixed;
    z-index: 2147483003;
    padding: 0 !important;
    margin: 0 !important;
    border: none;
    bottom: 20px;
    right: 20px;
    max-width: 48px;
    width: 48px;
    max-height: 48px;
    height: 48px;
    border-radius: 50%;
    background: #85C700;
    cursor: pointer;
    box-shadow: 0 1px 6px 0 rgba(0, 0, 0, 0.06), 0 2px 32px 0 rgba(0, 0, 0, 0.16);
    transition: transform 167ms cubic-bezier(0.33, 0.00, 0.00, 1.00);
    box-sizing: content-box;
  }


  .intercom-lightweight-app-launcher:hover {
    transition: transform 250ms cubic-bezier(0.33, 0.00, 0.00, 1.00);
    transform: scale(1.1)
  }

  .intercom-lightweight-app-launcher:active {
    transform: scale(0.85);
    transition: transform 134ms cubic-bezier(0.45, 0, 0.2, 1);
  }


  .intercom-lightweight-app-launcher:focus {
    outline: none;

    
  }

  .intercom-lightweight-app-launcher-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    position: absolute;
    top: 0;
    left: 0;
    width: 48px;
    height: 48px;
    transition: transform 100ms linear, opacity 80ms linear;
  }

  .intercom-lightweight-app-launcher-icon-open {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-open svg {
    width: 24px;
    height: 24px;
  }

  .intercom-lightweight-app-launcher-icon-open svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-launcher-icon-self-serve {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg {
    height: 44px;
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-launcher-custom-icon-open {
    max-height: 24px;
    max-width: 24px;

    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize {
    
        opacity: 0;
        transform: rotate(-60deg) scale(0);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-messenger {
    position: fixed;
    z-index: 2147483003;
    overflow: hidden;
    background-color: white;
    animation: intercom-lightweight-app-messenger 250ms cubic-bezier(0, 1, 1, 1);
    transform-origin: bottom right;

    
        width: 400px;
        height: calc(100% - 104px);
        max-height: 704px;
        min-height: 250px;
        right: 20px;
        bottom: 84px;
        box-shadow: 0 5px 40px rgba(0,0,0,0.16);
      

    border-radius: 16px;
  }

  .intercom-lightweight-app-messenger-header {
    height: 64px;
    border-bottom: none;
    background: white
  }

  .intercom-lightweight-app-messenger-footer{
    position:absolute;
    bottom:0;
    width: 100%;
    height: 80px;
    background: #fff;
    font-size: 14px;
    line-height: 21px;
    border-top: 1px solid rgba(0, 0, 0, 0.05);
    box-shadow: 0px 0px 25px rgba(0, 0, 0, 0.05);
  }

  @media print {
    .intercom-lightweight-app {
      display: none;
    }
  }
</style></div><div id="intercom-tooltips-container" class="intercom-namespace"><style>html.intercom-mobile-messenger-active,html.intercom-mobile-messenger-active>body,html.intercom-modal-open,#intercom-container-body{overflow:hidden!important;}html.intercom-mobile-messenger-active,html.intercom-mobile-messenger-active>body{position:static!important;transform:none!important;}html.intercom-mobile-messenger-active>body{height:0!important;margin:0!important;}iframe#intercom-frame{position:absolute!important;opacity:0!important;width:1px!important;height:1px!important;top:0!important;left:0!important;border:none!important;display:block!important;z-index:-1!important;;};;</style></div><div id="intercom-css-container"><style data-emotion="intercom-with-namespace-global" data-s=""></style></div></body></html>